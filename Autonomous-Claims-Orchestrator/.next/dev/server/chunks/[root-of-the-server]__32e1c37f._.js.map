{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/lib/processedClaims.ts"],"sourcesContent":["import fs from 'fs'\nimport path from 'path'\nimport { ClaimData } from '@/types/claims'\n\nconst DATA_DIR = path.join(process.cwd(), 'data')\nconst CLAIMS_DIR = path.join(DATA_DIR, 'processed-claims')\nconst INDEX_FILE = path.join(CLAIMS_DIR, 'claims-index.json')\nconst CSV_FILE = path.join(CLAIMS_DIR, 'claims-history.csv')\n\nexport interface ProcessedClaimSummary {\n  claimId: string\n  ingestedClaimId?: string\n  policyNumber?: string\n  claimantName?: string\n  createdAt: string\n}\n\nfunction ensureDir() {\n  if (!fs.existsSync(DATA_DIR)) fs.mkdirSync(DATA_DIR, { recursive: true })\n  if (!fs.existsSync(CLAIMS_DIR)) fs.mkdirSync(CLAIMS_DIR, { recursive: true })\n}\n\nfunction getIndex(): Array<{ claimId: string; ingestedClaimId?: string; policyNumber?: string; claimantName?: string; createdAt: string; filePath: string }> {\n  ensureDir()\n  if (!fs.existsSync(INDEX_FILE)) return []\n  try {\n    return JSON.parse(fs.readFileSync(INDEX_FILE, 'utf-8'))\n  } catch {\n    return []\n  }\n}\n\nfunction saveIndex(index: ReturnType<typeof getIndex>) {\n  ensureDir()\n  fs.writeFileSync(INDEX_FILE, JSON.stringify(index, null, 2), 'utf-8')\n}\n\nfunction escapeCsv(val: unknown): string {\n  if (val == null || val === undefined) return ''\n  const s = String(val)\n  if (s.includes(',') || s.includes('\"') || s.includes('\\n')) {\n    return `\"${s.replace(/\"/g, '\"\"')}\"`\n  }\n  return s\n}\n\nfunction appendToCsv(claim: ClaimData) {\n  ensureDir()\n  const draft = claim.decisionPack?.claimDraft\n  const isNew = !fs.existsSync(CSV_FILE)\n  const headers = [\n    'claimId',\n    'ingestedClaimId',\n    'policyNumber',\n    'claimantName',\n    'contactEmail',\n    'contactPhone',\n    'lossDate',\n    'lossType',\n    'lossLocation',\n    'description',\n    'status',\n    'createdAt',\n  ]\n  const row = [\n    claim.claimId ?? '',\n    claim.ingestedClaimId ?? '',\n    draft?.policyNumber ?? '',\n    draft?.claimantName ?? '',\n    draft?.contactEmail ?? '',\n    draft?.contactPhone ?? '',\n    draft?.lossDate ?? '',\n    draft?.lossType ?? '',\n    (draft?.lossLocation || draft?.location) ?? '',\n    draft?.description ?? '',\n    claim.status ?? '',\n    claim.createdAt ?? new Date().toISOString(),\n  ]\n  const line = isNew ? headers.map(escapeCsv).join(',') + '\\n' : ''\n  fs.appendFileSync(CSV_FILE, line + row.map(escapeCsv).join(',') + '\\n', 'utf-8')\n}\n\nexport function saveProcessedClaim(claim: ClaimData): void {\n  ensureDir()\n  const claimId = claim.claimId || `CLM-${Date.now()}`\n  const filePath = path.join(CLAIMS_DIR, `${claimId.replace(/[/\\\\:]/g, '_')}.json`)\n\n  const toSave = { ...claim, claimId }\n  fs.writeFileSync(filePath, JSON.stringify(toSave, null, 2), 'utf-8')\n\n  const draft = claim.decisionPack?.claimDraft\n  const index = getIndex()\n  const existing = index.findIndex((e) => e.claimId === claimId)\n  if (existing < 0) appendToCsv(toSave)\n  const entry = {\n    claimId,\n    ingestedClaimId: claim.ingestedClaimId,\n    policyNumber: draft?.policyNumber,\n    claimantName: draft?.claimantName,\n    createdAt: claim.createdAt || new Date().toISOString(),\n    filePath,\n  }\n  if (existing >= 0) {\n    index[existing] = entry\n  } else {\n    index.unshift(entry)\n  }\n  saveIndex(index)\n}\n\nexport function getProcessedClaimSummaries(): ProcessedClaimSummary[] {\n  const index = getIndex()\n  return index.map(({ claimId, ingestedClaimId, policyNumber, claimantName, createdAt }) => ({\n    claimId,\n    ingestedClaimId,\n    policyNumber,\n    claimantName,\n    createdAt,\n  }))\n}\n\nexport function getProcessedClaimById(claimId: string): ClaimData | null {\n  const index = getIndex()\n  const entry = index.find((e) => e.claimId === claimId)\n  if (!entry || !fs.existsSync(entry.filePath)) return null\n  try {\n    return JSON.parse(fs.readFileSync(entry.filePath, 'utf-8')) as ClaimData\n  } catch {\n    return null\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 190, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/app/api/claims/%5BclaimId%5D/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { getProcessedClaimById } from '@/lib/processedClaims'\n\n/** GET /api/claims/[claimId] - Load a processed claim by ID */\nexport async function GET(\n  _request: NextRequest,\n  { params }: { params: Promise<{ claimId: string }> }\n) {\n  try {\n    const { claimId } = await params\n    if (!claimId) {\n      return NextResponse.json({ error: 'claimId required' }, { status: 400 })\n    }\n    const claim = getProcessedClaimById(decodeURIComponent(claimId))\n    if (!claim) {\n      return NextResponse.json({ error: 'Claim not found' }, { status: 404 })\n    }\n    return NextResponse.json(claim)\n  } catch (error) {\n    console.error('Load claim error:', error)\n    return NextResponse.json({ error: 'Failed to load claim' }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAGO,eAAe,IACpB,QAAqB,EACrB,EAAE,MAAM,EAA4C;IAEpD,IAAI;QACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM;QAC1B,IAAI,CAAC,SAAS;YACZ,OAAO,wLAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAmB,GAAG;gBAAE,QAAQ;YAAI;QACxE;QACA,MAAM,QAAQ,IAAA,yLAAqB,EAAC,mBAAmB;QACvD,IAAI,CAAC,OAAO;YACV,OAAO,wLAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAkB,GAAG;gBAAE,QAAQ;YAAI;QACvE;QACA,OAAO,wLAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qBAAqB;QACnC,OAAO,wLAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAuB,GAAG;YAAE,QAAQ;QAAI;IAC5E;AACF"}}]
}