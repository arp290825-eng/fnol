{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/lib/auth/csvAuth.ts"],"sourcesContent":["import fs from 'fs'\nimport path from 'path'\n\nconst CSV_FILE_PATH = path.join(process.cwd(), 'login_credentials.csv')\n\nexport interface User {\n  email: string\n  password: string\n  name: string\n  phone: string\n  createdAt: string\n}\n\n/**\n * Read all users from CSV file\n */\nexport function readUsersFromCSV(): User[] {\n  try {\n    // Check if file exists\n    if (!fs.existsSync(CSV_FILE_PATH)) {\n      return []\n    }\n\n    const fileContent = fs.readFileSync(CSV_FILE_PATH, 'utf-8')\n    const lines = fileContent.trim().split('\\n')\n    \n    // Skip header row\n    if (lines.length <= 1) {\n      return []\n    }\n\n    const users: User[] = []\n    for (let i = 1; i < lines.length; i++) {\n      const line = lines[i].trim()\n      if (!line) continue\n\n      // Parse CSV line (handle quoted values)\n      const values = parseCSVLine(line)\n      if (values.length >= 5) {\n        users.push({\n          email: values[0],\n          password: values[1],\n          name: values[2],\n          phone: values[3],\n          createdAt: values[4],\n        })\n      }\n    }\n\n    return users\n  } catch (error) {\n    console.error('Error reading CSV file:', error)\n    return []\n  }\n}\n\n/**\n * Write a new user to CSV file\n */\nexport function writeUserToCSV(user: Omit<User, 'createdAt'>): boolean {\n  try {\n    const createdAt = new Date().toISOString()\n    const newUser: User = { ...user, createdAt }\n\n    // Check if file exists, if not create it with header\n    const fileExists = fs.existsSync(CSV_FILE_PATH)\n    \n    // Ensure data directory exists\n    const dataDir = path.dirname(CSV_FILE_PATH)\n    if (!fs.existsSync(dataDir)) {\n      fs.mkdirSync(dataDir, { recursive: true })\n    }\n\n    // Prepare CSV line (escape commas and quotes)\n    const csvLine = [\n      escapeCSVValue(newUser.email),\n      escapeCSVValue(newUser.password),\n      escapeCSVValue(newUser.name),\n      escapeCSVValue(newUser.phone),\n      escapeCSVValue(newUser.createdAt),\n    ].join(',')\n\n    // Write header if file doesn't exist\n    if (!fileExists) {\n      const header = 'email,password,name,phone,createdAt\\n'\n      fs.writeFileSync(CSV_FILE_PATH, header, 'utf-8')\n    }\n\n    // Append new user\n    fs.appendFileSync(CSV_FILE_PATH, csvLine + '\\n', 'utf-8')\n    return true\n  } catch (error) {\n    console.error('Error writing to CSV file:', error)\n    return false\n  }\n}\n\n/**\n * Validate user credentials\n */\nexport function validateCredentials(email: string, password: string): User | null {\n  const users = readUsersFromCSV()\n  const user = users.find(u => u.email.toLowerCase() === email.toLowerCase())\n  \n  if (user && user.password === password) {\n    return user\n  }\n  \n  return null\n}\n\n/**\n * Check if email already exists\n */\nexport function emailExists(email: string): boolean {\n  const users = readUsersFromCSV()\n  return users.some(u => u.email.toLowerCase() === email.toLowerCase())\n}\n\n/**\n * Parse a CSV line handling quoted values\n */\nfunction parseCSVLine(line: string): string[] {\n  const values: string[] = []\n  let current = ''\n  let inQuotes = false\n\n  for (let i = 0; i < line.length; i++) {\n    const char = line[i]\n    \n    if (char === '\"') {\n      if (inQuotes && line[i + 1] === '\"') {\n        // Escaped quote\n        current += '\"'\n        i++\n      } else {\n        // Toggle quote state\n        inQuotes = !inQuotes\n      }\n    } else if (char === ',' && !inQuotes) {\n      // End of field\n      values.push(current)\n      current = ''\n    } else {\n      current += char\n    }\n  }\n  \n  // Add last field\n  values.push(current)\n  \n  return values\n}\n\n/**\n * Escape CSV value (add quotes if contains comma or quote)\n */\nfunction escapeCSVValue(value: string): string {\n  if (value.includes(',') || value.includes('\"') || value.includes('\\n')) {\n    return `\"${value.replace(/\"/g, '\"\"')}\"`\n  }\n  return value\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 197, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/app/api/auth/login/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { validateCredentials } from '@/lib/auth/csvAuth'\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json()\n    const { email, password } = body\n\n    // Validate required fields\n    if (!email || !password) {\n      return NextResponse.json(\n        { error: 'Email and password are required' },\n        { status: 400 }\n      )\n    }\n\n    // Validate credentials\n    const user = validateCredentials(email, password)\n\n    if (!user) {\n      return NextResponse.json(\n        { error: 'Invalid email or password' },\n        { status: 401 }\n      )\n    }\n\n    // Return user data (without password)\n    const { password: _, ...userWithoutPassword } = user\n\n    return NextResponse.json(\n      {\n        message: 'Login successful',\n        user: userWithoutPassword,\n      },\n      { status: 200 }\n    )\n  } catch (error) {\n    console.error('Login error:', error)\n    return NextResponse.json(\n      { error: 'Internal server error' },\n      { status: 500 }\n    )\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG;QAE5B,2BAA2B;QAC3B,IAAI,CAAC,SAAS,CAAC,UAAU;YACvB,OAAO,wLAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAkC,GAC3C;gBAAE,QAAQ;YAAI;QAElB;QAEA,uBAAuB;QACvB,MAAM,OAAO,IAAA,uLAAmB,EAAC,OAAO;QAExC,IAAI,CAAC,MAAM;YACT,OAAO,wLAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA4B,GACrC;gBAAE,QAAQ;YAAI;QAElB;QAEA,sCAAsC;QACtC,MAAM,EAAE,UAAU,CAAC,EAAE,GAAG,qBAAqB,GAAG;QAEhD,OAAO,wLAAY,CAAC,IAAI,CACtB;YACE,SAAS;YACT,MAAM;QACR,GACA;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO,wLAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}