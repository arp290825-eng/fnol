{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/components/ConfigModal.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect } from 'react'\nimport { X, Key, CheckCircle, AlertCircle } from 'lucide-react'\n\ninterface ConfigModalProps {\n  isOpen: boolean\n  onClose: () => void\n  onSave: (apiKey: string) => void\n}\n\nexport default function ConfigModal({ isOpen, onClose, onSave }: ConfigModalProps) {\n  const [apiKey, setApiKey] = useState('')\n  const [showKey, setShowKey] = useState(false)\n  const [isValid, setIsValid] = useState(false)\n\n  useEffect(() => {\n    // Load saved API key from localStorage\n    if (typeof window !== 'undefined') {\n      const savedKey = localStorage.getItem('openai_api_key')\n      if (savedKey) {\n        setApiKey(savedKey)\n        setIsValid(savedKey.startsWith('sk-') && savedKey.length > 20)\n      }\n    }\n  }, [isOpen])\n\n  const handleSave = () => {\n    if (apiKey.trim()) {\n      // Save to localStorage and window for immediate use\n      if (typeof window !== 'undefined') {\n        localStorage.setItem('openai_api_key', apiKey.trim())\n        ;(window as any).OPENAI_API_KEY = apiKey.trim()\n      }\n      onSave(apiKey.trim())\n      onClose()\n    }\n  }\n\n  const handleApiKeyChange = (value: string) => {\n    setApiKey(value)\n    setIsValid(value.startsWith('sk-') && value.length > 20)\n  }\n\n  const clearApiKey = () => {\n    setApiKey('')\n    setIsValid(false)\n    if (typeof window !== 'undefined') {\n      localStorage.removeItem('openai_api_key')\n      delete (window as any).OPENAI_API_KEY\n    }\n    onSave('')\n  }\n\n  if (!isOpen) return null\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n      <div className=\"bg-white rounded-lg p-6 w-full max-w-md mx-4\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h2 className=\"text-xl font-semibold text-gray-900\">OpenAI Configuration</h2>\n          <button\n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600\"\n          >\n            <X className=\"w-6 h-6\" />\n          </button>\n        </div>\n\n        <div className=\"space-y-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              OpenAI API Key\n            </label>\n            <div className=\"relative\">\n              <input\n                type={showKey ? 'text' : 'password'}\n                value={apiKey}\n                onChange={(e) => handleApiKeyChange(e.target.value)}\n                placeholder=\"sk-...\"\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 pr-12\"\n              />\n              <div className=\"absolute right-3 top-1/2 transform -translate-y-1/2 flex items-center space-x-1\">\n                {isValid ? (\n                  <CheckCircle className=\"w-4 h-4 text-green-500\" />\n                ) : apiKey ? (\n                  <AlertCircle className=\"w-4 h-4 text-red-500\" />\n                ) : null}\n                <button\n                  onClick={() => setShowKey(!showKey)}\n                  className=\"text-gray-400 hover:text-gray-600\"\n                >\n                  <Key className=\"w-4 h-4\" />\n                </button>\n              </div>\n            </div>\n            {apiKey && !isValid && (\n              <p className=\"text-sm text-red-600 mt-1\">\n                API key should start with 'sk-' and be at least 20 characters\n              </p>\n            )}\n          </div>\n\n          <div className=\"bg-blue-50 border border-blue-200 rounded-md p-3\">\n            <h3 className=\"text-sm font-medium text-blue-900 mb-1\">How to get your API key:</h3>\n            <ol className=\"text-sm text-blue-800 space-y-1\">\n              <li>1. Go to <a href=\"https://platform.openai.com/api-keys\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"underline\">platform.openai.com/api-keys</a></li>\n              <li>2. Click \"Create new secret key\"</li>\n              <li>3. Copy the key and paste it here</li>\n            </ol>\n          </div>\n\n          <div className=\"bg-yellow-50 border border-yellow-200 rounded-md p-3\">\n            <p className=\"text-sm text-yellow-800\">\n              <strong>Demo Mode:</strong> Without an API key, the system will use simulated responses. \n              With a real API key, you'll get actual AI-powered extraction and analysis.\n            </p>\n          </div>\n\n          <div className=\"flex justify-between pt-4\">\n            <button\n              onClick={clearApiKey}\n              className=\"px-4 py-2 text-sm text-red-600 hover:text-red-800\"\n            >\n              Clear Key\n            </button>\n            <div className=\"space-x-2\">\n              <button\n                onClick={onClose}\n                className=\"px-4 py-2 text-sm text-gray-600 hover:text-gray-800\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleSave}\n                className=\"px-4 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 disabled:opacity-50\"\n                disabled={!apiKey.trim()}\n              >\n                Save\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAHA;;;;AAWe,SAAS,YAAY,EAAE,MAAM,EAAE,OAAO,EAAE,MAAM,EAAoB;IAC/E,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yPAAQ,EAAC;IACrC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yPAAQ,EAAC;IACvC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yPAAQ,EAAC;IAEvC,IAAA,0PAAS,EAAC;QACR,uCAAuC;QACvC;;IAOF,GAAG;QAAC;KAAO;IAEX,MAAM,aAAa;QACjB,IAAI,OAAO,IAAI,IAAI;YACjB,oDAAoD;YACpD;;YAIA,OAAO,OAAO,IAAI;YAClB;QACF;IACF;IAEA,MAAM,qBAAqB,CAAC;QAC1B,UAAU;QACV,WAAW,MAAM,UAAU,CAAC,UAAU,MAAM,MAAM,GAAG;IACvD;IAEA,MAAM,cAAc;QAClB,UAAU;QACV,WAAW;QACX;;QAIA,OAAO;IACT;IAEA,IAAI,CAAC,QAAQ,OAAO;IAEpB,qBACE,sRAAC;QAAI,WAAU;kBACb,cAAA,sRAAC;YAAI,WAAU;;8BACb,sRAAC;oBAAI,WAAU;;sCACb,sRAAC;4BAAG,WAAU;sCAAsC;;;;;;sCACpD,sRAAC;4BACC,SAAS;4BACT,WAAU;sCAEV,cAAA,sRAAC,yOAAC;gCAAC,WAAU;;;;;;;;;;;;;;;;;8BAIjB,sRAAC;oBAAI,WAAU;;sCACb,sRAAC;;8CACC,sRAAC;oCAAM,WAAU;8CAA+C;;;;;;8CAGhE,sRAAC;oCAAI,WAAU;;sDACb,sRAAC;4CACC,MAAM,UAAU,SAAS;4CACzB,OAAO;4CACP,UAAU,CAAC,IAAM,mBAAmB,EAAE,MAAM,CAAC,KAAK;4CAClD,aAAY;4CACZ,WAAU;;;;;;sDAEZ,sRAAC;4CAAI,WAAU;;gDACZ,wBACC,sRAAC,2QAAW;oDAAC,WAAU;;;;;2DACrB,uBACF,sRAAC,2QAAW;oDAAC,WAAU;;;;;2DACrB;8DACJ,sRAAC;oDACC,SAAS,IAAM,WAAW,CAAC;oDAC3B,WAAU;8DAEV,cAAA,sRAAC,+OAAG;wDAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;gCAIpB,UAAU,CAAC,yBACV,sRAAC;oCAAE,WAAU;8CAA4B;;;;;;;;;;;;sCAM7C,sRAAC;4BAAI,WAAU;;8CACb,sRAAC;oCAAG,WAAU;8CAAyC;;;;;;8CACvD,sRAAC;oCAAG,WAAU;;sDACZ,sRAAC;;gDAAG;8DAAS,sRAAC;oDAAE,MAAK;oDAAuC,QAAO;oDAAS,KAAI;oDAAsB,WAAU;8DAAY;;;;;;;;;;;;sDAC5H,sRAAC;sDAAG;;;;;;sDACJ,sRAAC;sDAAG;;;;;;;;;;;;;;;;;;sCAIR,sRAAC;4BAAI,WAAU;sCACb,cAAA,sRAAC;gCAAE,WAAU;;kDACX,sRAAC;kDAAO;;;;;;oCAAmB;;;;;;;;;;;;sCAK/B,sRAAC;4BAAI,WAAU;;8CACb,sRAAC;oCACC,SAAS;oCACT,WAAU;8CACX;;;;;;8CAGD,sRAAC;oCAAI,WAAU;;sDACb,sRAAC;4CACC,SAAS;4CACT,WAAU;sDACX;;;;;;sDAGD,sRAAC;4CACC,SAAS;4CACT,WAAU;4CACV,UAAU,CAAC,OAAO,IAAI;sDACvB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASf"}},
    {"offset": {"line": 323, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/components/Header.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect } from 'react'\nimport { ProcessingStage } from '@/types/claims'\nimport { motion } from 'framer-motion'\nimport { \n  Home, \n  Search, \n  CheckCircle, \n  BarChart3,\n  Zap,\n  Settings,\n  Brain,\n  LogOut,\n  User\n} from 'lucide-react'\nimport ConfigModal from './ConfigModal'\nimport { useAuth } from '@/lib/auth/AuthContext'\n\ninterface HeaderProps {\n  currentStage: ProcessingStage\n  onStageChange: (stage: ProcessingStage) => void\n}\n\nconst stages = [\n  { id: 'home', label: 'Ingest', icon: Home, description: 'Upload FNOL & Attachments' },\n  { id: 'review', label: 'Review', icon: Search, description: 'Extraction & Evidence' },\n  { id: 'decision', label: 'Decision', icon: CheckCircle, description: 'Draft Claim & Actions' },\n  { id: 'dashboard', label: 'Dashboard', icon: BarChart3, description: 'Ops & Metrics' },\n] as const\n\nexport default function Header({ currentStage, onStageChange }: HeaderProps) {\n  const [showConfig, setShowConfig] = useState(false)\n  const [hasOpenAIKey, setHasOpenAIKey] = useState(false)\n  const { user, logout } = useAuth()\n\n  useEffect(() => {\n    // Check for OpenAI API key\n    const checkOpenAIKey = () => {\n      if (typeof window !== 'undefined') {\n        const key = localStorage.getItem('openai_api_key') || (window as any).OPENAI_API_KEY\n        setHasOpenAIKey(!!key)\n      }\n    }\n    \n    checkOpenAIKey()\n    // Check periodically in case key is updated elsewhere\n    const interval = setInterval(checkOpenAIKey, 2000)\n    return () => clearInterval(interval)\n  }, [])\n\n  const handleConfigSave = (apiKey: string) => {\n    setHasOpenAIKey(!!apiKey)\n  }\n\n  return (\n    <>\n      <header className=\"bg-white border-b border-[#E5E7EB] sticky top-0 z-50\">\n        <div className=\"container mx-auto px-8\">\n          <div className=\"flex items-center justify-between h-16\">\n            {/* Logo */}\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"flex items-center justify-center w-8 h-8 bg-[#2563EB] rounded\">\n                <Zap className=\"w-4 h-4 text-white\" />\n              </div>\n              <div className=\"flex flex-col\">\n                <h1 className=\"text-lg font-semibold text-[#111827]\">\n                  Claims Fast Lane\n                </h1>\n                <p className=\"text-xs text-[#9CA3AF] font-medium\">by AI Mill</p>\n              </div>\n            </div>\n\n            {/* Navigation */}\n            <nav className=\"flex items-center space-x-1\">\n              {stages.map((stage, index) => {\n                const Icon = stage.icon\n                const isActive = currentStage === stage.id\n                \n                return (\n                  <button\n                    key={stage.id}\n                    onClick={() => onStageChange(stage.id as ProcessingStage)}\n                    className={`\n                      flex items-center space-x-2 px-4 py-2 text-sm font-medium transition-colors\n                      ${isActive \n                        ? 'text-[#2563EB] border-b-2 border-[#2563EB]' \n                        : 'text-[#6B7280] hover:text-[#374151]'\n                      }\n                    `}\n                  >\n                    <Icon className=\"w-4 h-4\" />\n                    <span className=\"hidden sm:inline\">{stage.label}</span>\n                  </button>\n                )\n              })}\n            </nav>\n\n            {/* Secondary controls - visually muted */}\n            <div className=\"flex items-center space-x-3\">\n              {hasOpenAIKey ? (\n                <div className=\"flex items-center space-x-1.5 text-[#9CA3AF]\">\n                  <Brain className=\"w-3.5 h-3.5\" />\n                  <span className=\"text-xs\">AI</span>\n                </div>\n              ) : (\n                <div className=\"flex items-center space-x-1.5 text-[#9CA3AF]\">\n                  <Zap className=\"w-3.5 h-3.5\" />\n                  <span className=\"text-xs\">Demo</span>\n                </div>\n              )}\n              <button \n                onClick={() => setShowConfig(true)}\n                className=\"p-1.5 text-[#9CA3AF] hover:text-[#6B7280] transition-colors\"\n                title=\"Settings\"\n              >\n                <Settings className=\"w-4 h-4\" />\n              </button>\n              {/* User info and logout */}\n              {user && (\n                <div className=\"flex items-center space-x-2 px-3 py-1.5 rounded-lg bg-[#F3F4F6]\">\n                  <User className=\"w-3.5 h-3.5 text-[#6B7280]\" />\n                  <span className=\"text-xs text-[#6B7280] font-medium hidden sm:inline\">\n                    {user.name}\n                  </span>\n                </div>\n              )}\n              <button\n                onClick={logout}\n                className=\"p-1.5 text-[#9CA3AF] hover:text-[#EF4444] transition-colors\"\n                title=\"Logout\"\n              >\n                <LogOut className=\"w-4 h-4\" />\n              </button>\n              {/* Image at the very right */}\n              <div className=\"flex items-center space-x-2 ml-2\">\n                <img \n                  src=\"/image.png\" \n                  alt=\"AI Mill\" \n                  className=\"h-10 w-auto object-contain\"\n                />\n                <span className=\"text-xs text-[#9CA3AF] font-medium\">By AI Mill</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </header>\n\n    <ConfigModal\n      isOpen={showConfig}\n      onClose={() => setShowConfig(false)}\n      onSave={handleConfigSave}\n    />\n  </>\n  )\n} "],"names":[],"mappings":"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"}},
    {"offset": {"line": 656, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/lib/services/openai.ts"],"sourcesContent":["import OpenAI from 'openai'\n\n// Initialize OpenAI client\nconst openai = new OpenAI({\n  apiKey: process.env.OPENAI_API_KEY || '',\n  dangerouslyAllowBrowser: true // For demo purposes - in production, use server-side API routes\n})\n\nexport interface FunctionCall {\n  name: string\n  description: string\n  parameters: {\n    type: 'object'\n    properties: Record<string, any>\n    required: string[]\n  }\n}\n\nexport interface LLMResponse {\n  content: string\n  functionCalls?: Array<{\n    name: string\n    arguments: Record<string, any>\n  }>\n}\n\nexport class OpenAIService {\n  private model: string\n  private temperature: number\n\n  constructor(model: string = 'gpt-4-1106-preview', temperature: number = 0.1) {\n    this.model = model\n    this.temperature = temperature\n  }\n\n  async callLLM(\n    prompt: string,\n    systemPrompt?: string,\n    functions?: FunctionCall[]\n  ): Promise<LLMResponse> {\n    try {\n      const messages: any[] = []\n      \n      if (systemPrompt) {\n        messages.push({ role: 'system', content: systemPrompt })\n      }\n      \n      messages.push({ role: 'user', content: prompt })\n\n      const requestConfig: any = {\n        model: this.model,\n        messages,\n        temperature: this.temperature,\n        max_tokens: 2000\n      }\n\n      // Add function calling if functions are provided\n      if (functions && functions.length > 0) {\n        requestConfig.functions = functions\n        requestConfig.function_call = 'auto'\n      }\n\n      const response = await openai.chat.completions.create(requestConfig)\n      \n      const choice = response.choices[0]\n      \n      if (!choice) {\n        throw new Error('No response from OpenAI')\n      }\n\n      const result: LLMResponse = {\n        content: choice.message?.content || ''\n      }\n\n      // Handle function calls\n      if (choice.message?.function_call) {\n        result.functionCalls = [{\n          name: choice.message.function_call.name,\n          arguments: JSON.parse(choice.message.function_call.arguments || '{}')\n        }]\n      }\n\n      return result\n    } catch (error) {\n      console.error('OpenAI API call failed:', error)\n      throw new Error(`OpenAI API call failed: ${error}`)\n    }\n  }\n\n  async extractClaimFields(emailText: string, documents: string[]): Promise<Record<string, any>> {\n    const systemPrompt = `You are an expert insurance claims processor. Extract structured claim information from the provided email and documents. Be precise and only extract information that is explicitly stated or can be confidently inferred.`\n\n    const prompt = `Extract claim fields from this FNOL email and attachments:\n\nEMAIL:\n${emailText}\n\nDOCUMENTS:\n${documents.join('\\n\\n---\\n\\n')}\n\nExtract the following fields if present:\n- policyNumber: Insurance policy number\n- claimantName: Name of the person filing the claim\n- contactEmail: Contact email address\n- contactPhone: Contact phone number\n- lossDate: Date when the loss occurred (YYYY-MM-DD format)\n- lossType: Type of loss (Collision, Water, Fire, Theft, Liability, Other)\n- lossLocation: Where the loss occurred\n- description: Brief description of what happened\n- vehicleInfo: If auto claim - year, make, model, license plate\n- propertyAddress: If property claim - property address\n- estimatedDamage: Estimated damage amount if mentioned\n\nReturn ONLY a JSON object with the extracted fields. Use null for missing fields.`\n\n    const functions: FunctionCall[] = [{\n      name: 'extract_claim_fields',\n      description: 'Extract structured claim information from email and documents',\n      parameters: {\n        type: 'object',\n        properties: {\n          policyNumber: { type: 'string', description: 'Insurance policy number' },\n          claimantName: { type: 'string', description: 'Name of claimant' },\n          contactEmail: { type: 'string', description: 'Contact email' },\n          contactPhone: { type: 'string', description: 'Contact phone number' },\n          lossDate: { type: 'string', description: 'Loss date in YYYY-MM-DD format' },\n          lossType: { \n            type: 'string', \n            enum: ['Collision', 'Water', 'Fire', 'Theft', 'Liability', 'Other'],\n            description: 'Type of loss'\n          },\n          lossLocation: { type: 'string', description: 'Location where loss occurred' },\n          description: { type: 'string', description: 'Description of what happened' },\n          vehicleInfo: { \n            type: 'object',\n            properties: {\n              year: { type: 'string' },\n              make: { type: 'string' },\n              model: { type: 'string' },\n              licensePlate: { type: 'string' }\n            },\n            description: 'Vehicle information for auto claims'\n          },\n          propertyAddress: { type: 'string', description: 'Property address for property claims' },\n          estimatedDamage: { type: 'number', description: 'Estimated damage amount' }\n        },\n        required: []\n      }\n    }]\n\n    const response = await this.callLLM(prompt, systemPrompt, functions)\n    \n    if (response.functionCalls && response.functionCalls.length > 0) {\n      return response.functionCalls[0].arguments\n    }\n    \n    // Fallback: try to parse JSON from content\n    try {\n      return JSON.parse(response.content)\n    } catch {\n      throw new Error('Failed to extract structured claim fields from LLM response')\n    }\n  }\n\n  async classifyDocument(filename: string, content: string): Promise<{\n    type: string\n    confidence: number\n    keyFields: Record<string, any>\n  }> {\n    const systemPrompt = `You are a document classification expert for insurance claims. Classify the document type and extract key fields.`\n\n    const prompt = `Classify this document and extract key information:\n\nFILENAME: ${filename}\nCONTENT:\n${content.substring(0, 2000)}...\n\nClassify the document type as one of:\n- PoliceReport\n- RepairEstimate  \n- Invoice\n- MedicalRecord\n- IncidentReport\n- DamagePhoto\n- Other\n\nAlso extract relevant key fields based on the document type.`\n\n    const functions: FunctionCall[] = [{\n      name: 'classify_document',\n      description: 'Classify document type and extract key fields',\n      parameters: {\n        type: 'object',\n        properties: {\n          type: {\n            type: 'string',\n            enum: ['PoliceReport', 'RepairEstimate', 'Invoice', 'MedicalRecord', 'IncidentReport', 'DamagePhoto', 'Other'],\n            description: 'Document type classification'\n          },\n          confidence: {\n            type: 'number',\n            minimum: 0,\n            maximum: 1,\n            description: 'Confidence score for classification'\n          },\n          keyFields: {\n            type: 'object',\n            description: 'Key fields extracted from the document'\n          }\n        },\n        required: ['type', 'confidence', 'keyFields']\n      }\n    }]\n\n    const response = await this.callLLM(prompt, systemPrompt, functions)\n    \n    if (response.functionCalls && response.functionCalls.length > 0) {\n      const args = response.functionCalls[0].arguments\n      return {\n        type: args.type || 'Other',\n        confidence: args.confidence || 0.5,\n        keyFields: args.keyFields || {}\n      }\n    }\n    \n    // Fallback classification\n    return {\n      type: 'Other',\n      confidence: 0.5,\n      keyFields: {}\n    }\n  }\n\n  async generateFieldEvidence(\n    fieldName: string, \n    value: any, \n    emailText: string, \n    documents: string[]\n  ): Promise<{\n    confidence: number\n    sourceLocator: string\n    rationale: string\n  }> {\n    const systemPrompt = `You are an evidence analyst for insurance claims. Identify the source and rationale for extracted field values.`\n\n    const prompt = `Analyze the evidence for this extracted field:\n\nFIELD: ${fieldName}\nVALUE: ${value}\n\nSOURCE TEXT:\nEMAIL: ${emailText}\n\nDOCUMENTS:\n${documents.join('\\n\\n---\\n\\n')}\n\nProvide:\n1. Confidence score (0-1) for this field extraction\n2. Source locator (where in the text this value was found)\n3. Brief rationale explaining why this value was extracted`\n\n    const functions: FunctionCall[] = [{\n      name: 'analyze_field_evidence',\n      description: 'Analyze evidence for extracted field',\n      parameters: {\n        type: 'object',\n        properties: {\n          confidence: {\n            type: 'number',\n            minimum: 0,\n            maximum: 1,\n            description: 'Confidence score for field extraction'\n          },\n          sourceLocator: {\n            type: 'string',\n            description: 'Location where value was found (e.g., email_text:100-150, doc1:50-75)'\n          },\n          rationale: {\n            type: 'string',\n            description: 'Brief explanation of why this value was extracted'\n          }\n        },\n        required: ['confidence', 'sourceLocator', 'rationale']\n      }\n    }]\n\n    const response = await this.callLLM(prompt, systemPrompt, functions)\n    \n    if (response.functionCalls && response.functionCalls.length > 0) {\n      const args = response.functionCalls[0].arguments\n      return {\n        confidence: args.confidence || 0.7,\n        sourceLocator: args.sourceLocator || 'text_inference',\n        rationale: args.rationale || 'Inferred from document context'\n      }\n    }\n    \n    // Fallback evidence\n    return {\n      confidence: 0.7,\n      sourceLocator: 'text_inference',\n      rationale: 'Inferred from document context'\n    }\n  }\n\n  async queryPolicyDatabase(\n    lossType: string,\n    description: string,\n    extractedFields: Record<string, any>\n  ): Promise<Array<{\n    clauseId: string\n    title: string\n    similarity: number\n    rationale: string\n  }>> {\n    const systemPrompt = `You are a policy database search expert. Given claim information, identify the most relevant policy clauses.`\n\n    const prompt = `Find relevant policy clauses for this claim:\n\nLOSS TYPE: ${lossType}\nDESCRIPTION: ${description}\nEXTRACTED FIELDS: ${JSON.stringify(extractedFields, null, 2)}\n\nBased on this information, identify which of these policy clauses are most relevant:\n\nAUTO INSURANCE:\n- AUTO-COL-001: Collision Coverage - covers vehicle collisions\n- AUTO-LIAB-001: Bodily Injury Liability - covers injury to others\n- AUTO-PD-001: Property Damage Liability - covers damage to others' property\n\nHOMEOWNERS:\n- HO-WATER-001: Water Damage Coverage - covers sudden water damage\n- HO-STORM-001: Wind and Hail Coverage - covers storm damage\n\nCOMMERCIAL LIABILITY:\n- CGL-SLIP-001: Premises Liability Coverage - covers slip and fall\n- CGL-MED-001: Medical Payments Coverage - covers medical expenses\n\nReturn the top 3 most relevant clauses with similarity scores.`\n\n    const functions: FunctionCall[] = [{\n      name: 'query_policy_clauses',\n      description: 'Find relevant policy clauses for the claim',\n      parameters: {\n        type: 'object',\n        properties: {\n          relevantClauses: {\n            type: 'array',\n            items: {\n              type: 'object',\n              properties: {\n                clauseId: { type: 'string', description: 'Policy clause ID' },\n                title: { type: 'string', description: 'Clause title' },\n                similarity: { \n                  type: 'number', \n                  minimum: 0, \n                  maximum: 1,\n                  description: 'Similarity score to the claim'\n                },\n                rationale: { type: 'string', description: 'Why this clause is relevant' }\n              },\n              required: ['clauseId', 'title', 'similarity', 'rationale']\n            },\n            maxItems: 3\n          }\n        },\n        required: ['relevantClauses']\n      }\n    }]\n\n    const response = await this.callLLM(prompt, systemPrompt, functions)\n    \n    if (response.functionCalls && response.functionCalls.length > 0) {\n      return response.functionCalls[0].arguments.relevantClauses || []\n    }\n    \n    return []\n  }\n\n  async summarizeProcessing(\n    extractedFields: Record<string, any>,\n    documents: any[],\n    policyHits: any[]\n  ): Promise<{\n    summary: string\n    recommendations: string[]\n    riskFlags: string[]\n  }> {\n    const systemPrompt = `You are a claims processing supervisor. Summarize the automated processing results and provide recommendations.`\n\n    const prompt = `Summarize this automated claim processing:\n\nEXTRACTED FIELDS:\n${JSON.stringify(extractedFields, null, 2)}\n\nDOCUMENTS PROCESSED: ${documents.length}\nDOCUMENT TYPES: ${documents.map(d => d.type).join(', ')}\n\nPOLICY HITS: ${policyHits.length}\nTOP POLICY MATCH: ${policyHits[0]?.title || 'None'}\n\nProvide:\n1. A brief summary of the claim\n2. Recommendations for next steps\n3. Any risk flags or concerns`\n\n    const functions: FunctionCall[] = [{\n      name: 'summarize_claim_processing',\n      description: 'Summarize claim processing results',\n      parameters: {\n        type: 'object',\n        properties: {\n          summary: {\n            type: 'string',\n            description: 'Brief summary of the claim and processing'\n          },\n          recommendations: {\n            type: 'array',\n            items: { type: 'string' },\n            description: 'Recommended next steps'\n          },\n          riskFlags: {\n            type: 'array',\n            items: { type: 'string' },\n            description: 'Risk flags or concerns identified'\n          }\n        },\n        required: ['summary', 'recommendations', 'riskFlags']\n      }\n    }]\n\n    const response = await this.callLLM(prompt, systemPrompt, functions)\n    \n    if (response.functionCalls && response.functionCalls.length > 0) {\n      const args = response.functionCalls[0].arguments\n      return {\n        summary: args.summary || 'Claim processed automatically with extracted information.',\n        recommendations: args.recommendations || ['Review extracted information', 'Verify policy coverage'],\n        riskFlags: args.riskFlags || []\n      }\n    }\n    \n    return {\n      summary: 'Claim processed automatically with extracted information.',\n      recommendations: ['Review extracted information', 'Verify policy coverage'],\n      riskFlags: []\n    }\n  }\n}\n\n// Export singleton instance\nexport const openaiService = new OpenAIService()"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1128, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/lib/agents/nodes/ingestionAgent.ts"],"sourcesContent":["import { AgentState, AgentConfig, UploadedFile } from '../types'\nimport { DocumentType } from '@/types/claims'\nimport { openaiService } from '@/lib/services/openai'\n\nexport class IngestionAgent {\n  async execute(state: AgentState, config: AgentConfig): Promise<Partial<AgentState>> {\n    const startTime = Date.now()\n    \n    try {\n      // Log ingestion start\n      const auditEvent = {\n        step: 'ingestion',\n        timestamp: new Date().toISOString(),\n        duration: 0,\n        agent: 'IngestionAgent',\n        status: 'started' as const,\n        details: {\n          emailLength: state.emailText.length,\n          fileCount: state.files.length,\n          files: state.files.map(f => ({ name: f.name, size: f.size, type: f.mimeType }))\n        }\n      }\n\n      // Normalize email text\n      const normalizedEmail = this.normalizeEmailText(state.emailText)\n      \n      // Process and classify attachments\n      const documents = await this.processAttachments(state.files)\n      \n      // Extract basic metadata\n      const metadata = this.extractEmailMetadata(normalizedEmail)\n      \n      const duration = Date.now() - startTime\n      \n      return {\n        currentStep: 'Document Classification',\n        documents,\n        auditEvents: [...state.auditEvents, {\n          ...auditEvent,\n          duration,\n          status: 'completed',\n          details: {\n            ...auditEvent.details,\n            documentsProcessed: documents.length,\n            metadata\n          }\n        }]\n      }\n    } catch (error) {\n      const duration = Date.now() - startTime\n      \n      return {\n        errors: [...state.errors, `Ingestion failed: ${error}`],\n        auditEvents: [...state.auditEvents, {\n          step: 'ingestion',\n          timestamp: new Date().toISOString(),\n          duration,\n          agent: 'IngestionAgent',\n          status: 'failed',\n          details: { error: String(error) }\n        }]\n      }\n    }\n  }\n\n  private normalizeEmailText(emailText: string): string {\n    // Remove forwarding headers, normalize whitespace\n    return emailText\n      .replace(/^(From:|To:|Subject:|Date:).*$/gm, '') // Remove headers\n      .replace(/\\s+/g, ' ') // Normalize whitespace\n      .trim()\n  }\n\n  private async processAttachments(files: UploadedFile[]): Promise<any[]> {\n    const documents = []\n    \n    for (const file of files) {\n      // Simulate OCR/text extraction\n      const extractedText = await this.simulateOCR(file)\n      \n      try {\n        // Use OpenAI for document classification\n        const classification = await openaiService.classifyDocument(file.name, extractedText)\n        \n        documents.push({\n          id: `doc_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n          name: file.name,\n          type: classification.type as DocumentType,\n          mimeType: file.mimeType,\n          content: extractedText,\n          confidence: classification.confidence,\n          keyFields: classification.keyFields,\n          metadata: {\n            size: file.size,\n            processedAt: new Date().toISOString(),\n            classificationMethod: 'openai'\n          }\n        })\n      } catch (error) {\n        // Fallback to rule-based classification\n        console.warn(`OpenAI classification failed for ${file.name}, using fallback:`, error)\n        const docType = this.classifyDocument(file.name, extractedText)\n        \n        documents.push({\n          id: `doc_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n          name: file.name,\n          type: docType,\n          mimeType: file.mimeType,\n          content: extractedText,\n          confidence: this.calculateConfidence(file.name, extractedText, docType),\n          keyFields: {},\n          metadata: {\n            size: file.size,\n            processedAt: new Date().toISOString(),\n            classificationMethod: 'rule_based_fallback'\n          }\n        })\n      }\n    }\n    \n    return documents\n  }\n\n  private async simulateOCR(file: UploadedFile): Promise<string> {\n    // In a real implementation, this would call Azure Form Recognizer or AWS Textract\n    // For demo, we return the provided content (which simulates extracted text)\n    \n    // Add some realistic OCR processing delay\n    await new Promise(resolve => setTimeout(resolve, 500 + Math.random() * 1000))\n    \n    return file.content || `[OCR extracted content from ${file.name}]`\n  }\n\n  private classifyDocument(fileName: string, content: string): DocumentType {\n    const name = fileName.toLowerCase()\n    const text = content.toLowerCase()\n    \n    // Rule-based classification\n    if (name.includes('police') || text.includes('police report') || text.includes('officer')) {\n      return 'PoliceReport'\n    }\n    if (name.includes('estimate') || name.includes('repair') || text.includes('estimate') || text.includes('labor')) {\n      return 'RepairEstimate'\n    }\n    if (name.includes('invoice') || name.includes('bill') || text.includes('invoice') || text.includes('total due')) {\n      return 'Invoice'\n    }\n    if (name.includes('photo') || name.includes('image') || name.includes('damage') || text.includes('photo')) {\n      return 'DamagePhoto'\n    }\n    if (name.includes('medical') || text.includes('hospital') || text.includes('patient') || text.includes('diagnosis')) {\n      return 'MedicalRecord'\n    }\n    \n    return 'Other'\n  }\n\n  private calculateConfidence(fileName: string, content: string, docType: DocumentType): number {\n    // Simple confidence scoring based on keyword matches\n    let confidence = 0.6 // Base confidence\n    \n    const keywords = this.getKeywordsForDocType(docType)\n    const text = (fileName + ' ' + content).toLowerCase()\n    \n    for (const keyword of keywords) {\n      if (text.includes(keyword)) {\n        confidence += 0.1\n      }\n    }\n    \n    return Math.min(confidence, 1.0)\n  }\n\n  private getKeywordsForDocType(docType: DocumentType): string[] {\n    const keywordMap: Record<DocumentType, string[]> = {\n      PoliceReport: ['police', 'officer', 'badge', 'incident', 'citation', 'vehicle'],\n      RepairEstimate: ['estimate', 'repair', 'labor', 'parts', 'total', 'damage'],\n      Invoice: ['invoice', 'bill', 'payment', 'due', 'amount', 'services'],\n      DamagePhoto: ['photo', 'image', 'damage', 'picture', 'scene'],\n      MedicalRecord: ['hospital', 'patient', 'diagnosis', 'treatment', 'doctor', 'medical'],\n      IncidentReport: ['incident', 'report', 'accident', 'occurred', 'witness', 'details'],\n      Other: []\n    }\n    \n    return keywordMap[docType] || []\n  }\n\n  private extractEmailMetadata(emailText: string): Record<string, any> {\n    const lines = emailText.split('\\n')\n    const metadata: Record<string, any> = {}\n    \n    // Extract basic email components\n    for (const line of lines) {\n      if (line.startsWith('Subject:')) {\n        metadata.subject = line.replace('Subject:', '').trim()\n      }\n      if (line.startsWith('From:')) {\n        metadata.from = line.replace('From:', '').trim()\n      }\n      if (line.startsWith('Date:')) {\n        metadata.date = line.replace('Date:', '').trim()\n      }\n    }\n    \n    return metadata\n  }\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1368, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/lib/agents/nodes/extractionAgent.ts"],"sourcesContent":["import { AgentState, AgentConfig } from '../types'\nimport { FieldEvidence, LossType } from '@/types/claims'\nimport { openaiService } from '@/lib/services/openai'\n\nexport class ExtractionAgent {\n  async execute(state: AgentState, config: AgentConfig): Promise<Partial<AgentState>> {\n    const startTime = Date.now()\n    \n    try {\n      // Extract claim fields using real OpenAI API\n      const extractedFields = await this.extractClaimFields(state.emailText, state.documents)\n      \n      // Generate evidence for each field using OpenAI\n      const fieldEvidence = await this.generateFieldEvidence(extractedFields, state.emailText, state.documents)\n      \n      const duration = Date.now() - startTime\n      \n      return {\n        currentStep: 'Policy Grounding',\n        extractedFields,\n        fieldEvidence,\n        auditEvents: [...state.auditEvents, {\n          step: 'extraction',\n          timestamp: new Date().toISOString(),\n          duration,\n          agent: 'ExtractionAgent',\n          status: 'completed',\n          details: {\n            fieldsExtracted: Object.keys(extractedFields).length,\n            evidenceCount: fieldEvidence.length,\n            avgConfidence: fieldEvidence.reduce((sum, e) => sum + e.confidence, 0) / fieldEvidence.length,\n            llmModel: config.llmModel\n          }\n        }]\n      }\n    } catch (error) {\n      const duration = Date.now() - startTime\n      \n      // Fallback to rule-based extraction if OpenAI fails\n      console.warn('OpenAI extraction failed, falling back to rule-based extraction:', error)\n      const fallbackFields = await this.extractClaimFieldsFallback(state.emailText, state.documents)\n      const fallbackEvidence = await this.generateFieldEvidenceFallback(fallbackFields, state.emailText, state.documents)\n      \n      return {\n        currentStep: 'Policy Grounding',\n        extractedFields: fallbackFields,\n        fieldEvidence: fallbackEvidence,\n        warnings: [...state.warnings, 'OpenAI extraction failed, used fallback extraction'],\n        auditEvents: [...state.auditEvents, {\n          step: 'extraction',\n          timestamp: new Date().toISOString(),\n          duration,\n          agent: 'ExtractionAgent',\n          status: 'completed_with_fallback',\n          details: { \n            error: String(error),\n            fallbackUsed: true,\n            fieldsExtracted: Object.keys(fallbackFields).length\n          }\n        }]\n      }\n    }\n  }\n\n  private async extractClaimFields(emailText: string, documents: any[]): Promise<Record<string, any>> {\n    try {\n      // Use OpenAI to extract claim fields\n      const documentContents = documents.map(d => d.content || '')\n      const extractedFields = await openaiService.extractClaimFields(emailText, documentContents)\n      \n      // Validate and clean the extracted fields\n      return this.validateAndCleanFields(extractedFields)\n    } catch (error) {\n      console.error('OpenAI extraction failed:', error)\n      throw error\n    }\n  }\n\n  private async extractClaimFieldsFallback(emailText: string, documents: any[]): Promise<Record<string, any>> {\n    // Fallback to rule-based extraction\n    const allText = emailText + '\\n\\n' + documents.map(d => d.content).join('\\n\\n')\n    \n    return {\n      policyNumber: this.extractPolicyNumber(allText),\n      claimantName: this.extractClaimantName(allText),\n      contactEmail: this.extractContactEmail(allText),\n      contactPhone: this.extractContactPhone(allText),\n      lossDate: this.extractLossDate(allText),\n      lossType: this.extractLossType(allText),\n      lossLocation: this.extractLossLocation(allText),\n      description: this.extractDescription(allText),\n      vehicleInfo: this.extractVehicleInfo(allText),\n      propertyAddress: this.extractPropertyAddress(allText),\n      estimatedDamage: this.extractEstimatedDamage(allText)\n    }\n  }\n\n  private async generateFieldEvidence(\n    fields: Record<string, any>, \n    emailText: string, \n    documents: any[]\n  ): Promise<FieldEvidence[]> {\n    const evidence: FieldEvidence[] = []\n    const documentContents = documents.map(d => d.content || '')\n    \n    for (const [fieldName, value] of Object.entries(fields)) {\n      if (value) {\n        try {\n          // Use OpenAI to generate evidence analysis\n          const evidenceAnalysis = await openaiService.generateFieldEvidence(\n            fieldName, \n            value, \n            emailText, \n            documentContents\n          )\n          \n          evidence.push({\n            field: fieldName,\n            value: String(value),\n            confidence: evidenceAnalysis.confidence,\n            sourceLocator: evidenceAnalysis.sourceLocator,\n            rationale: evidenceAnalysis.rationale\n          })\n        } catch (error) {\n          // Fallback to rule-based evidence\n          const sourceEvidence = this.findTextEvidence(fieldName, value, emailText + '\\n\\n' + documentContents.join('\\n\\n'), documents)\n          evidence.push({\n            field: fieldName,\n            value: String(value),\n            confidence: sourceEvidence.confidence,\n            sourceLocator: sourceEvidence.locator,\n            rationale: sourceEvidence.rationale\n          })\n        }\n      }\n    }\n    \n    return evidence\n  }\n\n  private async generateFieldEvidenceFallback(\n    fields: Record<string, any>, \n    emailText: string, \n    documents: any[]\n  ): Promise<FieldEvidence[]> {\n    const evidence: FieldEvidence[] = []\n    const allText = emailText + '\\n\\n' + documents.map(d => d.content).join('\\n\\n')\n    \n    for (const [fieldName, value] of Object.entries(fields)) {\n      if (value) {\n        const sourceEvidence = this.findTextEvidence(fieldName, value, allText, documents)\n        evidence.push({\n          field: fieldName,\n          value: String(value),\n          confidence: sourceEvidence.confidence,\n          sourceLocator: sourceEvidence.locator,\n          rationale: sourceEvidence.rationale\n        })\n      }\n    }\n    \n    return evidence\n  }\n\n  private validateAndCleanFields(fields: Record<string, any>): Record<string, any> {\n    const cleaned: Record<string, any> = {}\n    \n    // Clean and validate each field\n    for (const [key, value] of Object.entries(fields)) {\n      if (value !== null && value !== undefined && value !== '') {\n        switch (key) {\n          case 'policyNumber':\n            cleaned[key] = this.maskPolicyNumber(String(value))\n            break\n          case 'contactEmail':\n            cleaned[key] = this.maskEmail(String(value))\n            break\n          case 'contactPhone':\n            cleaned[key] = this.maskPhone(String(value))\n            break\n          case 'lossDate':\n            cleaned[key] = this.validateDate(String(value))\n            break\n          case 'estimatedDamage':\n            cleaned[key] = this.validateAmount(value)\n            break\n          default:\n            cleaned[key] = value\n        }\n      }\n    }\n    \n    return cleaned\n  }\n\n  private maskPolicyNumber(policyNumber: string): string {\n    // Mask policy number for privacy (show only last 3 digits)\n    return policyNumber.length > 3 ? \n      '*'.repeat(policyNumber.length - 3) + policyNumber.slice(-3) :\n      policyNumber\n  }\n\n  private maskEmail(email: string): string {\n    const [username, domain] = email.split('@')\n    if (!domain) return email\n    \n    const maskedUsername = username.length > 4 ?\n      username.substring(0, 2) + '*'.repeat(username.length - 4) + username.slice(-2) :\n      username\n    \n    return `${maskedUsername}@${domain}`\n  }\n\n  private maskPhone(phone: string): string {\n    // Show only last 4 digits\n    const digits = phone.replace(/\\D/g, '')\n    return digits.length > 4 ? \n      '*'.repeat(digits.length - 4) + digits.slice(-4) :\n      phone\n  }\n\n  private validateDate(dateStr: string): string {\n    try {\n      const date = new Date(dateStr)\n      return date.toISOString().split('T')[0] // YYYY-MM-DD format\n    } catch {\n      return dateStr // Return original if parsing fails\n    }\n  }\n\n  private validateAmount(amount: any): number | null {\n    const num = typeof amount === 'number' ? amount : parseFloat(String(amount))\n    return isNaN(num) ? null : num\n  }\n\n  private findTextEvidence(fieldName: string, value: any, allText: string, documents: any[]): {\n    confidence: number\n    locator: string\n    rationale: string\n  } {\n    const valueStr = String(value).toLowerCase()\n    const text = allText.toLowerCase()\n    \n    // Find exact matches first\n    if (text.includes(valueStr)) {\n      const index = text.indexOf(valueStr)\n      const context = allText.substring(Math.max(0, index - 50), index + valueStr.length + 50)\n      \n      return {\n        confidence: 0.95,\n        locator: `text_offset:${index}-${index + valueStr.length}`,\n        rationale: `Direct text match found: \"${context.trim()}\"`\n      }\n    }\n    \n    // Pattern-based matching for specific field types\n    return this.getPatternBasedEvidence(fieldName, value, allText)\n  }\n\n  private getPatternBasedEvidence(fieldName: string, value: any, text: string): {\n    confidence: number\n    locator: string\n    rationale: string\n  } {\n    switch (fieldName) {\n      case 'policyNumber':\n        return {\n          confidence: 0.9,\n          locator: 'pattern_match:policy_format',\n          rationale: 'Matches standard policy number format with prefix and digits'\n        }\n      case 'lossDate':\n        return {\n          confidence: 0.85,\n          locator: 'pattern_match:date_format',\n          rationale: 'Extracted from date context in incident description'\n        }\n      case 'contactEmail':\n        return {\n          confidence: 0.95,\n          locator: 'pattern_match:email_format',\n          rationale: 'Valid email format in sender or contact information'\n        }\n      case 'contactPhone':\n        return {\n          confidence: 0.9,\n          locator: 'pattern_match:phone_format',\n          rationale: 'Standard phone number format with area code'\n        }\n      default:\n        return {\n          confidence: 0.7,\n          locator: 'inference:context',\n          rationale: 'Inferred from contextual information in documents'\n        }\n    }\n  }\n\n  // Field extraction methods\n  private extractPolicyNumber(text: string): string | null {\n    const patterns = [\n      /policy[#\\s]*:?\\s*([A-Z]{2}\\d{9})/i,\n      /policy[#\\s]*:?\\s*([A-Z]{2}\\d{6}\\d{3})/i,\n      /policy[#\\s]*:?\\s*([A-Z]+\\d+)/i\n    ]\n    \n    for (const pattern of patterns) {\n      const match = text.match(pattern)\n      if (match) {\n        return match[1]\n      }\n    }\n    return null\n  }\n\n  private extractClaimantName(text: string): string | null {\n    // Look for name in various contexts\n    const patterns = [\n      /(?:from|name|claimant):\\s*([A-Z][a-z]+\\s+[A-Z][a-z]+)/i,\n      /([A-Z][a-z]+\\s+[A-Z][a-z]+)(?:\\s+<?[\\w._%+-]+@[\\w.-]+\\.[A-Z]{2,}>?)/i\n    ]\n    \n    for (const pattern of patterns) {\n      const match = text.match(pattern)\n      if (match) {\n        return match[1]\n      }\n    }\n    return null\n  }\n\n  private extractContactEmail(text: string): string | null {\n    const pattern = /[\\w._%+-]+@[\\w.-]+\\.[A-Z]{2,}/i\n    const match = text.match(pattern)\n    return match ? match[0] : null\n  }\n\n  private extractContactPhone(text: string): string | null {\n    const patterns = [\n      /\\(?\\d{3}\\)?[-.\\s]?\\d{3}[-.\\s]?\\d{4}/,\n      /\\d{3}[-.\\s]\\d{3}[-.\\s]\\d{4}/\n    ]\n    \n    for (const pattern of patterns) {\n      const match = text.match(pattern)\n      if (match) {\n        return match[0]\n      }\n    }\n    return null\n  }\n\n  private extractLossDate(text: string): string | null {\n    const patterns = [\n      /(?:accident|incident|loss|occurred?).*?(\\d{1,2}\\/\\d{1,2}\\/\\d{4})/i,\n      /(?:march|april|may|june|july|august|september|october|november|december)\\s+\\d{1,2},?\\s+\\d{4}/i\n    ]\n    \n    for (const pattern of patterns) {\n      const match = text.match(pattern)\n      if (match) {\n        return match[1] || match[0]\n      }\n    }\n    return null\n  }\n\n  private extractLossType(text: string): LossType {\n    if (/collision|accident|crash|vehicle|car/i.test(text)) {\n      return 'Collision'\n    }\n    if (/water|flood|leak|pipe|storm/i.test(text)) {\n      return 'Water'\n    }\n    if (/fire|burn|smoke/i.test(text)) {\n      return 'Fire'\n    }\n    if (/theft|stolen|burglary/i.test(text)) {\n      return 'Theft'\n    }\n    if (/liability|slip|fall|injury/i.test(text)) {\n      return 'Liability'\n    }\n    return 'Other'\n  }\n\n  private extractLossLocation(text: string): string | null {\n    const patterns = [\n      /(?:at|location|address):\\s*([^,\\n]+(?:,\\s*[^,\\n]+)*)/i,\n      /(\\d+\\s+[A-Za-z\\s]+(?:street|st|avenue|ave|road|rd|drive|dr|lane|ln|boulevard|blvd))/i\n    ]\n    \n    for (const pattern of patterns) {\n      const match = text.match(pattern)\n      if (match) {\n        return match[1].trim()\n      }\n    }\n    return null\n  }\n\n  private extractDescription(text: string): string | null {\n    // Extract the main incident description\n    const sentences = text.split(/[.!?]+/)\n    const relevantSentences = sentences.filter(s => \n      /accident|incident|damage|occurred|happened|hit|struck|fell|slip|crash/i.test(s)\n    )\n    \n    return relevantSentences.slice(0, 3).join('. ').trim() || null\n  }\n\n  private extractVehicleInfo(text: string): Record<string, any> | null {\n    const yearMatch = text.match(/\\b(19|20)\\d{2}\\b/)\n    const makeMatch = text.match(/\\b(Honda|Toyota|Ford|Chevrolet|BMW|Mercedes|Audi|Nissan|Hyundai|Kia|Mazda|Subaru|Volkswagen|Volvo|Lexus|Acura|Infiniti|Cadillac|Buick|GMC|Jeep|Chrysler|Dodge|Ram)\\b/i)\n    const modelMatch = text.match(/\\b(Civic|Accord|Camry|Corolla|F-150|Silverado|Malibu|Escape|Explorer|CR-V|Pilot|Altima|Sentra|Elantra|Sonata|Optima|Soul|CX-5|Outback|Forester|Jetta|Passat|XC90|ES|IS|RX|GS|LS|Q50|Q60|ATS|CTS|Escalade|LaCrosse|Enclave|Sierra|Terrain|Wrangler|Grand Cherokee|Compass|300|Charger|Challenger|1500|2500|3500)\\b/i)\n    const licenseMatch = text.match(/(?:license|plate)[#\\s]*:?\\s*([A-Z0-9-]+)/i)\n    \n    if (yearMatch || makeMatch || modelMatch) {\n      return {\n        year: yearMatch ? yearMatch[0] : null,\n        make: makeMatch ? makeMatch[0] : null,\n        model: modelMatch ? modelMatch[0] : null,\n        licensePlate: licenseMatch ? licenseMatch[1] : null\n      }\n    }\n    \n    return null\n  }\n\n  private extractPropertyAddress(text: string): string | null {\n    const patterns = [\n      /(?:property|home|house|address):\\s*([^,\\n]+(?:,\\s*[A-Z]{2}\\s*\\d{5})?)/i,\n      /(\\d+\\s+[A-Za-z\\s]+(?:street|st|avenue|ave|road|rd|drive|dr|lane|ln|boulevard|blvd)[^,\\n]*(?:,\\s*[A-Za-z\\s]+,?\\s*[A-Z]{2}\\s*\\d{5})?)/i\n    ]\n    \n    for (const pattern of patterns) {\n      const match = text.match(pattern)\n      if (match) {\n        return match[1].trim()\n      }\n    }\n    return null\n  }\n\n  private extractEstimatedDamage(text: string): number | null {\n    const patterns = [\n      /\\$([0-9,]+\\.?\\d*)/g,\n      /([0-9,]+\\.?\\d*)\\s*dollars?/gi\n    ]\n    \n    const amounts: number[] = []\n    for (const pattern of patterns) {\n      let match\n      while ((match = pattern.exec(text)) !== null) {\n        const amount = parseFloat(match[1].replace(/,/g, ''))\n        if (amount > 100 && amount < 100000) { // Reasonable damage range\n          amounts.push(amount)\n        }\n      }\n    }\n    \n    return amounts.length > 0 ? Math.max(...amounts) : null\n  }\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1766, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/lib/agents/nodes/policyAgent.ts"],"sourcesContent":["import { AgentState, AgentConfig } from '../types'\nimport { PolicyHit } from '@/types/claims'\nimport { openaiService } from '@/lib/services/openai'\n\nexport class PolicyAgent {\n  private policyDatabase: PolicyClause[]\n\n  constructor() {\n    this.policyDatabase = this.initializePolicyDatabase()\n  }\n\n  async execute(state: AgentState, config: AgentConfig): Promise<Partial<AgentState>> {\n    const startTime = Date.now()\n    \n    try {\n      // Query policy database using extracted fields and document context\n      const policyHits = await this.queryPolicyDatabase(\n        state.extractedFields,\n        state.documents,\n        state.emailText\n      )\n\n      const duration = Date.now() - startTime\n      \n      return {\n        currentStep: 'Decision Assembly',\n        policyHits,\n        auditEvents: [...state.auditEvents, {\n          step: 'policy_grounding',\n          timestamp: new Date().toISOString(),\n          duration,\n          agent: 'PolicyAgent',\n          status: 'completed',\n          details: {\n            clausesFound: policyHits.length,\n            avgSimilarity: policyHits.reduce((sum, h) => sum + (h.similarity || h.score || 0), 0) / policyHits.length,\n            topScore: policyHits.length > 0 ? Math.max(...policyHits.map(h => h.similarity || h.score || 0)) : 0\n          }\n        }]\n      }\n    } catch (error) {\n      const duration = Date.now() - startTime\n      \n      return {\n        errors: [...state.errors, `Policy grounding failed: ${error}`],\n        auditEvents: [...state.auditEvents, {\n          step: 'policy_grounding',\n          timestamp: new Date().toISOString(),\n          duration,\n          agent: 'PolicyAgent',\n          status: 'failed',\n          details: { error: String(error) }\n        }]\n      }\n    }\n  }\n\n  private async queryPolicyDatabase(\n    extractedFields: Record<string, any>,\n    documents: any[],\n    emailText: string\n  ): Promise<PolicyHit[]> {\n    try {\n      // Use OpenAI to find relevant policy clauses\n      const lossType = extractedFields.lossType || 'Other'\n      const description = extractedFields.description || 'Claim submitted'\n      \n      const openaiResults = await openaiService.queryPolicyDatabase(lossType, description, extractedFields)\n      \n      // Convert OpenAI results to full PolicyHit format\n      const policyHits: PolicyHit[] = openaiResults.map(result => {\n        const clause = this.policyDatabase.find(c => c.id === result.clauseId)\n        return {\n          clauseId: result.clauseId,\n          title: result.title,\n          content: clause?.content || 'Policy clause content',\n          similarity: result.similarity,\n          rationale: result.rationale,\n          sourceDocument: clause?.sourceDocument || 'Policy Document',\n          section: clause?.section || 'Section Unknown'\n        }\n      })\n      \n      return policyHits\n    } catch (error) {\n      console.warn('OpenAI policy query failed, using fallback:', error)\n      \n      // Fallback to rule-based policy search\n      await new Promise(resolve => setTimeout(resolve, 800 + Math.random() * 500))\n\n      const searchContext = this.buildSearchContext(extractedFields, documents, emailText)\n      const candidateHits = this.findRelevantClauses(searchContext)\n      \n      const scoredHits = candidateHits.map(clause => ({\n        clauseId: clause.id,\n        title: clause.title,\n        content: clause.content,\n        similarity: this.calculateSimilarity(searchContext, clause),\n        rationale: this.generateRationale(searchContext, clause),\n        sourceDocument: clause.sourceDocument,\n        section: clause.section\n      }))\n\n      return scoredHits\n        .filter(hit => hit.similarity >= 0.6)\n        .sort((a, b) => b.similarity - a.similarity)\n        .slice(0, 5)\n    }\n  }\n\n  private buildSearchContext(\n    extractedFields: Record<string, any>,\n    documents: any[],\n    emailText: string\n  ): string {\n    const context = []\n    \n    // Add loss type and description\n    if (extractedFields.lossType) {\n      context.push(`Loss Type: ${extractedFields.lossType}`)\n    }\n    if (extractedFields.description) {\n      context.push(`Description: ${extractedFields.description}`)\n    }\n    \n    // Add document types as context\n    const docTypes = documents.map(d => d.type).join(', ')\n    if (docTypes) {\n      context.push(`Document Types: ${docTypes}`)\n    }\n    \n    // Add key extracted fields\n    const keyFields = ['vehicleInfo', 'propertyAddress', 'estimatedDamage']\n    for (const field of keyFields) {\n      if (extractedFields[field]) {\n        context.push(`${field}: ${JSON.stringify(extractedFields[field])}`)\n      }\n    }\n    \n    return context.join('\\n')\n  }\n\n  private findRelevantClauses(searchContext: string): PolicyClause[] {\n    const context = searchContext.toLowerCase()\n    const relevantClauses = []\n    \n    for (const clause of this.policyDatabase) {\n      const clauseText = clause.content.toLowerCase()\n      const clauseKeywords = clause.keywords.map(k => k.toLowerCase())\n      \n      // Check for keyword matches\n      let hasMatch = false\n      for (const keyword of clauseKeywords) {\n        if (context.includes(keyword) || clauseText.includes(keyword)) {\n          hasMatch = true\n          break\n        }\n      }\n      \n      // Check for loss type matches\n      if (context.includes('collision') && clause.coverage.includes('collision')) hasMatch = true\n      if (context.includes('water') && clause.coverage.includes('water')) hasMatch = true\n      if (context.includes('liability') && clause.coverage.includes('liability')) hasMatch = true\n      if (context.includes('fire') && clause.coverage.includes('fire')) hasMatch = true\n      \n      if (hasMatch) {\n        relevantClauses.push(clause)\n      }\n    }\n    \n    return relevantClauses\n  }\n\n  private calculateSimilarity(searchContext: string, clause: PolicyClause): number {\n    const context = searchContext.toLowerCase()\n    const clauseText = clause.content.toLowerCase()\n    \n    let score = 0.0\n    \n    // Keyword matching (40% of score)\n    let keywordMatches = 0\n    for (const keyword of clause.keywords) {\n      if (context.includes(keyword.toLowerCase())) {\n        keywordMatches++\n      }\n    }\n    score += (keywordMatches / clause.keywords.length) * 0.4\n    \n    // Coverage type matching (30% of score)\n    for (const coverage of clause.coverage) {\n      if (context.includes(coverage.toLowerCase())) {\n        score += 0.3\n        break\n      }\n    }\n    \n    // Text overlap (20% of score)\n    const contextWords = context.split(/\\s+/)\n    const clauseWords = clauseText.split(/\\s+/)\n    const commonWords = contextWords.filter(word => \n      word.length > 3 && clauseWords.includes(word)\n    )\n    score += (commonWords.length / Math.max(contextWords.length, clauseWords.length)) * 0.2\n    \n    // Document type relevance (10% of score)\n    if (clause.applicableDocuments.some(docType => context.includes(docType.toLowerCase()))) {\n      score += 0.1\n    }\n    \n    return Math.min(score, 1.0)\n  }\n\n  private generateRationale(searchContext: string, clause: PolicyClause): string {\n    const context = searchContext.toLowerCase()\n    const reasons = []\n    \n    // Check keyword matches\n    const matchedKeywords = clause.keywords.filter(k => \n      context.includes(k.toLowerCase())\n    )\n    if (matchedKeywords.length > 0) {\n      reasons.push(`Matched keywords: ${matchedKeywords.join(', ')}`)\n    }\n    \n    // Check coverage matches\n    const matchedCoverage = clause.coverage.filter(c => \n      context.includes(c.toLowerCase())\n    )\n    if (matchedCoverage.length > 0) {\n      reasons.push(`Relevant coverage: ${matchedCoverage.join(', ')}`)\n    }\n    \n    // Check document type matches\n    const matchedDocs = clause.applicableDocuments.filter(d => \n      context.includes(d.toLowerCase())\n    )\n    if (matchedDocs.length > 0) {\n      reasons.push(`Applicable documents: ${matchedDocs.join(', ')}`)\n    }\n    \n    return reasons.join('; ') || 'General policy relevance'\n  }\n\n  private initializePolicyDatabase(): PolicyClause[] {\n    return [\n      // Auto Insurance Clauses\n      {\n        id: 'AUTO-COL-001',\n        title: 'Collision Coverage',\n        content: 'We will pay for direct and accidental loss to your covered auto caused by collision with another object or by upset of your covered auto. Collision coverage is subject to the deductible shown in the Declarations.',\n        coverage: ['collision', 'auto'],\n        keywords: ['collision', 'crash', 'accident', 'vehicle', 'auto', 'car', 'deductible'],\n        applicableDocuments: ['PoliceReport', 'RepairEstimate', 'DamagePhoto'],\n        sourceDocument: 'Auto Policy Form AP-2024',\n        section: 'Part D - Coverage for Damage to Your Auto',\n        deductible: 500\n      },\n      {\n        id: 'AUTO-LIAB-001',\n        title: 'Bodily Injury Liability',\n        content: 'We will pay damages for bodily injury for which any insured becomes legally responsible because of an auto accident. We will settle or defend, as we consider appropriate, any claim or suit asking for these damages.',\n        coverage: ['liability', 'bodily injury'],\n        keywords: ['bodily injury', 'liability', 'accident', 'damages', 'lawsuit', 'medical'],\n        applicableDocuments: ['PoliceReport', 'MedicalRecord', 'MedicalBill'],\n        sourceDocument: 'Auto Policy Form AP-2024',\n        section: 'Part A - Liability Coverage'\n      },\n      {\n        id: 'AUTO-PD-001',\n        title: 'Property Damage Liability',\n        content: 'We will pay damages for property damage for which any insured becomes legally responsible because of an auto accident. Property damage means physical injury to, destruction of, or loss of use of tangible property.',\n        coverage: ['liability', 'property damage'],\n        keywords: ['property damage', 'liability', 'accident', 'damages', 'physical injury'],\n        applicableDocuments: ['PoliceReport', 'RepairEstimate', 'DamagePhoto'],\n        sourceDocument: 'Auto Policy Form AP-2024',\n        section: 'Part A - Liability Coverage'\n      },\n      \n      // Homeowners Insurance Clauses  \n      {\n        id: 'HO-WATER-001',\n        title: 'Water Damage Coverage',\n        content: 'We cover sudden and accidental discharge or overflow of water or steam from within a plumbing, heating, air conditioning, or automatic fire protective sprinkler system, or from within a household appliance.',\n        coverage: ['water damage', 'property'],\n        keywords: ['water', 'discharge', 'overflow', 'plumbing', 'pipe', 'leak', 'sudden'],\n        applicableDocuments: ['DamagePhoto', 'RepairEstimate', 'Invoice'],\n        sourceDocument: 'Homeowners Policy Form HO-3',\n        section: 'Section I - Property Coverages',\n        deductible: 1000\n      },\n      {\n        id: 'HO-STORM-001',\n        title: 'Wind and Hail Coverage',\n        content: 'We cover direct physical loss to property caused by windstorm or hail. This coverage includes damage caused by objects blown by wind or falling trees due to wind.',\n        coverage: ['wind', 'hail', 'storm'],\n        keywords: ['wind', 'windstorm', 'hail', 'storm', 'tree', 'branch', 'roof'],\n        applicableDocuments: ['DamagePhoto', 'WeatherReport', 'RepairEstimate'],\n        sourceDocument: 'Homeowners Policy Form HO-3',\n        section: 'Section I - Property Coverages',\n        deductible: 1000\n      },\n      \n      // Commercial Liability Clauses\n      {\n        id: 'CGL-SLIP-001',\n        title: 'Premises Liability Coverage',\n        content: 'We will pay those sums that the insured becomes legally obligated to pay as damages because of bodily injury or property damage to which this insurance applies caused by an occurrence on premises owned or rented by you.',\n        coverage: ['liability', 'premises', 'slip and fall'],\n        keywords: ['slip', 'fall', 'premises', 'liability', 'bodily injury', 'occurrence'],\n        applicableDocuments: ['IncidentReport', 'MedicalRecord', 'WitnessStatement'],\n        sourceDocument: 'Commercial General Liability Policy CGL-2024',\n        section: 'Coverage A - Bodily Injury and Property Damage Liability'\n      },\n      {\n        id: 'CGL-MED-001',\n        title: 'Medical Payments Coverage',\n        content: 'We will pay medical expenses incurred by a person for bodily injury caused by an accident on premises you own or rent or because of your operations, without regard to fault.',\n        coverage: ['medical payments', 'no fault'],\n        keywords: ['medical expenses', 'medical payments', 'accident', 'premises', 'no fault'],\n        applicableDocuments: ['MedicalRecord', 'MedicalBill', 'IncidentReport'],\n        sourceDocument: 'Commercial General Liability Policy CGL-2024',\n        section: 'Coverage C - Medical Payments'\n      }\n    ]\n  }\n}\n\ninterface PolicyClause {\n  id: string\n  title: string\n  content: string\n  coverage: string[]\n  keywords: string[]\n  applicableDocuments: string[]\n  sourceDocument: string\n  section: string\n  deductible?: number\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2151, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/lib/agents/nodes/assemblerAgent.ts"],"sourcesContent":["import { AgentState, AgentConfig } from '../types'\nimport { ClaimData, DecisionPack, ClaimDraft } from '@/types/claims'\n\nexport class AssemblerAgent {\n  async execute(state: AgentState, config: AgentConfig): Promise<Partial<AgentState>> {\n    const startTime = Date.now()\n    \n    try {\n      // Create the final claim data structure\n      const claimData = await this.assembleClaimData(state)\n      \n      const duration = Date.now() - startTime\n      \n      return {\n        currentStep: 'Review',\n        claimData,\n        auditEvents: [...state.auditEvents, {\n          step: 'assembly',\n          timestamp: new Date().toISOString(),\n          duration,\n          agent: 'AssemblerAgent',\n          status: 'completed',\n          details: {\n            fieldsAssembled: Object.keys(state.extractedFields).length,\n            documentsProcessed: state.documents.length,\n            policyHitsIncluded: state.policyHits.length,\n            totalProcessingTime: Date.now() - state.startTime\n          }\n        }]\n      }\n    } catch (error) {\n      const duration = Date.now() - startTime\n      \n      return {\n        errors: [...state.errors, `Assembly failed: ${error}`],\n        auditEvents: [...state.auditEvents, {\n          step: 'assembly',\n          timestamp: new Date().toISOString(),\n          duration,\n          agent: 'AssemblerAgent',\n          status: 'failed',\n          details: { error: String(error) }\n        }]\n      }\n    }\n  }\n\n  private async assembleClaimData(state: AgentState): Promise<ClaimData> {\n    // Create claim draft\n    const claimDraft = this.createClaimDraft(state.extractedFields, state.documents)\n    \n    // Assemble decision pack\n    const decisionPack = this.createDecisionPack(\n      claimDraft,\n      state.fieldEvidence,\n      state.documents,\n      state.policyHits,\n      state.auditEvents\n    )\n    \n    // Calculate processing metrics\n    const processingMetrics = this.calculateProcessingMetrics(state)\n    \n    return {\n      claimId: this.generateClaimId(),\n      decisionPack: {\n        ...decisionPack,\n        claimDraft,\n        evidence: state.fieldEvidence,\n        documents: state.documents,\n        policyGrounding: state.policyHits,\n        audit: state.auditEvents\n      },\n      auditTrail: state.auditEvents,\n      processingMetrics,\n      createdAt: new Date().toISOString(),\n      status: 'draft'\n    }\n  }\n\n  private createClaimDraft(extractedFields: Record<string, any>, documents: any[]): ClaimDraft {\n    return {\n      id: this.generateDraftId(),\n      policyNumber: this.sanitizePolicyNumber(extractedFields.policyNumber),\n      claimantName: extractedFields.claimantName || 'Unknown',\n      contactEmail: this.maskEmail(extractedFields.contactEmail),\n      contactPhone: this.maskPhone(extractedFields.contactPhone),\n      lossDate: this.formatDate(extractedFields.lossDate),\n      lossType: extractedFields.lossType || 'Other',\n      lossLocation: extractedFields.lossLocation || 'Not specified',\n      description: extractedFields.description || 'Claim details extracted from submitted documents',\n      estimatedAmount: extractedFields.estimatedDamage || null,\n      \n      // Vehicle-specific fields\n      vehicleInfo: extractedFields.vehicleInfo || null,\n      \n      // Property-specific fields  \n      propertyAddress: extractedFields.propertyAddress || null,\n      \n      // Attachments reference\n      attachments: documents.map(doc => ({\n        id: doc.id,\n        name: doc.name,\n        mimeType: doc.mimeType || 'application/octet-stream',\n        type: doc.type,\n        confidence: doc.confidence\n      })),\n      \n      // Coverage assessment\n      coverageFound: this.assessCoverage(extractedFields),\n      deductible: this.determineDeductible(extractedFields),\n      \n      // Metadata\n      createdAt: new Date().toISOString(),\n      source: 'automated_extraction',\n      confidence: this.calculateOverallConfidence(extractedFields)\n    }\n  }\n\n  private createDecisionPack(\n    claimDraft: ClaimDraft,\n    evidence: any[],\n    documents: any[],\n    policyHits: any[],\n    auditEvents: any[]\n  ): DecisionPack {\n    return {\n      id: this.generateDecisionPackId(),\n      claimDraft,\n      evidence,\n      documents,\n      policyGrounding: policyHits,\n      audit: auditEvents,\n      \n      // Evidence summary\n      evidenceSummary: {\n        totalFields: evidence.length,\n        highConfidenceFields: evidence.filter(e => e.confidence >= 0.8).length,\n        lowConfidenceFields: evidence.filter(e => e.confidence < 0.6).length,\n        avgConfidence: evidence.reduce((sum, e) => sum + e.confidence, 0) / evidence.length\n      },\n      \n      // Document analysis\n      documentAnalysis: {\n        totalDocuments: documents.length,\n        documentTypes: [...new Set(documents.map(d => d.type))],\n        avgDocumentConfidence: documents.reduce((sum, d) => sum + d.confidence, 0) / documents.length,\n        missingDocuments: this.identifyMissingDocuments(claimDraft.lossType, documents)\n      },\n      \n      // Policy assessment\n      policyAssessment: {\n        clausesFound: policyHits.length,\n        coverageConfirmed: policyHits.length > 0,\n        topSimilarityScore: policyHits.length > 0 ? Math.max(...policyHits.map(h => h.similarity)) : 0,\n        recommendedActions: this.generateRecommendations(claimDraft, policyHits, evidence)\n      },\n      \n      // Processing summary\n      processingSummary: {\n        totalTime: auditEvents.length > 0 ? \n          auditEvents.reduce((sum, e) => sum + e.duration, 0) : 0,\n        stepsCompleted: auditEvents.filter(e => e.status === 'completed').length,\n        stepsWithErrors: auditEvents.filter(e => e.status === 'failed').length,\n        automationLevel: this.calculateAutomationLevel(evidence)\n      },\n      \n      createdAt: new Date().toISOString()\n    }\n  }\n\n  private calculateProcessingMetrics(state: AgentState): any {\n    const totalTime = Date.now() - state.startTime\n    const completedSteps = state.auditEvents.filter(e => e.status === 'completed').length\n    const failedSteps = state.auditEvents.filter(e => e.status === 'failed').length\n    \n    return {\n      totalProcessingTime: totalTime,\n      averageHandleTime: totalTime / 60000, // in minutes\n      fieldsAutoPopulated: Object.keys(state.extractedFields).filter(key => \n        state.extractedFields[key] !== null && state.extractedFields[key] !== undefined\n      ).length,\n      overrideRate: 0, // Would be calculated based on manual corrections\n      ragHitRate: state.policyHits.length > 0 ? 1 : 0,\n      stepsCompleted: completedSteps,\n      stepsFailed: failedSteps,\n      successRate: completedSteps / (completedSteps + failedSteps)\n    }\n  }\n\n  // Utility methods\n  private generateClaimId(): string {\n    return `CLM-${Date.now()}-${Math.random().toString(36).substr(2, 6).toUpperCase()}`\n  }\n\n  private generateDraftId(): string {\n    return `DRAFT-${Date.now()}-${Math.random().toString(36).substr(2, 4).toUpperCase()}`\n  }\n\n  private generateDecisionPackId(): string {\n    return `DP-${Date.now()}-${Math.random().toString(36).substr(2, 8).toUpperCase()}`\n  }\n\n  private sanitizePolicyNumber(policyNumber: string | null): string {\n    if (!policyNumber) return 'Unknown'\n    // Mask policy number for privacy (show only last 3 digits)\n    return policyNumber.length > 3 ? \n      '*'.repeat(policyNumber.length - 3) + policyNumber.slice(-3) :\n      policyNumber\n  }\n\n  private maskEmail(email: string | null): string {\n    if (!email) return ''\n    const [username, domain] = email.split('@')\n    if (!domain) return email\n    \n    const maskedUsername = username.length > 4 ?\n      username.substring(0, 2) + '*'.repeat(username.length - 4) + username.slice(-2) :\n      username\n    \n    return `${maskedUsername}@${domain}`\n  }\n\n  private maskPhone(phone: string | null): string {\n    if (!phone) return ''\n    // Show only last 4 digits\n    const digits = phone.replace(/\\D/g, '')\n    return digits.length > 4 ? \n      '*'.repeat(digits.length - 4) + digits.slice(-4) :\n      phone\n  }\n\n  private formatDate(dateStr: string | null): string {\n    if (!dateStr) return ''\n    \n    try {\n      const date = new Date(dateStr)\n      return date.toISOString().split('T')[0] // YYYY-MM-DD format\n    } catch {\n      return dateStr // Return original if parsing fails\n    }\n  }\n\n  private assessCoverage(extractedFields: Record<string, any>): boolean {\n    // Simple coverage assessment based on policy number presence\n    return !!extractedFields.policyNumber\n  }\n\n  private determineDeductible(extractedFields: Record<string, any>): number | undefined {\n    // Default deductibles based on loss type\n    const lossType = extractedFields.lossType\n    const defaultDeductibles: Record<string, number> = {\n      'Collision': 500,\n      'Water': 1000,\n      'Wind': 1000,\n      'Liability': 0\n    }\n    \n    return defaultDeductibles[lossType] || undefined\n  }\n\n  private calculateOverallConfidence(extractedFields: Record<string, any>): number {\n    const fields = Object.values(extractedFields).filter(v => v !== null && v !== undefined)\n    const requiredFields = ['policyNumber', 'claimantName', 'lossDate', 'lossType']\n    const presentRequired = requiredFields.filter(field => extractedFields[field]).length\n    \n    return (presentRequired / requiredFields.length) * 0.6 + (fields.length / 10) * 0.4\n  }\n\n  private identifyMissingDocuments(lossType: string, documents: any[]): string[] {\n    const presentTypes = new Set(documents.map(d => d.type))\n    const expectedDocuments: Record<string, string[]> = {\n      'Collision': ['PoliceReport', 'RepairEstimate', 'DamagePhoto'],\n      'Water': ['DamagePhoto', 'RepairEstimate'],\n      'Liability': ['IncidentReport', 'MedicalRecord'],\n      'Fire': ['DamagePhoto', 'RepairEstimate', 'FireReport'],\n      'Theft': ['PoliceReport', 'ItemList']\n    }\n    \n    const expected = expectedDocuments[lossType] || []\n    return expected.filter(docType => !presentTypes.has(docType))\n  }\n\n  private generateRecommendations(\n    claimDraft: ClaimDraft, \n    policyHits: any[], \n    evidence: any[]\n  ): string[] {\n    const recommendations = []\n    \n    // Coverage recommendations\n    if (policyHits.length === 0) {\n      recommendations.push('No matching policy clauses found - review coverage manually')\n    } else if (policyHits[0].similarity < 0.8) {\n      recommendations.push('Low policy match confidence - adjuster review recommended')\n    }\n    \n    // Evidence recommendations\n    const lowConfidenceFields = evidence.filter(e => e.confidence < 0.6)\n    if (lowConfidenceFields.length > 0) {\n      recommendations.push(`${lowConfidenceFields.length} fields need manual verification`)\n    }\n    \n    // Amount recommendations\n    if (claimDraft.estimatedAmount && claimDraft.estimatedAmount > 10000) {\n      recommendations.push('High-value claim - senior adjuster review required')\n    }\n    \n    // Document recommendations\n    if (!claimDraft.attachments.some(a => a.type === 'DamagePhoto')) {\n      recommendations.push('Damage photos recommended for claim validation')\n    }\n    \n    return recommendations\n  }\n\n  private calculateAutomationLevel(evidence: any[]): number {\n    const highConfidenceFields = evidence.filter(e => e.confidence >= 0.8).length\n    return evidence.length > 0 ? highConfidenceFields / evidence.length : 0\n  }\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2443, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/lib/agents/orchestrator.ts"],"sourcesContent":["import { AgentState, AgentConfig, UploadedFile } from './types'\nimport { ClaimData } from '@/types/claims'\nimport { IngestionAgent } from './nodes/ingestionAgent'\nimport { ExtractionAgent } from './nodes/extractionAgent'\nimport { PolicyAgent } from './nodes/policyAgent'\nimport { AssemblerAgent } from './nodes/assemblerAgent'\n\nexport class LangGraphOrchestrator {\n  private ingestionAgent: IngestionAgent\n  private extractionAgent: ExtractionAgent\n  private policyAgent: PolicyAgent\n  private assemblerAgent: AssemblerAgent\n  private config: AgentConfig\n  private hasOpenAIKey: boolean\n\n  constructor(config?: Partial<AgentConfig>) {\n    this.config = {\n      llmModel: process.env.OPENAI_MODEL || 'gpt-4-1106-preview',\n      confidenceThreshold: 0.6,\n      maxRetries: 3,\n      timeoutMs: 30000,\n      ...config\n    }\n\n    // Check if OpenAI API key is available\n    this.hasOpenAIKey = !!(process.env.OPENAI_API_KEY || (typeof window !== 'undefined' && (window as any).OPENAI_API_KEY))\n\n    // Initialize agent nodes\n    this.ingestionAgent = new IngestionAgent()\n    this.extractionAgent = new ExtractionAgent()\n    this.policyAgent = new PolicyAgent()\n    this.assemblerAgent = new AssemblerAgent()\n  }\n\n  async processClaim(emailText: string, files: UploadedFile[]): Promise<ClaimData> {\n    const startTime = Date.now()\n    \n    // Initialize agent state\n    let state: AgentState = {\n      emailText,\n      files,\n      currentStep: 'Initializing',\n      startTime,\n      documents: [],\n      extractedFields: {},\n      fieldEvidence: [],\n      policyHits: [],\n      auditEvents: [],\n      errors: [],\n      warnings: []\n    }\n\n    try {\n      // Execute agent workflow in sequence\n      state = await this.executeWorkflow(state)\n      \n      if (state.claimData) {\n        return state.claimData\n      } else {\n        throw new Error('Workflow completed but no claim data generated')\n      }\n    } catch (error) {\n      // Add error to audit trail\n      state.auditEvents.push({\n        step: 'orchestrator_error',\n        timestamp: new Date().toISOString(),\n        duration: Date.now() - startTime,\n        agent: 'Orchestrator',\n        status: 'failed',\n        details: { error: String(error) }\n      })\n\n      throw new Error(`Claim processing failed: ${error}`)\n    }\n  }\n\n  private async executeWorkflow(initialState: AgentState): Promise<AgentState> {\n    let state = { ...initialState }\n\n    // Step 1: Ingestion Agent\n    state.currentStep = 'Document Ingestion'\n    state = { ...state, ...(await this.executeWithRetry(\n      () => this.ingestionAgent.execute(state, this.config),\n      'ingestion'\n    ))}\n\n    // Step 2: Extraction Agent\n    state.currentStep = 'Field Extraction'\n    state = { ...state, ...(await this.executeWithRetry(\n      () => this.extractionAgent.execute(state, this.config),\n      'extraction'\n    ))}\n\n    // Step 3: Policy Agent\n    state.currentStep = 'Policy Grounding'\n    state = { ...state, ...(await this.executeWithRetry(\n      () => this.policyAgent.execute(state, this.config),\n      'policy_grounding'\n    ))}\n\n    // Step 4: Assembler Agent\n    state.currentStep = 'Decision Assembly'\n    state = { ...state, ...(await this.executeWithRetry(\n      () => this.assemblerAgent.execute(state, this.config),\n      'assembly'\n    ))}\n\n    return state\n  }\n\n  private async executeWithRetry<T>(\n    operation: () => Promise<T>,\n    stepName: string,\n    retryCount = 0\n  ): Promise<T> {\n    try {\n      return await Promise.race([\n        operation(),\n        this.createTimeoutPromise()\n      ])\n    } catch (error) {\n      if (retryCount < this.config.maxRetries) {\n        // Log retry attempt\n        console.warn(`Retrying ${stepName} (attempt ${retryCount + 1}): ${error}`)\n        \n        // Exponential backoff\n        await new Promise(resolve => \n          setTimeout(resolve, Math.pow(2, retryCount) * 1000)\n        )\n        \n        return this.executeWithRetry(operation, stepName, retryCount + 1)\n      } else {\n        throw new Error(`${stepName} failed after ${this.config.maxRetries} retries: ${error}`)\n      }\n    }\n  }\n\n  private createTimeoutPromise(): Promise<never> {\n    return new Promise((_, reject) => {\n      setTimeout(() => {\n        reject(new Error(`Operation timed out after ${this.config.timeoutMs}ms`))\n      }, this.config.timeoutMs)\n    })\n  }\n\n  // Utility methods for monitoring and debugging\n  getProcessingStatus(state: AgentState): {\n    currentStep: string\n    progress: number\n    estimatedTimeRemaining: number\n    errors: string[]\n  } {\n    const totalSteps = 4 // ingestion, extraction, policy, assembly\n    const completedSteps = state.auditEvents.filter(e => e.status === 'completed').length\n    const progress = completedSteps / totalSteps\n    \n    const avgStepTime = state.auditEvents.length > 0 ?\n      state.auditEvents.reduce((sum, e) => sum + e.duration, 0) / state.auditEvents.length :\n      2000 // Default 2 seconds per step\n    \n    const estimatedTimeRemaining = (totalSteps - completedSteps) * avgStepTime\n\n    return {\n      currentStep: state.currentStep,\n      progress,\n      estimatedTimeRemaining,\n      errors: state.errors\n    }\n  }\n\n  getAuditTrail(state: AgentState): any[] {\n    return state.auditEvents.map(event => ({\n      ...event,\n      formattedDuration: `${event.duration}ms`,\n      formattedTimestamp: new Date(event.timestamp).toLocaleString()\n    }))\n  }\n\n  // Configuration management\n  updateConfig(newConfig: Partial<AgentConfig>): void {\n    this.config = { ...this.config, ...newConfig }\n  }\n\n  getConfig(): AgentConfig {\n    return { ...this.config }\n  }\n\n  // Check OpenAI integration status\n  getOpenAIStatus(): {\n    available: boolean\n    model: string\n    message: string\n  } {\n    return {\n      available: this.hasOpenAIKey,\n      model: this.config.llmModel,\n      message: this.hasOpenAIKey \n        ? `OpenAI integration active with ${this.config.llmModel}` \n        : 'OpenAI API key not configured - using simulation mode'\n    }\n  }\n\n  // Health check for the orchestrator\n  async healthCheck(): Promise<{\n    status: 'healthy' | 'degraded' | 'unhealthy'\n    details: Record<string, any>\n  }> {\n    try {\n      // Test with minimal input\n      const testState: AgentState = {\n        emailText: 'Test health check',\n        files: [],\n        currentStep: 'health_check',\n        startTime: Date.now(),\n        documents: [],\n        extractedFields: {},\n        fieldEvidence: [],\n        policyHits: [],\n        auditEvents: [],\n        errors: [],\n        warnings: []\n      }\n\n      // Quick test of each agent\n      const results = await Promise.allSettled([\n        this.ingestionAgent.execute(testState, this.config),\n        this.extractionAgent.execute(testState, this.config),\n        this.policyAgent.execute(testState, this.config),\n        this.assemblerAgent.execute(testState, this.config)\n      ])\n\n      const failedAgents = results.filter(r => r.status === 'rejected').length\n      const openaiStatus = this.getOpenAIStatus()\n      \n      return {\n        status: failedAgents === 0 ? 'healthy' : failedAgents <= 1 ? 'degraded' : 'unhealthy',\n        details: {\n          agentsOnline: results.length - failedAgents,\n          totalAgents: results.length,\n          config: this.config,\n          openaiStatus,\n          timestamp: new Date().toISOString()\n        }\n      }\n    } catch (error) {\n      return {\n        status: 'unhealthy',\n        details: {\n          error: String(error),\n          timestamp: new Date().toISOString()\n        }\n      }\n    }\n  }\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2666, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/lib/claimProcessor.ts"],"sourcesContent":["import { ClaimData } from '@/types/claims'\nimport { LangGraphOrchestrator } from './agents/orchestrator'\nimport { UploadedFile } from './agents/types'\n\n// Initialize the LangGraph orchestrator\nlet orchestrator: LangGraphOrchestrator | null = null\n\nfunction getOrchestrator(): LangGraphOrchestrator {\n  if (!orchestrator) {\n    orchestrator = new LangGraphOrchestrator({\n      llmModel: (typeof window !== 'undefined' && (window as any).OPENAI_MODEL) || 'gpt-4-1106-preview',\n      confidenceThreshold: 0.6,\n      maxRetries: 2,\n      timeoutMs: 30000\n    })\n  }\n  return orchestrator\n}\n\n// Interface for files uploaded via UI\ninterface UIUploadedFile {\n  id: string\n  name: string\n  type: string\n  size: number\n}\n\nexport async function processClaim(emailText: string, files: UIUploadedFile[]): Promise<ClaimData> {\n  const orchestrator = getOrchestrator()\n  \n  try {\n    // Convert UI files to agent format\n    const agentFiles: UploadedFile[] = files.map(file => ({\n      name: file.name,\n      content: getFileContent(file.name),\n      mimeType: file.type,\n      size: file.size\n    }))\n\n    // Use the real LangGraph orchestrator\n    const claimData = await orchestrator.processClaim(emailText, agentFiles)\n    \n    // Add OpenAI status to audit trail\n    const openaiStatus = orchestrator.getOpenAIStatus()\n    claimData.auditTrail.push({\n      step: 'system_info',\n      timestamp: new Date().toISOString(),\n      duration: 0,\n      agent: 'System',\n      status: 'completed',\n      details: {\n        openaiIntegration: openaiStatus.available ? 'active' : 'demo_mode',\n        model: openaiStatus.model\n      }\n    })\n\n    return claimData\n  } catch (error) {\n    console.error('Claim processing failed:', error)\n    return await processClaimFallback(emailText, files)\n  }\n}\n\n// Get demo file content based on filename\nfunction getFileContent(filename: string): string {\n  const name = filename.toLowerCase()\n  \n  if (name.includes('police')) {\n    return `SPRINGFIELD POLICE DEPARTMENT\nTRAFFIC ACCIDENT REPORT\n\nCase Number: 2024-031534\nDate: March 15, 2024\nLocation: Oak Street & 5th Avenue\n\nVEHICLE 1:\nDriver: Johnson, Sarah M.\nVehicle: 2019 Honda Civic\nLicense Plate: XYZ-789\nDamage: Moderate damage to passenger side\n\nNARRATIVE:\nVehicle 2 proceeded through intersection against red traffic signal, striking Vehicle 1.`\n  }\n  \n  if (name.includes('repair') || name.includes('estimate')) {\n    return `JOE'S AUTO BODY SHOP\nREPAIR ESTIMATE\n\nCustomer: Sarah Johnson\nVehicle: 2019 Honda Civic\n\nPARTS REQUIRED:\n- Passenger front door shell: $1,245.00\n- Door handle: $85.00\n- Door glass: $220.00\n\nLABOR:\n- Remove and replace door: $337.50\n- Paint work: $487.50\n\nTOTAL ESTIMATE: $5,349.81`\n  }\n  \n  return `[Document content for ${filename}]`\n}\n\n// Extract fields from email text using regex patterns\nfunction extractFieldsFromEmail(emailText: string): Record<string, string | null> {\n  // Policy number patterns (various formats)\n  const policyPatterns = [\n    /policy\\s*#?:?\\s*([A-Z0-9]{6,})/i,\n    /policy\\s*number\\s*:?\\s*([A-Z0-9]{6,})/i,\n    /#([A-Z0-9]{6,})/,\n    /([A-Z]{2}\\d{6,})/g\n  ]\n  \n  // Phone number patterns\n  const phonePatterns = [\n    /(?:phone|tel|call)\\s*:?\\s*(\\(?\\d{3}\\)?[-.\\s]?\\d{3}[-.\\s]?\\d{4})/i,\n    /(\\(?\\d{3}\\)?[-.\\s]?\\d{3}[-.\\s]?\\d{4})/g\n  ]\n  \n  // Email patterns\n  const emailPatterns = [\n    /from:\\s*([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,})/i,\n    /([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,})/g\n  ]\n  \n  // Date patterns\n  const datePatterns = [\n    /(?:on|date|occurred|happened).*?(\\d{1,2}\\/\\d{1,2}\\/\\d{4})/i,\n    /(\\d{1,2}\\/\\d{1,2}\\/\\d{4})/g,\n    /(?:march|april|may|june|july|august|september|october|november|december)\\s+\\d{1,2},?\\s+\\d{4}/i\n  ]\n  \n  // Name patterns (from signature or sender)\n  const namePatterns = [\n    /thanks,?\\s*([A-Z][a-z]+\\s+[A-Z][a-z]+)/i,\n    /sincerely,?\\s*([A-Z][a-z]+\\s+[A-Z][a-z]+)/i,\n    /from:\\s*([A-Z][a-z]+\\s+[A-Z][a-z]+)/i,\n    /([A-Z][a-z]+\\s+[A-Z][a-z]+)$/m\n  ]\n  \n  const extracted: Record<string, string | null> = {}\n  \n  // Extract policy number\n  for (const pattern of policyPatterns) {\n    const match = emailText.match(pattern)\n    if (match && match[1]) {\n      extracted.policyNumber = match[1]\n      break\n    }\n  }\n  \n  // Extract phone number\n  for (const pattern of phonePatterns) {\n    const match = emailText.match(pattern)\n    if (match && match[1]) {\n      extracted.contactPhone = match[1]\n      break\n    }\n  }\n  \n  // Extract email\n  for (const pattern of emailPatterns) {\n    const match = emailText.match(pattern)\n    if (match && match[1]) {\n      extracted.contactEmail = match[1]\n      break\n    }\n  }\n  \n  // Extract date\n  for (const pattern of datePatterns) {\n    const match = emailText.match(pattern)\n    if (match && match[1]) {\n      extracted.lossDate = match[1]\n      break\n    }\n  }\n  \n  // Extract name\n  for (const pattern of namePatterns) {\n    const match = emailText.match(pattern)\n    if (match && match[1]) {\n      extracted.claimantName = match[1]\n      break\n    }\n  }\n  \n  // Extract description (first substantial paragraph)\n  const lines = emailText.split('\\n').filter(line => line.trim().length > 20)\n  const descriptionLine = lines.find(line => \n    !line.toLowerCase().includes('subject:') &&\n    !line.toLowerCase().includes('from:') &&\n    !line.toLowerCase().includes('to:') &&\n    !line.toLowerCase().includes('date:') &&\n    line.length > 30\n  )\n  if (descriptionLine) {\n    extracted.description = descriptionLine.trim()\n  }\n  \n  return extracted\n}\n\n// Fallback processing\nasync function processClaimFallback(emailText: string, files: UIUploadedFile[]): Promise<ClaimData> {\n  await new Promise(resolve => setTimeout(resolve, 2000))\n  \n  // Extract actual fields from email text using simple regex patterns\n  const extractedData = extractFieldsFromEmail(emailText)\n  \n  // Create evidence based on actual extraction\n  const mockEvidence = [\n    {\n      field: 'policyNumber',\n      fieldName: 'Policy Number',\n      value: extractedData.policyNumber || 'Not found',\n      confidence: extractedData.policyNumber ? 0.9 : 0.1,\n      sourceLocator: 'email_content',\n      rationale: extractedData.policyNumber ? 'Found policy number in email text' : 'Policy number not detected'\n    },\n    {\n      field: 'claimantName',\n      fieldName: 'Claimant Name',\n      value: extractedData.claimantName || 'Not found',\n      confidence: extractedData.claimantName ? 0.85 : 0.1,\n      sourceLocator: 'email_signature',\n      rationale: extractedData.claimantName ? 'Extracted from email signature' : 'Name not detected'\n    },\n    {\n      field: 'contactEmail',\n      fieldName: 'Contact Email',\n      value: extractedData.contactEmail || 'Not found',\n      confidence: extractedData.contactEmail ? 0.9 : 0.1,\n      sourceLocator: 'email_header',\n      rationale: extractedData.contactEmail ? 'Extracted from email header' : 'Email not detected'\n    },\n    {\n      field: 'contactPhone',\n      fieldName: 'Contact Phone',\n      value: extractedData.contactPhone || 'Not found',\n      confidence: extractedData.contactPhone ? 0.85 : 0.1,\n      sourceLocator: 'email_body',\n      rationale: extractedData.contactPhone ? 'Found phone number in email' : 'Phone not detected'\n    },\n    {\n      field: 'lossDate',\n      fieldName: 'Loss Date',\n      value: extractedData.lossDate || 'Not found',\n      confidence: extractedData.lossDate ? 0.8 : 0.1,\n      sourceLocator: 'email_body',\n      rationale: extractedData.lossDate ? 'Extracted loss date from description' : 'Date not detected'\n    },\n    {\n      field: 'description',\n      fieldName: 'Description',\n      value: extractedData.description || 'Claim submitted via email',\n      confidence: extractedData.description ? 0.7 : 0.3,\n      sourceLocator: 'email_body',\n      rationale: extractedData.description ? 'Extracted incident description' : 'Using default description'\n    }\n  ]\n\n  const mockDocuments = files.map((file, index) => ({\n    id: `doc_${index}`,\n    name: file.name,\n    mimeType: file.type,\n    type: 'Other' as any,\n    content: `Document content for ${file.name}`,\n    confidence: 0.8,\n    metadata: {}\n  }))\n\n  const mockPolicyGrounding = [\n    {\n      clauseId: 'SEC_003',\n      title: 'Collision Coverage',\n      snippet: 'Covers damage to your vehicle from collisions',\n      score: 0.92,\n      rationale: 'High match for collision claim type'\n    }\n  ]\n\n  const mockAuditEvents = [\n    {\n      step: 'document_processing',\n      timestamp: new Date().toISOString(),\n      duration: 1500,\n      agent: 'IngestionAgent',\n      status: 'completed' as any,\n      details: { documentsProcessed: files.length }\n    }\n  ]\n  \n  // Mask PII in extracted data\n  const maskEmail = (email: string | null) => {\n    if (!email) return 'Not found'\n    const [user, domain] = email.split('@')\n    return `${user.slice(0, 2)}***@${domain}`\n  }\n  \n  const maskPhone = (phone: string | null) => {\n    if (!phone) return 'Not found'\n    return phone.replace(/\\d(?=\\d{4})/g, '*')\n  }\n  \n  const claimDraft = {\n    id: `DRAFT-${Date.now()}`,\n    policyNumber: extractedData.policyNumber ? `***${extractedData.policyNumber.slice(-3)}` : 'Not found',\n    claimantName: extractedData.claimantName || 'Not found',\n    contactEmail: maskEmail(extractedData.contactEmail),\n    contactPhone: maskPhone(extractedData.contactPhone),\n    lossDate: extractedData.lossDate || new Date().toISOString().split('T')[0],\n    lossType: 'Other' as any, // Default since we can't determine from basic regex\n    lossLocation: 'See description',\n    description: extractedData.description || 'Claim submitted via email',\n    estimatedAmount: 0, // Not extractable from basic parsing\n    vehicleInfo: undefined,\n    propertyAddress: undefined,\n    attachments: files.map((file, index) => ({\n      id: `doc_${index}`,\n      name: file.name,\n      type: 'Other' as any,\n      mimeType: file.type,\n      confidence: 0.8\n    })),\n    coverageFound: !!extractedData.policyNumber,\n    deductible: extractedData.policyNumber ? 500 : undefined,\n    createdAt: new Date().toISOString(),\n    source: 'rule_based_extraction',\n    confidence: Object.values(extractedData).filter(v => v).length / 6 // Rough confidence based on fields found\n  }\n  \n  return {\n    claimId: `CLM-${Date.now()}`,\n    decisionPack: {\n      id: `DP-${Date.now()}`,\n      claimDraft: claimDraft,\n      evidence: mockEvidence,\n      documents: mockDocuments,\n      policyGrounding: mockPolicyGrounding,\n      audit: mockAuditEvents,\n      evidenceSummary: { totalFields: 8, highConfidenceFields: 6, lowConfidenceFields: 1, avgConfidence: 0.85 },\n      documentAnalysis: { totalDocuments: files.length, documentTypes: ['PoliceReport'], avgDocumentConfidence: 0.8, missingDocuments: [] },\n      policyAssessment: { clausesFound: 2, coverageConfirmed: true, topSimilarityScore: 0.92, recommendedActions: ['Proceed with claim'] },\n      processingSummary: { totalTime: 2000, stepsCompleted: 4, stepsWithErrors: 0, automationLevel: 0.9 },\n      createdAt: new Date().toISOString()\n    },\n    auditTrail: [\n      { step: 'fallback_processing', timestamp: new Date().toISOString(), duration: 2000, agent: 'FallbackAgent', status: 'completed', details: {} }\n    ],\n    processingMetrics: {\n      totalProcessingTime: 2000,\n      averageHandleTime: 2.0,\n      fieldsAutoPopulated: 8,\n      overrideRate: 0.1,\n      ragHitRate: 1.0,\n      stepsCompleted: 4,\n      stepsFailed: 0,\n      successRate: 1.0\n    },\n    createdAt: new Date().toISOString(),\n    status: 'draft'\n  }\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3026, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/components/HomePage.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useCallback } from 'react'\nimport { useDropzone } from 'react-dropzone'\nimport { \n  Mail, \n  Upload, \n  FileText, \n  Image, \n  AlertCircle,\n  Play,\n  Clock,\n  CheckCircle\n} from 'lucide-react'\nimport { ClaimData } from '@/types/claims'\nimport { processClaim } from '@/lib/claimProcessor'\n\ninterface HomePageProps {\n  onProcessClaim: (data: ClaimData) => void\n  isProcessing: boolean\n  setIsProcessing: (processing: boolean) => void\n}\n\ninterface UploadedFile {\n  id: string\n  name: string\n  type: string\n  size: number\n  preview?: string\n}\n\nexport default function HomePage({ onProcessClaim, isProcessing, setIsProcessing }: HomePageProps) {\n  const [emailText, setEmailText] = useState('')\n  const [uploadedFiles, setUploadedFiles] = useState<UploadedFile[]>([])\n  const [processingSteps, setProcessingSteps] = useState<string[]>([])\n  const [currentStep, setCurrentStep] = useState('')\n\n  const onDrop = useCallback((acceptedFiles: File[]) => {\n    const newFiles: UploadedFile[] = acceptedFiles.map((file, index) => ({\n      id: `file-${Date.now()}-${index}`,\n      name: file.name,\n      type: file.type,\n      size: file.size,\n      preview: file.type.startsWith('image/') ? URL.createObjectURL(file) : undefined\n    }))\n    setUploadedFiles(prev => [...prev, ...newFiles])\n  }, [])\n\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\n    onDrop,\n    accept: {\n      'application/pdf': ['.pdf'],\n      'image/*': ['.png', '.jpg', '.jpeg', '.gif'],\n      'text/plain': ['.txt']\n    },\n    maxFiles: 5\n  })\n\n  const removeFile = (fileId: string) => {\n    setUploadedFiles(prev => prev.filter(f => f.id !== fileId))\n  }\n\n  const handleProcessClaim = async () => {\n    if (!emailText.trim() || uploadedFiles.length === 0) return\n\n    setIsProcessing(true)\n    setProcessingSteps([])\n    setCurrentStep('')\n\n    try {\n      // Simulate processing steps\n      const steps = [\n        'Ingestion Agent: Normalizing email and attachments...',\n        'Document Classifier: Analyzing document types...',\n        'Extraction Agent: Extracting claim fields...',\n        'Policy RAG Agent: Querying policy database...',\n        'Assembler Agent: Building decision pack...'\n      ]\n\n      for (let i = 0; i < steps.length; i++) {\n        setCurrentStep(steps[i])\n        setProcessingSteps(prev => [...prev, steps[i]])\n        await new Promise(resolve => setTimeout(resolve, 800))\n      }\n\n      // Process the claim\n      const claimData = await processClaim(emailText, uploadedFiles)\n      onProcessClaim(claimData)\n    } catch (error) {\n      console.error('Error processing claim:', error)\n      setCurrentStep('Error processing claim')\n    } finally {\n      setIsProcessing(false)\n    }\n  }\n\n  const canProcess = emailText.trim().length > 0 && uploadedFiles.length > 0 && !isProcessing\n\n  return (\n    <div className=\"relative min-h-screen\">\n      {/* Grid Background */}\n      <div \n        className=\"absolute inset-0 pointer-events-none z-0\"\n        style={{\n          backgroundImage: `\n            linear-gradient(to right, rgba(37, 99, 235, 0.06) 1px, transparent 1px),\n            linear-gradient(to bottom, rgba(37, 99, 235, 0.06) 1px, transparent 1px)\n          `,\n          backgroundSize: '48px 48px',\n          backgroundPosition: '0 0',\n        }}\n      />\n      \n      {/* Subtle diagonal grid overlay for depth */}\n      <div \n        className=\"absolute inset-0 pointer-events-none z-0\"\n        style={{\n          backgroundImage: `\n            linear-gradient(45deg, rgba(124, 58, 237, 0.02) 25%, transparent 25%),\n            linear-gradient(-45deg, rgba(124, 58, 237, 0.02) 25%, transparent 25%),\n            linear-gradient(45deg, transparent 75%, rgba(124, 58, 237, 0.02) 75%),\n            linear-gradient(-45deg, transparent 75%, rgba(124, 58, 237, 0.02) 75%)\n          `,\n          backgroundSize: '96px 96px',\n          backgroundPosition: '0 0, 0 48px, 48px -48px, -48px 0px',\n        }}\n      />\n      \n      <div className=\"max-w-6xl mx-auto relative z-10\">\n        {/* Hero Section with Radial Gradient Glow */}\n        <div className=\"text-center mb-24 pt-12 relative\">\n        {/* Subtle glow effect behind hero */}\n        <div className=\"absolute inset-0 -top-20 -bottom-20 flex items-center justify-center pointer-events-none\">\n          <div className=\"w-full max-w-2xl h-64 bg-gradient-radial from-[#2563EB]/10 via-[#7C3AED]/5 to-transparent rounded-full blur-3xl\"></div>\n        </div>\n        \n        <div className=\"relative z-10\">\n          <span className=\"inline-block text-xs font-semibold text-[#6366F1] uppercase tracking-widest mb-6\">\n            AI-Powered Claims Processing\n          </span>\n          <h1 className=\"text-6xl font-bold text-[#0F172A] mb-6 tracking-tight leading-tight\">\n            Process Claims\n            <br />\n            <span className=\"bg-gradient-to-r from-[#2563EB] to-[#7C3AED] bg-clip-text text-transparent\">\n              Automatically\n            </span>\n          </h1>\n          <p className=\"text-xl text-[#475569] max-w-2xl mx-auto mb-3 font-medium leading-relaxed\">\n            Upload FNOL email and attachments for intelligent extraction and processing\n          </p>\n          <p className=\"text-base text-[#64748B] max-w-xl mx-auto\">\n            Our AI orchestrates document classification, field extraction, and policy matching\n          </p>\n        </div>\n      </div>\n\n      {/* Form Area - Two Elevated Glass Cards */}\n      <div className=\"grid lg:grid-cols-2 gap-8 mb-16 relative z-10\">\n        {/* Email Input Card with Glassmorphism */}\n        <div className=\"card-glass p-10 h-full flex flex-col relative overflow-hidden\">\n          {/* Subtle gradient overlay */}\n          <div className=\"absolute inset-0 bg-gradient-to-br from-[#2563EB]/5 via-transparent to-[#7C3AED]/5 pointer-events-none\"></div>\n          \n          <div className=\"relative z-10 flex flex-col h-full\">\n            <div className=\"flex items-center space-x-2 mb-4\">\n              <div className=\"p-2 bg-gradient-to-br from-[#2563EB]/10 to-[#7C3AED]/10 rounded-lg\">\n                <Mail className=\"w-5 h-5 text-[#6366F1]\" />\n              </div>\n              <h2 className=\"text-sm font-semibold text-[#475569] uppercase tracking-wider\">FNOL Email</h2>\n            </div>\n            \n            <textarea\n              value={emailText}\n              onChange={(e) => setEmailText(e.target.value)}\n              placeholder=\"Paste FNOL email content here...\"\n              className=\"w-full flex-1 p-5 border border-[#E2E8F0] rounded-xl resize-none focus:outline-none focus:ring-2 focus:ring-[#6366F1]/20 focus:border-[#6366F1]/30 bg-white/50 backdrop-blur-sm text-[#0F172A] placeholder:text-[#94A3B8] text-sm leading-relaxed transition-all duration-200\"\n              style={{ minHeight: '340px' }}\n            />\n            \n            <div className=\"mt-4 text-xs text-[#94A3B8] font-medium\">\n              {emailText.length} characters\n            </div>\n          </div>\n        </div>\n\n        {/* File Upload Card with Glassmorphism */}\n        <div className=\"card-glass p-10 h-full flex flex-col relative overflow-hidden\">\n          {/* Subtle gradient overlay */}\n          <div className=\"absolute inset-0 bg-gradient-to-br from-[#7C3AED]/5 via-transparent to-[#2563EB]/5 pointer-events-none\"></div>\n          \n          <div className=\"relative z-10 flex flex-col h-full\">\n            <div className=\"flex items-center space-x-2 mb-4\">\n              <div className=\"p-2 bg-gradient-to-br from-[#7C3AED]/10 to-[#2563EB]/10 rounded-lg\">\n                <Upload className=\"w-5 h-5 text-[#6366F1]\" />\n              </div>\n              <h2 className=\"text-sm font-semibold text-[#475569] uppercase tracking-wider\">Attachments</h2>\n            </div>\n            \n            <div\n              {...getRootProps()}\n              className={`\n                flex-1 border-2 border-dashed rounded-xl p-12 text-center cursor-pointer transition-all duration-300 relative overflow-hidden\n                ${isDragActive \n                  ? 'border-[#6366F1] bg-gradient-to-br from-[#EEF2FF] to-[#F3E8FF] shadow-lg scale-[1.02]' \n                  : 'border-[#CBD5E1] hover:border-[#6366F1]/50 hover:bg-gradient-to-br hover:from-[#FAFBFC] hover:to-[#F8FAFC] bg-white/30 backdrop-blur-sm'\n                }\n              `}\n              style={{ minHeight: '340px', display: 'flex', flexDirection: 'column', justifyContent: 'center', alignItems: 'center' }}\n            >\n              <input {...getInputProps()} />\n              <div className={`p-4 rounded-full mb-4 transition-all duration-300 ${\n                isDragActive ? 'bg-[#6366F1]/10' : 'bg-[#F1F5F9]'\n              }`}>\n                <Upload className={`w-12 h-12 transition-colors duration-300 ${\n                  isDragActive ? 'text-[#6366F1]' : 'text-[#94A3B8]'\n                }`} />\n              </div>\n              {isDragActive ? (\n                <p className=\"text-base font-semibold text-[#6366F1]\">Drop files here</p>\n              ) : (\n                <div>\n                  <p className=\"text-sm font-semibold text-[#334155] mb-2\">Drag files here or click to select</p>\n                  <p className=\"text-xs text-[#94A3B8]\">PDF, images, text files (max 5)</p>\n                </div>\n              )}\n            </div>\n\n            {/* Uploaded Files */}\n            {uploadedFiles.length > 0 && (\n              <div className=\"mt-6 space-y-2 relative z-10\">\n                {uploadedFiles.map((file) => (\n                  <div key={file.id} className=\"flex items-center justify-between p-4 bg-white/60 backdrop-blur-sm rounded-xl border border-[#E2E8F0] hover:border-[#CBD5E1] hover:shadow-md transition-all duration-200\">\n                    <div className=\"flex items-center space-x-3 min-w-0 flex-1\">\n                      {file.type.startsWith('image/') ? (\n                        <div className=\"p-2 bg-[#EEF2FF] rounded-lg\">\n                          <Image className=\"w-4 h-4 text-[#6366F1] flex-shrink-0\" />\n                        </div>\n                      ) : (\n                        <div className=\"p-2 bg-[#F3E8FF] rounded-lg\">\n                          <FileText className=\"w-4 h-4 text-[#7C3AED] flex-shrink-0\" />\n                        </div>\n                      )}\n                      <div className=\"min-w-0 flex-1\">\n                        <p className=\"text-sm font-semibold text-[#0F172A] truncate\">{file.name}</p>\n                        <p className=\"text-xs text-[#94A3B8] font-medium\">{(file.size / 1024).toFixed(1)} KB</p>\n                      </div>\n                    </div>\n                    <button\n                      onClick={() => removeFile(file.id)}\n                      className=\"text-[#94A3B8] hover:text-[#64748B] p-2 hover:bg-[#F1F5F9] rounded-lg transition-all duration-200 flex-shrink-0\"\n                    >\n                      <AlertCircle className=\"w-4 h-4\" />\n                    </button>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Primary Action Button - Blue to Violet Gradient */}\n      <div className=\"text-center mb-16 relative z-10\">\n        <button\n          onClick={handleProcessClaim}\n          disabled={!canProcess}\n          className=\"btn-primary disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105 active:scale-100 transition-transform duration-200\"\n        >\n          {isProcessing ? (\n            <div className=\"flex items-center space-x-3\">\n              <Clock className=\"w-5 h-5 animate-spin\" />\n              <span>Processing...</span>\n            </div>\n          ) : (\n            <div className=\"flex items-center space-x-3\">\n              <Play className=\"w-5 h-5\" />\n              <span>Process Claim</span>\n            </div>\n          )}\n        </button>\n      </div>\n\n      {/* Processing Steps */}\n      {isProcessing && (\n        <div className=\"card-glass p-8 relative overflow-hidden z-10\">\n          <div className=\"absolute inset-0 bg-gradient-to-br from-[#EEF2FF]/50 via-transparent to-[#F3E8FF]/50 pointer-events-none\"></div>\n          \n          <div className=\"relative z-10\">\n            <h3 className=\"text-sm font-semibold text-[#475569] uppercase tracking-wider mb-6\">\n              Processing Steps\n            </h3>\n            <div className=\"space-y-3\">\n              {processingSteps.map((step, index) => (\n                <div \n                  key={index} \n                  className=\"flex items-center space-x-4 p-4 bg-white/60 backdrop-blur-sm rounded-xl border border-[#E2E8F0]\"\n                >\n                  <div className=\"p-1.5 bg-gradient-to-br from-[#10B981] to-[#059669] rounded-full\">\n                    <CheckCircle className=\"w-4 h-4 text-white flex-shrink-0\" />\n                  </div>\n                  <span className=\"text-sm text-[#334155] font-medium\">{step}</span>\n                </div>\n              ))}\n              \n              {currentStep && !processingSteps.includes(currentStep) && (\n                <div className=\"flex items-center space-x-4 p-4 bg-gradient-to-r from-[#EEF2FF] to-[#F3E8FF] rounded-xl border border-[#C7D2FE]\">\n                  <div className=\"p-1.5 bg-gradient-to-br from-[#6366F1] to-[#7C3AED] rounded-full\">\n                    <Clock className=\"w-4 h-4 text-white animate-spin flex-shrink-0\" />\n                  </div>\n                  <span className=\"text-sm text-[#4338CA] font-semibold\">{currentStep}</span>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n      </div>\n    </div>\n  )\n} "],"names":[],"mappings":"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"}},
    {"offset": {"line": 3731, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/components/ReviewPage.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useMemo } from 'react'\nimport { motion } from 'framer-motion'\nimport { \n  FileText, \n  Search, \n  BookOpen, \n  CheckCircle,\n  AlertTriangle,\n  ArrowRight,\n  ArrowLeft,\n  Shield,\n  User,\n  Calendar,\n  MapPin,\n  FileCheck,\n  Clock,\n  TrendingUp\n} from 'lucide-react'\nimport { ClaimData, FieldEvidence, PolicyHit } from '@/types/claims'\n\ninterface ReviewPageProps {\n  claimData: ClaimData\n  onNextStage: () => void\n  onPreviousStage: () => void\n}\n\n// Group fields by category\nconst categorizeFields = (evidence: FieldEvidence[]) => {\n  const categories = {\n    'Claim Metadata': ['policyId', 'policyNumber', 'claimId'],\n    'Contact Details': ['claimantName', 'contactEmail', 'contactPhone'],\n    'Incident Details': ['lossDate', 'lossType', 'lossLocation', 'location', 'description', 'deductible', 'estimatedAmount']\n  }\n\n  const grouped: Record<string, FieldEvidence[]> = {\n    'Claim Metadata': [],\n    'Contact Details': [],\n    'Incident Details': []\n  }\n\n  evidence.forEach((field) => {\n    const fieldName = (field.fieldName || field.field || '').toLowerCase()\n    let categorized = false\n\n    for (const [category, fields] of Object.entries(categories)) {\n      if (fields.some(f => fieldName.includes(f.toLowerCase()))) {\n        grouped[category].push(field)\n        categorized = true\n        break\n      }\n    }\n\n    if (!categorized) {\n      grouped['Incident Details'].push(field)\n    }\n  })\n\n  return grouped\n}\n\nexport default function ReviewPage({ claimData, onNextStage, onPreviousStage }: ReviewPageProps) {\n  const [selectedField, setSelectedField] = useState<string | null>(null)\n  const [selectedDoc, setSelectedDoc] = useState<string | null>(null)\n\n  // Handle null claimData\n  if (!claimData || !claimData.decisionPack) {\n    return (\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        className=\"max-w-7xl mx-auto text-center py-12\"\n      >\n        <AlertTriangle className=\"w-16 h-16 text-warning-500 mx-auto mb-4\" />\n        <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">No Claim Data Available</h2>\n        <p className=\"text-gray-600 mb-6\">\n          Please process a claim first before reviewing.\n        </p>\n        <button\n          onClick={onPreviousStage}\n          className=\"btn-primary flex items-center space-x-2 mx-auto\"\n        >\n          <ArrowLeft className=\"w-4 h-4\" />\n          <span>Back to Ingest</span>\n        </button>\n      </motion.div>\n    )\n  }\n\n  const { decisionPack, claimId, status } = claimData\n  const { \n    evidence = [], \n    documents = [], \n    policyGrounding = [],\n    claimDraft\n  } = decisionPack || {}\n\n  // Calculate overall confidence\n  const overallConfidence = useMemo(() => {\n    if (evidence.length === 0) return 0\n    const avg = evidence.reduce((sum, e) => sum + e.confidence, 0) / evidence.length\n    return Math.round(avg * 100)\n  }, [evidence])\n\n  // Group fields by category\n  const groupedFields = useMemo(() => categorizeFields(evidence), [evidence])\n\n  // Policy grounding state\n  const policyState = useMemo(() => {\n    if (policyGrounding.length === 0) {\n      return { type: 'warning', message: 'No policy clauses found', subMessage: 'Proceeding without policy grounding' }\n    }\n    const avgScore = policyGrounding.reduce((sum, p) => sum + (p.score || p.similarity || 0), 0) / policyGrounding.length\n    if (avgScore >= 0.7) {\n      return { type: 'success', message: `${policyGrounding.length} policy matches found`, subMessage: `${Math.round(avgScore * 100)}% average similarity` }\n    }\n    return { type: 'neutral', message: `${policyGrounding.length} policy matches`, subMessage: 'Review recommended' }\n  }, [policyGrounding])\n\n  const getConfidenceBadge = (confidence: number) => {\n    if (confidence >= 0.8) {\n      return <span className=\"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-[#ECFDF5] text-[#047857] border border-[#A7F3D0]\">High</span>\n    } else if (confidence >= 0.6) {\n      return <span className=\"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-[#EFF6FF] text-[#1E40AF] border border-[#DBEAFE]\">Medium</span>\n    } else {\n      return <span className=\"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-[#FFFBEB] text-[#B45309] border border-[#FDE68A]\">Review</span>\n    }\n  }\n\n  const getFieldIcon = (fieldName: string) => {\n    const iconMap: Record<string, any> = {\n      policyId: Shield,\n      policyNumber: Shield,\n      claimantName: User,\n      contactEmail: FileText,\n      contactPhone: FileText,\n      lossDate: Calendar,\n      lossType: FileCheck,\n      lossLocation: MapPin,\n      location: MapPin,\n      description: FileText,\n      deductible: TrendingUp\n    }\n    \n    const field = (fieldName || '').toLowerCase()\n    for (const [key, Icon] of Object.entries(iconMap)) {\n      if (field.includes(key.toLowerCase())) {\n        return Icon\n      }\n    }\n    return FileText\n  }\n\n  const getStatusColor = (status?: string) => {\n    if (!status) return 'bg-[#E5E7EB] text-[#374151]'\n    const s = status.toLowerCase()\n    if (s.includes('complete') || s.includes('approved')) return 'bg-[#ECFDF5] text-[#047857]'\n    if (s.includes('pending') || s.includes('processing')) return 'bg-[#EFF6FF] text-[#1E40AF]'\n    if (s.includes('reject') || s.includes('error')) return 'bg-[#FEF2F2] text-[#B91C1C]'\n    return 'bg-[#FFFBEB] text-[#B45309]'\n  }\n\n  return (\n    <div className=\"max-w-[1920px] mx-auto\">\n      {/* Sticky Claim Summary Header */}\n      <div className=\"sticky top-0 z-50 bg-white/95 backdrop-blur-sm border-b border-[#E5E7EB] shadow-sm\">\n        <div className=\"px-8 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-6\">\n              <div>\n                <div className=\"text-xs font-semibold text-[#6B7280] uppercase tracking-wider mb-1\">Claim ID</div>\n                <div className=\"text-lg font-bold text-[#111827]\">\n                  {claimId || claimDraft?.id || 'N/A'}\n                </div>\n              </div>\n              <div className=\"h-12 w-px bg-[#E5E7EB]\"></div>\n              <div>\n                <div className=\"text-xs font-semibold text-[#6B7280] uppercase tracking-wider mb-1\">Overall Confidence</div>\n                <div className=\"flex items-center space-x-2\">\n                  <div className=\"text-lg font-bold text-[#111827]\">{overallConfidence}%</div>\n                  <div className={`w-2 h-2 rounded-full ${\n                    overallConfidence >= 80 ? 'bg-[#10B981]' : overallConfidence >= 60 ? 'bg-[#3B82F6]' : 'bg-[#F59E0B]'\n                  }`}></div>\n                </div>\n              </div>\n              <div className=\"h-12 w-px bg-[#E5E7EB]\"></div>\n              <div>\n                <div className=\"text-xs font-semibold text-[#6B7280] uppercase tracking-wider mb-1\">Status</div>\n                <div className={`inline-flex items-center px-3 py-1 rounded-md text-sm font-medium ${getStatusColor(status)}`}>\n                  {status || 'Processing'}\n                </div>\n              </div>\n            </div>\n            <div className=\"flex items-center space-x-3\">\n              <button\n                onClick={onPreviousStage}\n                className=\"btn-secondary flex items-center space-x-2\"\n              >\n                <ArrowLeft className=\"w-4 h-4\" />\n                <span>Back</span>\n              </button>\n              <button\n                onClick={onNextStage}\n                className=\"btn-primary flex items-center space-x-2\"\n              >\n                <span>Continue</span>\n                <ArrowRight className=\"w-4 h-4\" />\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Main Content - Three Column Layout */}\n      <div className=\"px-8 py-8\">\n        <div className=\"grid grid-cols-12 gap-6\">\n          {/* Left Column - Source Documents (Compact) */}\n          <div className=\"col-span-12 lg:col-span-3\">\n            <motion.div \n              className=\"card p-5 h-fit sticky top-[88px]\"\n              initial={{ opacity: 0, x: -20 }}\n              animate={{ opacity: 1, x: 0 }}\n            >\n              <div className=\"flex items-center space-x-2 mb-4\">\n                <FileText className=\"w-4 h-4 text-[#6366F1]\" />\n                <h2 className=\"text-sm font-bold text-[#111827] uppercase tracking-wider\">Source Documents</h2>\n                <span className=\"ml-auto text-xs font-medium text-[#6B7280] bg-[#F3F4F6] px-2 py-0.5 rounded\">\n                  {documents.length}\n                </span>\n              </div>\n              \n              <div className=\"space-y-2\">\n                {documents.map((doc) => {\n                  const isSelected = selectedDoc === doc.id\n                  return (\n                    <div \n                      key={doc.id} \n                      className={`p-3 rounded-lg border cursor-pointer transition-all ${\n                        isSelected\n                          ? 'border-[#6366F1] bg-[#EEF2FF] shadow-sm'\n                          : 'border-[#E5E7EB] hover:border-[#CBD5E1] hover:bg-[#F9FAFB] bg-white'\n                      }`}\n                      onClick={() => setSelectedDoc(isSelected ? null : doc.id)}\n                    >\n                      <div className=\"flex items-start justify-between mb-2\">\n                        <div className=\"flex items-center space-x-2 flex-1 min-w-0\">\n                          <FileText className=\"w-4 h-4 text-[#6B7280] flex-shrink-0\" />\n                          <span className=\"text-xs font-semibold text-[#111827] truncate\">{doc.name}</span>\n                        </div>\n                        <span className=\"text-xs font-medium text-[#6B7280] bg-[#F3F4F6] px-1.5 py-0.5 rounded ml-2 flex-shrink-0\">\n                          {doc.type}\n                        </span>\n                      </div>\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center space-x-1\">\n                          <div className={`w-1.5 h-1.5 rounded-full ${\n                            doc.confidence >= 0.8 ? 'bg-[#10B981]' : doc.confidence >= 0.6 ? 'bg-[#3B82F6]' : 'bg-[#F59E0B]'\n                          }`}></div>\n                          <span className=\"text-xs text-[#6B7280]\">\n                            {Math.round(doc.confidence * 100)}%\n                          </span>\n                        </div>\n                      </div>\n                    </div>\n                  )\n                })}\n              </div>\n            </motion.div>\n          </div>\n\n          {/* Center Column - Extracted Fields (Dominant) */}\n          <div className=\"col-span-12 lg:col-span-6\">\n            <motion.div \n              className=\"card p-6\"\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n            >\n              <div className=\"flex items-center space-x-2 mb-6\">\n                <Search className=\"w-5 h-5 text-[#6366F1]\" />\n                <h2 className=\"text-base font-bold text-[#111827] uppercase tracking-wider\">Extracted Fields</h2>\n                <span className=\"ml-auto text-xs font-medium text-[#6B7280] bg-[#F3F4F6] px-2 py-0.5 rounded\">\n                  {evidence.length} fields\n                </span>\n              </div>\n\n              {/* Grouped Fields by Category */}\n              <div className=\"space-y-6\">\n                {Object.entries(groupedFields).map(([category, fields]) => {\n                  if (fields.length === 0) return null\n                  \n                  return (\n                    <div key={category} className=\"border-b border-[#E5E7EB] pb-6 last:border-0 last:pb-0\">\n                      <h3 className=\"text-xs font-semibold text-[#6B7280] uppercase tracking-wider mb-4\">\n                        {category}\n                      </h3>\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n                        {fields.map((field) => {\n                          const fieldName = field.fieldName || field.field || ''\n                          const Icon = getFieldIcon(fieldName)\n                          const isSelected = selectedField === fieldName\n                          \n                          return (\n                            <div\n                              key={fieldName}\n                              className={`p-4 rounded-lg border transition-all cursor-pointer ${\n                                isSelected\n                                  ? 'border-[#6366F1] bg-[#EEF2FF] shadow-sm'\n                                  : 'border-[#E5E7EB] hover:border-[#CBD5E1] hover:bg-[#F9FAFB] bg-white'\n                              }`}\n                              onClick={() => setSelectedField(isSelected ? null : fieldName)}\n                            >\n                              <div className=\"flex items-start justify-between mb-2\">\n                                <div className=\"flex items-center space-x-2 flex-1 min-w-0\">\n                                  <Icon className=\"w-4 h-4 text-[#6B7280] flex-shrink-0\" />\n                                  <span className=\"text-sm font-medium text-[#111827] capitalize truncate\">\n                                    {fieldName.replace(/([A-Z])/g, ' $1').trim()}\n                                  </span>\n                                </div>\n                                {getConfidenceBadge(field.confidence)}\n                              </div>\n                              \n                              <div className=\"text-sm text-[#374151] font-medium mb-1 truncate\" title={String(field.value)}>\n                                {String(field.value)}\n                              </div>\n                              \n                              {isSelected && (\n                                <motion.div\n                                  initial={{ opacity: 0, height: 0 }}\n                                  animate={{ opacity: 1, height: 'auto' }}\n                                  className=\"mt-3 pt-3 border-t border-[#E5E7EB]\"\n                                >\n                                  <div className=\"text-xs text-[#6B7280] space-y-1\">\n                                    <div>\n                                      <span className=\"font-medium\">Source:</span>{' '}\n                                      {typeof field.sourceLocator === 'string' \n                                        ? field.sourceLocator \n                                        : field.sourceLocator.docId}\n                                    </div>\n                                    <div>\n                                      <span className=\"font-medium\">Rationale:</span> {field.rationale}\n                                    </div>\n                                  </div>\n                                </motion.div>\n                              )}\n                            </div>\n                          )\n                        })}\n                      </div>\n                    </div>\n                  )\n                })}\n              </div>\n            </motion.div>\n          </div>\n\n          {/* Right Column - Policy Grounding (Narrow) */}\n          <div className=\"col-span-12 lg:col-span-3\">\n            <motion.div \n              className=\"card p-5 h-fit sticky top-[88px]\"\n              initial={{ opacity: 0, x: 20 }}\n              animate={{ opacity: 1, x: 0 }}\n            >\n              <div className=\"flex items-center space-x-2 mb-4\">\n                <BookOpen className=\"w-4 h-4 text-[#6366F1]\" />\n                <h2 className=\"text-sm font-bold text-[#111827] uppercase tracking-wider\">Policy Grounding</h2>\n              </div>\n\n              {/* State-based Policy Card */}\n              <div className={`p-4 rounded-lg border-2 ${\n                policyState.type === 'success' \n                  ? 'border-[#10B981] bg-[#ECFDF5]' \n                  : policyState.type === 'warning'\n                  ? 'border-[#F59E0B] bg-[#FFFBEB]'\n                  : 'border-[#E5E7EB] bg-[#F9FAFB]'\n              }`}>\n                <div className=\"flex items-start space-x-3\">\n                  {policyState.type === 'success' ? (\n                    <CheckCircle className=\"w-5 h-5 text-[#10B981] flex-shrink-0 mt-0.5\" />\n                  ) : policyState.type === 'warning' ? (\n                    <AlertTriangle className=\"w-5 h-5 text-[#F59E0B] flex-shrink-0 mt-0.5\" />\n                  ) : (\n                    <Shield className=\"w-5 h-5 text-[#6B7280] flex-shrink-0 mt-0.5\" />\n                  )}\n                  <div className=\"flex-1 min-w-0\">\n                    <div className={`text-sm font-semibold mb-1 ${\n                      policyState.type === 'success' \n                        ? 'text-[#047857]' \n                        : policyState.type === 'warning'\n                        ? 'text-[#B45309]'\n                        : 'text-[#374151]'\n                    }`}>\n                      {policyState.message}\n                    </div>\n                    <div className={`text-xs ${\n                      policyState.type === 'success' \n                        ? 'text-[#065F46]' \n                        : policyState.type === 'warning'\n                        ? 'text-[#92400E]'\n                        : 'text-[#6B7280]'\n                    }`}>\n                      {policyState.subMessage}\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Policy Matches List (if any) */}\n              {policyGrounding.length > 0 && (\n                <div className=\"mt-4 space-y-2\">\n                  <div className=\"text-xs font-semibold text-[#6B7280] uppercase tracking-wider mb-2\">\n                    Matches ({policyGrounding.length})\n                  </div>\n                  {policyGrounding.slice(0, 3).map((policy) => (\n                    <div \n                      key={policy.clauseId}\n                      className=\"p-3 rounded-lg border border-[#E5E7EB] bg-white hover:border-[#CBD5E1] hover:bg-[#F9FAFB] transition-all\"\n                    >\n                      <div className=\"flex items-center justify-between mb-1\">\n                        <span className=\"text-xs font-semibold text-[#111827] truncate\">{policy.clauseId}</span>\n                        <span className=\"text-xs font-medium text-[#10B981] bg-[#ECFDF5] px-1.5 py-0.5 rounded flex-shrink-0 ml-2\">\n                          {Math.round((policy.score || policy.similarity || 0) * 100)}%\n                        </span>\n                      </div>\n                      <div className=\"text-xs text-[#374151] font-medium mb-1 line-clamp-1\">\n                        {policy.title}\n                      </div>\n                      <div className=\"text-xs text-[#6B7280] line-clamp-2\">\n                        {policy.snippet}\n                      </div>\n                    </div>\n                  ))}\n                  {policyGrounding.length > 3 && (\n                    <div className=\"text-xs text-[#6366F1] font-medium text-center pt-2\">\n                      +{policyGrounding.length - 3} more matches\n                    </div>\n                  )}\n                </div>\n              )}\n            </motion.div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4749, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/components/DecisionPage.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { motion } from 'framer-motion'\nimport { \n  CheckCircle, \n  FileText, \n  Send, \n  Download, \n  Clock,\n  ArrowRight,\n  ArrowLeft,\n  AlertTriangle,\n  Check,\n  X\n} from 'lucide-react'\nimport { ClaimData } from '@/types/claims'\n\ninterface DecisionPageProps {\n  claimData: ClaimData\n  onNextStage: () => void\n  onPreviousStage: () => void\n}\n\nexport default function DecisionPage({ claimData, onNextStage, onPreviousStage }: DecisionPageProps) {\n  const [isCreatingDraft, setIsCreatingDraft] = useState(false)\n  const [isSendingAck, setIsSendingAck] = useState(false)\n  const [draftCreated, setDraftCreated] = useState(false)\n  const [ackSent, setAckSent] = useState(false)\n  const [showAcknowledgment, setShowAcknowledgment] = useState(false)\n\n  // Handle null claimData\n  if (!claimData || !claimData.decisionPack) {\n    return (\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        className=\"max-w-7xl mx-auto text-center py-12\"\n      >\n        <AlertTriangle className=\"w-16 h-16 text-warning-500 mx-auto mb-4\" />\n        <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">No Claim Data Available</h2>\n        <p className=\"text-gray-600 mb-6\">\n          Please process a claim first before making decisions.\n        </p>\n        <button\n          onClick={onPreviousStage}\n          className=\"btn-primary flex items-center space-x-2 mx-auto\"\n        >\n          <ArrowLeft className=\"w-4 h-4\" />\n          <span>Back to Review</span>\n        </button>\n      </motion.div>\n    )\n  }\n\n  const { decisionPack, processingTime } = claimData\n  const { \n    claimDraft, \n    evidence = [], \n    documents = [], \n    policyGrounding = [], \n    audit = [] \n  } = decisionPack || {}\n\n  const handleCreateDraft = async () => {\n    setIsCreatingDraft(true)\n    \n    // Simulate API call\n    await new Promise(resolve => setTimeout(resolve, 2000))\n    \n    setDraftCreated(true)\n    setIsCreatingDraft(false)\n  }\n\n  const handleSendAcknowledgment = async () => {\n    setIsSendingAck(true)\n    \n    // Simulate API call\n    await new Promise(resolve => setTimeout(resolve, 1500))\n    \n    setAckSent(true)\n    setIsSendingAck(false)\n    setShowAcknowledgment(true)\n  }\n\n  const generateAcknowledgment = () => {\n    const { claimantName, lossDate, lossType, policyId } = claimDraft || {}\n    const policyInfo = policyGrounding.length > 0 \n      ? `Based on your policy coverage, this appears to be a covered loss.` \n      : `We're reviewing your policy to determine coverage.`\n    \n    return `Dear ${claimantName},\n\nThank you for reporting your claim. We have received your First Notice of Loss for the incident that occurred on ${lossDate}.\n\n${policyInfo}\n\nYour claim has been assigned claim number: CLM-${Date.now().toString().slice(-8)}\n\nWhat happens next:\n1. Our team will review the submitted documents and information\n2. We'll contact you within 24 hours to discuss next steps\n3. If you have any questions, please call our claims hotline\n\nWe appreciate your patience and will work to resolve your claim as quickly as possible.\n\nBest regards,\nClaims Team`\n  }\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      className=\"max-w-6xl mx-auto\"\n    >\n      {/* Header */}\n      <div className=\"text-center mb-12\">\n        <h1 className=\"text-4xl font-bold bg-gradient-to-r from-[#2D3748] via-[#4A5568] to-[#2D3748] bg-clip-text text-transparent mb-4\">\n          Decision & Actions\n        </h1>\n        <p className=\"text-lg text-[#718096] max-w-2xl mx-auto\">\n          Review the assembled claim draft and take action\n        </p>\n      </div>\n\n      <div className=\"grid lg:grid-cols-2 gap-8\">\n        {/* Decision Pack */}\n        <motion.div \n          className=\"card p-6\"\n          initial={{ opacity: 0, x: -20 }}\n          animate={{ opacity: 1, x: 0 }}\n          transition={{ delay: 0.1 }}\n        >\n          <div className=\"flex items-center space-x-3 mb-6\">\n            <div className=\"p-2 bg-gradient-to-br from-sky-100 to-sky-200 rounded-lg\">\n              <CheckCircle className=\"w-5 h-5 text-sky-600\" />\n            </div>\n            <h2 className=\"text-xl font-bold text-[#2D3748]\">Decision Pack</h2>\n          </div>\n          \n          <div className=\"space-y-4\">\n            {/* Claim Summary */}\n            <div className=\"p-5 bg-gradient-to-br from-sky-50 to-sky-100 rounded-xl border-l-4 border-sky-400 shadow-sm\">\n              <h3 className=\"font-semibold text-[#0369A1] mb-3\">Claim Summary</h3>\n              <div className=\"grid grid-cols-2 gap-2 text-sm\">\n                <div><span className=\"font-medium\">Policy:</span> {claimDraft.policyId}</div>\n                <div><span className=\"font-medium\">Claimant:</span> {claimDraft.claimantName}</div>\n                <div><span className=\"font-medium\">Loss Date:</span> {claimDraft.lossDate}</div>\n                <div><span className=\"font-medium\">Type:</span> {claimDraft.lossType}</div>\n                <div><span className=\"font-medium\">Location:</span> {claimDraft.location}</div>\n                {claimDraft.deductible && (\n                  <div><span className=\"font-medium\">Deductible:</span> ${claimDraft.deductible}</div>\n                )}\n              </div>\n            </div>\n\n            {/* Evidence Summary */}\n            <div className=\"p-5 bg-gradient-to-br from-[#ECFDF5] to-[#D1FAE5] rounded-xl border-l-4 border-[#22C55E] shadow-sm\">\n              <h3 className=\"font-semibold text-[#047857] mb-3\">Evidence Summary</h3>\n              <div className=\"text-sm text-[#065F46]\">\n                <div className=\"mb-2\">\n                  <span className=\"font-medium\">Documents:</span> {documents.length} attached\n                </div>\n                <div className=\"mb-2\">\n                  <span className=\"font-medium\">Fields Extracted:</span> {evidence.length} total\n                </div>\n                <div>\n                  <span className=\"font-medium\">High Confidence:</span> {evidence.filter(e => e.confidence >= 0.8).length} fields\n                </div>\n              </div>\n            </div>\n\n            {/* Policy Grounding */}\n            {policyGrounding.length > 0 && (\n              <div className=\"p-5 bg-gradient-to-br from-sky-50 to-sky-100 rounded-xl border-l-4 border-sky-400 shadow-sm\">\n                <h3 className=\"font-semibold text-[#0369A1] mb-3\">Policy Grounding</h3>\n                <div className=\"text-sm text-[#075985]\">\n                  <div className=\"mb-2\">\n                    <span className=\"font-medium\">Clauses Found:</span> {policyGrounding.length}\n                  </div>\n                  <div>\n                    <span className=\"font-medium\">Coverage:</span> {claimDraft.coverageFound ? 'Confirmed' : 'Under Review'}\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Processing Metrics */}\n            <div className=\"p-5 bg-gradient-to-br from-cloud-50 to-cloud-100 rounded-xl border border-cloud-200 shadow-sm\">\n              <h3 className=\"font-semibold text-[#2D3748] mb-3\">Processing Metrics</h3>\n              <div className=\"text-sm text-[#4A5568]\">\n                <div className=\"mb-1\">\n                  <span className=\"font-medium\">Total Time:</span> {((processingTime || 2000) / 1000).toFixed(1)}s\n                </div>\n                <div className=\"mb-1\">\n                  <span className=\"font-medium\">Auto-population:</span> {(((claimData.autoPopulatedFields || 8) / (claimData.totalFields || 10)) * 100).toFixed(0)}%\n                </div>\n                <div>\n                  <span className=\"font-medium\">RAG Hit Rate:</span> {((claimData.ragHitRate || 1) * 100).toFixed(0)}%\n                </div>\n              </div>\n            </div>\n          </div>\n        </motion.div>\n\n        {/* Actions */}\n        <motion.div \n          className=\"card p-6\"\n          initial={{ opacity: 0, x: 20 }}\n          animate={{ opacity: 1, x: 0 }}\n          transition={{ delay: 0.2 }}\n        >\n          <div className=\"flex items-center space-x-3 mb-6\">\n            <div className=\"p-2 bg-gradient-to-br from-sky-100 to-sky-200 rounded-lg\">\n              <FileText className=\"w-5 h-5 text-sky-600\" />\n            </div>\n            <h2 className=\"text-xl font-bold text-[#2D3748]\">Actions</h2>\n          </div>\n          \n          <div className=\"space-y-4\">\n            {/* Create Draft in Core */}\n            <div className=\"p-5 border-2 border-cloud-200 rounded-xl bg-white hover:shadow-md transition-shadow\">\n              <h3 className=\"font-semibold text-[#2D3748] mb-2\">Create Draft in Core System</h3>\n              <p className=\"text-sm text-[#718096] mb-4\">\n                Send the assembled claim data to the core claims management system\n              </p>\n              \n              {!draftCreated ? (\n                <button\n                  onClick={handleCreateDraft}\n                  disabled={isCreatingDraft}\n                  className=\"btn-primary w-full disabled:opacity-50\"\n                >\n                  {isCreatingDraft ? (\n                    <div className=\"flex items-center justify-center space-x-2\">\n                      <Clock className=\"w-4 h-4 animate-spin\" />\n                      <span>Creating Draft...</span>\n                    </div>\n                  ) : (\n                    <span>Create Draft in Core</span>\n                  )}\n                </button>\n              ) : (\n                <div className=\"flex items-center space-x-2 text-success-600\">\n                  <Check className=\"w-5 h-5\" />\n                  <span className=\"font-medium\">Draft Created Successfully</span>\n                </div>\n              )}\n            </div>\n\n            {/* Send Acknowledgment */}\n            <div className=\"p-5 border-2 border-cloud-200 rounded-xl bg-white hover:shadow-md transition-shadow\">\n              <h3 className=\"font-semibold text-[#2D3748] mb-2\">Send Customer Acknowledgment</h3>\n              <p className=\"text-sm text-[#718096] mb-4\">\n                Generate and send a personalized acknowledgment email to the claimant\n              </p>\n              \n              {!ackSent ? (\n                <button\n                  onClick={handleSendAcknowledgment}\n                  disabled={isSendingAck || !draftCreated}\n                  className=\"btn-secondary w-full disabled:opacity-50\"\n                >\n                  {isSendingAck ? (\n                    <div className=\"flex items-center justify-center space-x-2\">\n                      <Clock className=\"w-4 h-4 animate-spin\" />\n                      <span>Sending...</span>\n                    </div>\n                  ) : (\n                    <span>Send Acknowledgment</span>\n                  )}\n                </button>\n              ) : (\n                <div className=\"flex items-center space-x-2 text-success-600\">\n                  <Check className=\"w-5 h-5\" />\n                  <span className=\"font-medium\">Acknowledgment Sent</span>\n                </div>\n              )}\n            </div>\n\n            {/* Download Decision Pack */}\n            <div className=\"p-5 border-2 border-cloud-200 rounded-xl bg-white hover:shadow-md transition-shadow\">\n              <h3 className=\"font-semibold text-[#2D3748] mb-2\">Download Decision Pack</h3>\n              <p className=\"text-sm text-[#718096] mb-4\">\n                Download a complete record of the decision pack for audit purposes\n              </p>\n              \n              <button className=\"btn-secondary w-full flex items-center justify-center space-x-2\">\n                <Download className=\"w-4 h-4\" />\n                <span>Download PDF</span>\n              </button>\n            </div>\n          </div>\n        </motion.div>\n      </div>\n\n      {/* Acknowledgment Preview */}\n      {showAcknowledgment && (\n        <motion.div \n          className=\"mt-8 card p-6\"\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n        >\n          <div className=\"flex items-center justify-between mb-4\">\n            <h3 className=\"text-lg font-semibold\">Customer Acknowledgment</h3>\n            <button\n              onClick={() => setShowAcknowledgment(false)}\n              className=\"text-gray-500 hover:text-gray-700\"\n            >\n              <X className=\"w-5 h-5\" />\n            </button>\n          </div>\n          \n          <div className=\"bg-gray-50 p-4 rounded-lg\">\n            <pre className=\"text-sm text-gray-800 whitespace-pre-wrap font-mono\">\n              {generateAcknowledgment()}\n            </pre>\n          </div>\n          \n          <div className=\"mt-4 text-sm text-gray-600\">\n            <p><span className=\"font-medium\">Note:</span> This acknowledgment is grounded in the extracted claim facts and policy clauses, ensuring accuracy and compliance.</p>\n          </div>\n        </motion.div>\n      )}\n\n      {/* Audit Timeline */}\n      <motion.div \n        className=\"mt-8 card p-6\"\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ delay: 0.3 }}\n      >\n        <h3 className=\"text-lg font-semibold mb-4\">Audit Timeline</h3>\n        <div className=\"space-y-3\">\n          {audit.map((event, index) => (\n            <div key={index} className=\"flex items-center space-x-3\">\n              <div className={`w-3 h-3 rounded-full ${\n                event.success ? 'bg-success-500' : 'bg-danger-500'\n              }`}></div>\n              <div className=\"flex-1\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"font-medium text-gray-900\">{event.step}</span>\n                  <span className=\"text-sm text-gray-500\">{event.duration}ms</span>\n                </div>\n                <div className=\"text-sm text-gray-600\">\n                  {new Date(event.timestamp).toLocaleTimeString()} - {event.modelVersion}\n                  {event.fallbackUsed && (\n                    <span className=\"text-warning-600 ml-2\">(Fallback used)</span>\n                  )}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      </motion.div>\n\n      {/* Navigation */}\n      <div className=\"flex justify-between mt-8\">\n        <button\n          onClick={onPreviousStage}\n          className=\"btn-secondary flex items-center space-x-2\"\n        >\n          <ArrowLeft className=\"w-4 h-4\" />\n          <span>Back to Review</span>\n        </button>\n        \n        <button\n          onClick={onNextStage}\n          className=\"btn-primary flex items-center space-x-2\"\n        >\n          <span>View Dashboard</span>\n          <ArrowRight className=\"w-4 h-4\" />\n        </button>\n      </div>\n    </motion.div>\n  )\n} "],"names":[],"mappings":"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"}},
    {"offset": {"line": 5897, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/components/DashboardPage.tsx"],"sourcesContent":["'use client'\n\nimport { \n  Clock, \n  CheckCircle, \n  AlertTriangle,\n  TrendingUp,\n  RefreshCw,\n  Download\n} from 'lucide-react'\nimport { ClaimData } from '@/types/claims'\nimport { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, BarChart, Bar, PieChart, Pie, Cell, Legend } from 'recharts'\n\ninterface DashboardPageProps {\n  claimData: ClaimData\n  onReset: () => void\n}\n\nexport default function DashboardPage({ claimData, onReset }: DashboardPageProps) {\n  // Handle null claimData\n  if (!claimData || !claimData.decisionPack) {\n    return (\n      <div className=\"max-w-7xl mx-auto text-center py-16\">\n        <AlertTriangle className=\"w-12 h-12 text-[#9CA3AF] mx-auto mb-4\" />\n        <h2 className=\"text-2xl font-semibold text-[#111827] mb-2\">No Claim Data Available</h2>\n        <p className=\"text-[#6B7280] mb-8\">\n          Please process a claim first to view the dashboard.\n        </p>\n        <button\n          onClick={onReset}\n          className=\"btn-primary inline-flex items-center space-x-2\"\n        >\n          <RefreshCw className=\"w-4 h-4\" />\n          <span>Process New Claim</span>\n        </button>\n      </div>\n    )\n  }\n\n  const { \n    decisionPack, \n    processingTime = 2000, \n    autoPopulatedFields = 8, \n    totalFields = 10, \n    ragHitRate = 1, \n    overrideRate = 0.1 \n  } = claimData\n  const { \n    evidence = [], \n    documents = [], \n    policyGrounding = [], \n    audit = [] \n  } = decisionPack || {}\n\n  // Simulate historical data for charts\n  const historicalData = [\n    { date: '12/10', handleTime: 45, autoPop: 78, override: 12 },\n    { date: '12/11', handleTime: 42, autoPop: 82, override: 8 },\n    { date: '12/12', handleTime: 38, autoPop: 85, override: 6 },\n    { date: '12/13', handleTime: 41, autoPop: 80, override: 10 },\n    { date: '12/14', handleTime: 35, autoPop: 88, override: 5 },\n    { date: '12/15', handleTime: processingTime / 1000, autoPop: (autoPopulatedFields / totalFields) * 100, override: overrideRate * 100 }\n  ]\n\n  const confidenceData = [\n    { name: 'High (80%)', value: evidence.filter(e => e.confidence >= 0.8).length, color: '#2563EB' },\n    { name: 'Medium (60-79%)', value: evidence.filter(e => e.confidence >= 0.6 && e.confidence < 0.8).length, color: '#93C5FD' },\n    { name: 'Low (<60%)', value: evidence.filter(e => e.confidence < 0.6).length, color: '#DBEAFE' }\n  ]\n\n  const documentTypeData = documents.map(doc => ({\n    name: doc.type,\n    value: 1,\n    color: '#2563EB'\n  }))\n\n  const averageHandleTime = historicalData.reduce((sum, item) => sum + item.handleTime, 0) / historicalData.length\n  const averageAutoPop = historicalData.reduce((sum, item) => sum + item.autoPop, 0) / historicalData.length\n  const averageOverride = historicalData.reduce((sum, item) => sum + item.override, 0) / historicalData.length\n\n  return (\n    <div className=\"max-w-7xl mx-auto\">\n      {/* Page Title */}\n      <div className=\"mb-16\">\n        <h1 className=\"text-3xl font-semibold text-[#111827] mb-2\">\n          Operations Dashboard\n        </h1>\n        <p className=\"text-sm text-[#6B7280]\">\n          Performance metrics and operational insights\n        </p>\n      </div>\n\n      {/* KPI Cards */}\n      <div className=\"grid md:grid-cols-4 gap-6 mb-16\">\n        <div className=\"card p-6 h-full\">\n          <div className=\"flex items-start justify-between mb-4\">\n            <Clock className=\"w-5 h-5 text-[#9CA3AF] flex-shrink-0 mt-1\" />\n          </div>\n          <p className=\"text-xs font-medium text-[#6B7280] uppercase tracking-wider mb-2\">\n            Avg Handle Time\n          </p>\n          <p className=\"text-3xl font-semibold text-[#111827] mb-3\">\n            {averageHandleTime.toFixed(1)}s\n          </p>\n          <p className=\"text-xs text-[#6B7280]\">\n             12% from last week\n          </p>\n        </div>\n\n        <div className=\"card p-6 h-full\">\n          <div className=\"flex items-start justify-between mb-4\">\n            <CheckCircle className=\"w-5 h-5 text-[#9CA3AF] flex-shrink-0 mt-1\" />\n          </div>\n          <p className=\"text-xs font-medium text-[#6B7280] uppercase tracking-wider mb-2\">\n            Auto-population\n          </p>\n          <p className=\"text-3xl font-semibold text-[#111827] mb-3\">\n            {averageAutoPop.toFixed(0)}%\n          </p>\n          <p className=\"text-xs text-[#6B7280]\">\n             8% from last week\n          </p>\n        </div>\n\n        <div className=\"card p-6 h-full\">\n          <div className=\"flex items-start justify-between mb-4\">\n            <AlertTriangle className=\"w-5 h-5 text-[#9CA3AF] flex-shrink-0 mt-1\" />\n          </div>\n          <p className=\"text-xs font-medium text-[#6B7280] uppercase tracking-wider mb-2\">\n            Override Rate\n          </p>\n          <p className=\"text-3xl font-semibold text-[#111827] mb-3\">\n            {averageOverride.toFixed(1)}%\n          </p>\n          <p className=\"text-xs text-[#6B7280]\">\n             3% from last week\n          </p>\n        </div>\n\n        <div className=\"card p-6 h-full\">\n          <div className=\"flex items-start justify-between mb-4\">\n            <TrendingUp className=\"w-5 h-5 text-[#9CA3AF] flex-shrink-0 mt-1\" />\n          </div>\n          <p className=\"text-xs font-medium text-[#6B7280] uppercase tracking-wider mb-2\">\n            RAG Hit Rate\n          </p>\n          <p className=\"text-3xl font-semibold text-[#111827] mb-3\">\n            {(ragHitRate * 100).toFixed(0)}%\n          </p>\n          <p className=\"text-xs text-[#6B7280]\">\n             15% from last week\n          </p>\n        </div>\n      </div>\n\n      {/* Charts */}\n      <div className=\"grid lg:grid-cols-2 gap-6 mb-16\">\n        {/* Handle Time Trend */}\n        <div className=\"card p-6\">\n          <h3 className=\"text-sm font-semibold text-[#111827] mb-6\">Handle Time Trend</h3>\n          <ResponsiveContainer width=\"100%\" height={280}>\n            <LineChart data={historicalData}>\n              <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#F3F4F6\" />\n              <XAxis \n                dataKey=\"date\" \n                stroke=\"#9CA3AF\"\n                tick={{ fill: '#6B7280', fontSize: 12 }}\n                axisLine={{ stroke: '#E5E7EB' }}\n              />\n              <YAxis \n                stroke=\"#9CA3AF\"\n                tick={{ fill: '#6B7280', fontSize: 12 }}\n                axisLine={{ stroke: '#E5E7EB' }}\n              />\n              <Tooltip \n                contentStyle={{ \n                  backgroundColor: '#FFFFFF', \n                  border: '1px solid #E5E7EB',\n                  borderRadius: '6px',\n                  fontSize: '12px'\n                }}\n              />\n              <Line \n                type=\"monotone\" \n                dataKey=\"handleTime\" \n                stroke=\"#2563EB\" \n                strokeWidth={2}\n                dot={{ fill: '#2563EB', r: 3 }}\n                activeDot={{ r: 5 }}\n              />\n            </LineChart>\n          </ResponsiveContainer>\n        </div>\n\n        {/* Auto-population vs Override */}\n        <div className=\"card p-6\">\n          <h3 className=\"text-sm font-semibold text-[#111827] mb-6\">Auto-population vs Override</h3>\n          <ResponsiveContainer width=\"100%\" height={280}>\n            <BarChart data={historicalData}>\n              <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#F3F4F6\" />\n              <XAxis \n                dataKey=\"date\" \n                stroke=\"#9CA3AF\"\n                tick={{ fill: '#6B7280', fontSize: 12 }}\n                axisLine={{ stroke: '#E5E7EB' }}\n              />\n              <YAxis \n                stroke=\"#9CA3AF\"\n                tick={{ fill: '#6B7280', fontSize: 12 }}\n                axisLine={{ stroke: '#E5E7EB' }}\n              />\n              <Tooltip \n                contentStyle={{ \n                  backgroundColor: '#FFFFFF', \n                  border: '1px solid #E5E7EB',\n                  borderRadius: '6px',\n                  fontSize: '12px'\n                }}\n              />\n              <Legend \n                wrapperStyle={{ fontSize: '12px', color: '#6B7280' }}\n                iconType=\"square\"\n              />\n              <Bar dataKey=\"autoPop\" fill=\"#2563EB\" name=\"Auto-population\" radius={[4, 4, 0, 0]} />\n              <Bar dataKey=\"override\" fill=\"#DBEAFE\" name=\"Override\" radius={[4, 4, 0, 0]} />\n            </BarChart>\n          </ResponsiveContainer>\n        </div>\n      </div>\n\n      {/* Detailed Metrics */}\n      <div className=\"grid lg:grid-cols-3 gap-6 mb-16\">\n        {/* Field Confidence Distribution */}\n        <div className=\"card p-6\">\n          <h3 className=\"text-sm font-semibold text-[#111827] mb-6\">Field Confidence Distribution</h3>\n          <ResponsiveContainer width=\"100%\" height={240}>\n            <PieChart>\n              <Pie\n                data={confidenceData}\n                cx=\"50%\"\n                cy=\"50%\"\n                labelLine={false}\n                label={({ name, percent }) => `${(percent * 100).toFixed(0)}%`}\n                outerRadius={70}\n                fill=\"#2563EB\"\n                dataKey=\"value\"\n              >\n                {confidenceData.map((entry, index) => (\n                  <Cell key={`cell-${index}`} fill={entry.color} />\n                ))}\n              </Pie>\n              <Tooltip \n                contentStyle={{ \n                  backgroundColor: '#FFFFFF', \n                  border: '1px solid #E5E7EB',\n                  borderRadius: '6px',\n                  fontSize: '12px'\n                }}\n              />\n              <Legend \n                wrapperStyle={{ fontSize: '12px', color: '#6B7280' }}\n                iconType=\"circle\"\n              />\n            </PieChart>\n          </ResponsiveContainer>\n        </div>\n\n        {/* Document Types */}\n        <div className=\"card p-6\">\n          <h3 className=\"text-sm font-semibold text-[#111827] mb-6\">Document Types Processed</h3>\n          <ResponsiveContainer width=\"100%\" height={240}>\n            <PieChart>\n              <Pie\n                data={documentTypeData}\n                cx=\"50%\"\n                cy=\"50%\"\n                labelLine={false}\n                label={({ name }) => name}\n                outerRadius={70}\n                fill=\"#2563EB\"\n                dataKey=\"value\"\n              >\n                {documentTypeData.map((entry, index) => (\n                  <Cell key={`cell-${index}`} fill={entry.color} />\n                ))}\n              </Pie>\n              <Tooltip \n                contentStyle={{ \n                  backgroundColor: '#FFFFFF', \n                  border: '1px solid #E5E7EB',\n                  borderRadius: '6px',\n                  fontSize: '12px'\n                }}\n              />\n            </PieChart>\n          </ResponsiveContainer>\n        </div>\n\n        {/* Current Claim Summary */}\n        <div className=\"card p-6\">\n          <h3 className=\"text-sm font-semibold text-[#111827] mb-6\">Current Claim Summary</h3>\n          <div className=\"space-y-4\">\n            <div className=\"flex justify-between items-center py-2 border-b border-[#F3F4F6]\">\n              <span className=\"text-sm text-[#6B7280]\">Processing Time</span>\n              <span className=\"text-sm font-semibold text-[#111827]\">{(processingTime / 1000).toFixed(1)}s</span>\n            </div>\n            <div className=\"flex justify-between items-center py-2 border-b border-[#F3F4F6]\">\n              <span className=\"text-sm text-[#6B7280]\">Fields Extracted</span>\n              <span className=\"text-sm font-semibold text-[#111827]\">{totalFields}</span>\n            </div>\n            <div className=\"flex justify-between items-center py-2 border-b border-[#F3F4F6]\">\n              <span className=\"text-sm text-[#6B7280]\">High Confidence</span>\n              <span className=\"text-sm font-semibold text-[#111827]\">{autoPopulatedFields}</span>\n            </div>\n            <div className=\"flex justify-between items-center py-2 border-b border-[#F3F4F6]\">\n              <span className=\"text-sm text-[#6B7280]\">Policy Matches</span>\n              <span className=\"text-sm font-semibold text-[#111827]\">{policyGrounding.length}</span>\n            </div>\n            <div className=\"flex justify-between items-center py-2\">\n              <span className=\"text-sm text-[#6B7280]\">Documents</span>\n              <span className=\"text-sm font-semibold text-[#111827]\">{documents.length}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Governance & Compliance */}\n      <div className=\"card p-8 mb-12\">\n        <h3 className=\"text-sm font-semibold text-[#111827] mb-8\">\n          Governance & Compliance\n        </h3>\n        \n        <div className=\"grid md:grid-cols-2 gap-12\">\n          <div>\n            <h4 className=\"text-xs font-medium text-[#6B7280] uppercase tracking-wider mb-4\">\n              Human-in-the-Loop Policy\n            </h4>\n            <ul className=\"text-sm text-[#374151] space-y-3\">\n              <li className=\"flex items-start\">\n                <span className=\"text-[#9CA3AF] mr-2\"></span>\n                <span>No automatic claim denials</span>\n              </li>\n              <li className=\"flex items-start\">\n                <span className=\"text-[#9CA3AF] mr-2\"></span>\n                <span>Fields below 70% confidence require review</span>\n              </li>\n              <li className=\"flex items-start\">\n                <span className=\"text-[#9CA3AF] mr-2\"></span>\n                <span>Policy clause matches require verification</span>\n              </li>\n              <li className=\"flex items-start\">\n                <span className=\"text-[#9CA3AF] mr-2\"></span>\n                <span>All decisions logged with audit trail</span>\n              </li>\n            </ul>\n          </div>\n          \n          <div>\n            <h4 className=\"text-xs font-medium text-[#6B7280] uppercase tracking-wider mb-4\">\n              Explainability Standards\n            </h4>\n            <ul className=\"text-sm text-[#374151] space-y-3\">\n              <li className=\"flex items-start\">\n                <span className=\"text-[#9CA3AF] mr-2\"></span>\n                <span>Every extracted field has evidence source</span>\n              </li>\n              <li className=\"flex items-start\">\n                <span className=\"text-[#9CA3AF] mr-2\"></span>\n                <span>Policy clauses include similarity scores</span>\n              </li>\n              <li className=\"flex items-start\">\n                <span className=\"text-[#9CA3AF] mr-2\"></span>\n                <span>Clear rationale for each decision</span>\n              </li>\n              <li className=\"flex items-start\">\n                <span className=\"text-[#9CA3AF] mr-2\"></span>\n                <span>Complete audit trail maintained</span>\n              </li>\n            </ul>\n          </div>\n        </div>\n        \n        <div className=\"mt-8 pt-6 border-t border-[#E5E7EB]\">\n          <h4 className=\"text-xs font-medium text-[#6B7280] uppercase tracking-wider mb-2\">\n            Retraining & Improvement Loop\n          </h4>\n          <p className=\"text-sm text-[#374151] leading-relaxed\">\n            The system continuously learns from human overrides and feedback. When confidence thresholds are consistently exceeded or underperformed, \n            the AI models are retrained with new data to improve accuracy and reduce manual intervention.\n          </p>\n        </div>\n      </div>\n\n      {/* Actions */}\n      <div className=\"flex justify-between items-center pt-6 border-t border-[#E5E7EB]\">\n        <button\n          onClick={onReset}\n          className=\"btn-secondary inline-flex items-center space-x-2\"\n        >\n          <RefreshCw className=\"w-4 h-4\" />\n          <span>Process New Claim</span>\n        </button>\n        \n        <button className=\"btn-secondary inline-flex items-center space-x-2\">\n          <Download className=\"w-4 h-4\" />\n          <span>Export Report</span>\n        </button>\n      </div>\n    </div>\n  )\n} "],"names":[],"mappings":"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"}},
    {"offset": {"line": 7187, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/app/page.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { useRouter } from 'next/navigation'\nimport Header from '@/components/Header'\nimport HomePage from '@/components/HomePage'\nimport ReviewPage from '@/components/ReviewPage'\nimport DecisionPage from '@/components/DecisionPage'\nimport DashboardPage from '@/components/DashboardPage'\nimport { ClaimData, ProcessingStage } from '@/types/claims'\nimport { useAuth } from '@/lib/auth/AuthContext'\n\nexport default function Home() {\n  const router = useRouter()\n  const { isAuthenticated, loading } = useAuth()\n  const [currentStage, setCurrentStage] = useState<ProcessingStage>('home')\n  const [claimData, setClaimData] = useState<ClaimData | null>(null)\n  const [isProcessing, setIsProcessing] = useState(false)\n\n  // Redirect to login if not authenticated\n  useEffect(() => {\n    if (!loading && !isAuthenticated) {\n      router.push('/login')\n    }\n  }, [isAuthenticated, loading, router])\n\n  // Show loading state while checking authentication\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-white flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"w-12 h-12 border-4 border-[#2563EB] border-t-transparent rounded-full animate-spin mx-auto mb-4\"></div>\n          <p className=\"text-[#64748B]\">Loading...</p>\n        </div>\n      </div>\n    )\n  }\n\n  // Don't render main app if not authenticated\n  if (!isAuthenticated) {\n    return null\n  }\n\n  const handleStageChange = (stage: ProcessingStage) => {\n    // Prevent navigation to stages that require claimData if it's not available\n    if ((stage === 'review' || stage === 'decision' || stage === 'dashboard') && !claimData) {\n      // Stay on current stage or go to home\n      return\n    }\n    setCurrentStage(stage)\n  }\n\n  const handleClaimProcessed = (data: ClaimData) => {\n    setClaimData(data)\n    setCurrentStage('review')\n  }\n\n  const renderCurrentStage = () => {\n    switch (currentStage) {\n      case 'home':\n        return (\n          <HomePage\n            onProcessClaim={handleClaimProcessed}\n            isProcessing={isProcessing}\n            setIsProcessing={setIsProcessing}\n          />\n        )\n      case 'review':\n        return (\n          <ReviewPage\n            claimData={claimData!}\n            onNextStage={() => setCurrentStage('decision')}\n            onPreviousStage={() => setCurrentStage('home')}\n          />\n        )\n      case 'decision':\n        return (\n          <DecisionPage\n            claimData={claimData!}\n            onNextStage={() => setCurrentStage('dashboard')}\n            onPreviousStage={() => setCurrentStage('review')}\n          />\n        )\n      case 'dashboard':\n        return (\n          <DashboardPage\n            claimData={claimData!}\n            onReset={() => {\n              setCurrentStage('home')\n              setClaimData(null)\n            }}\n          />\n        )\n      default:\n        return <HomePage onProcessClaim={handleClaimProcessed} isProcessing={isProcessing} setIsProcessing={setIsProcessing} />\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen bg-white relative\">\n      <Header currentStage={currentStage} onStageChange={handleStageChange} />\n      <main className=\"container mx-auto px-8 py-16 relative z-10\">\n        {renderCurrentStage()}\n      </main>\n    </div>\n  )\n} "],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAVA;;;;;;;;;;AAYe,SAAS;IACtB,MAAM,SAAS,IAAA,uLAAS;IACxB,MAAM,EAAE,eAAe,EAAE,OAAO,EAAE,GAAG,IAAA,8KAAO;IAC5C,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yPAAQ,EAAkB;IAClE,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yPAAQ,EAAmB;IAC7D,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yPAAQ,EAAC;IAEjD,yCAAyC;IACzC,IAAA,0PAAS,EAAC;QACR,IAAI,CAAC,WAAW,CAAC,iBAAiB;YAChC,OAAO,IAAI,CAAC;QACd;IACF,GAAG;QAAC;QAAiB;QAAS;KAAO;IAErC,mDAAmD;IACnD,IAAI,SAAS;QACX,qBACE,sRAAC;YAAI,WAAU;sBACb,cAAA,sRAAC;gBAAI,WAAU;;kCACb,sRAAC;wBAAI,WAAU;;;;;;kCACf,sRAAC;wBAAE,WAAU;kCAAiB;;;;;;;;;;;;;;;;;IAItC;IAEA,6CAA6C;IAC7C,IAAI,CAAC,iBAAiB;QACpB,OAAO;IACT;IAEA,MAAM,oBAAoB,CAAC;QACzB,4EAA4E;QAC5E,IAAI,CAAC,UAAU,YAAY,UAAU,cAAc,UAAU,WAAW,KAAK,CAAC,WAAW;YACvF,sCAAsC;YACtC;QACF;QACA,gBAAgB;IAClB;IAEA,MAAM,uBAAuB,CAAC;QAC5B,aAAa;QACb,gBAAgB;IAClB;IAEA,MAAM,qBAAqB;QACzB,OAAQ;YACN,KAAK;gBACH,qBACE,sRAAC,0KAAQ;oBACP,gBAAgB;oBAChB,cAAc;oBACd,iBAAiB;;;;;;YAGvB,KAAK;gBACH,qBACE,sRAAC,4KAAU;oBACT,WAAW;oBACX,aAAa,IAAM,gBAAgB;oBACnC,iBAAiB,IAAM,gBAAgB;;;;;;YAG7C,KAAK;gBACH,qBACE,sRAAC,8KAAY;oBACX,WAAW;oBACX,aAAa,IAAM,gBAAgB;oBACnC,iBAAiB,IAAM,gBAAgB;;;;;;YAG7C,KAAK;gBACH,qBACE,sRAAC,+KAAa;oBACZ,WAAW;oBACX,SAAS;wBACP,gBAAgB;wBAChB,aAAa;oBACf;;;;;;YAGN;gBACE,qBAAO,sRAAC,0KAAQ;oBAAC,gBAAgB;oBAAsB,cAAc;oBAAc,iBAAiB;;;;;;QACxG;IACF;IAEA,qBACE,sRAAC;QAAI,WAAU;;0BACb,sRAAC,wKAAM;gBAAC,cAAc;gBAAc,eAAe;;;;;;0BACnD,sRAAC;gBAAK,WAAU;0BACb;;;;;;;;;;;;AAIT"}}]
}