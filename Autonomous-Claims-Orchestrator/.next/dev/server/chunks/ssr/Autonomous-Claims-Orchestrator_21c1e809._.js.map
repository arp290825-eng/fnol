{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/components/ConfigModal.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect } from 'react'\nimport { X, Key, CheckCircle, AlertCircle } from 'lucide-react'\n\ninterface ConfigModalProps {\n  isOpen: boolean\n  onClose: () => void\n  onSave: (apiKey: string) => void\n}\n\nexport default function ConfigModal({ isOpen, onClose, onSave }: ConfigModalProps) {\n  const [apiKey, setApiKey] = useState('')\n  const [showKey, setShowKey] = useState(false)\n  const [isValid, setIsValid] = useState(false)\n\n  useEffect(() => {\n    // Load saved API key from localStorage\n    if (typeof window !== 'undefined') {\n      const savedKey = localStorage.getItem('openai_api_key')\n      if (savedKey) {\n        setApiKey(savedKey)\n        setIsValid(savedKey.startsWith('sk-') && savedKey.length > 20)\n      }\n    }\n  }, [isOpen])\n\n  const handleSave = () => {\n    if (apiKey.trim()) {\n      // Save to localStorage and window for immediate use\n      if (typeof window !== 'undefined') {\n        localStorage.setItem('openai_api_key', apiKey.trim())\n        ;(window as any).OPENAI_API_KEY = apiKey.trim()\n      }\n      onSave(apiKey.trim())\n      onClose()\n    }\n  }\n\n  const handleApiKeyChange = (value: string) => {\n    setApiKey(value)\n    setIsValid(value.startsWith('sk-') && value.length > 20)\n  }\n\n  const clearApiKey = () => {\n    setApiKey('')\n    setIsValid(false)\n    if (typeof window !== 'undefined') {\n      localStorage.removeItem('openai_api_key')\n      delete (window as any).OPENAI_API_KEY\n    }\n    onSave('')\n  }\n\n  if (!isOpen) return null\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n      <div className=\"bg-white rounded-lg p-6 w-full max-w-md mx-4\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h2 className=\"text-xl font-semibold text-gray-900\">OpenAI Configuration</h2>\n          <button\n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600\"\n          >\n            <X className=\"w-6 h-6\" />\n          </button>\n        </div>\n\n        <div className=\"space-y-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              OpenAI API Key\n            </label>\n            <div className=\"relative\">\n              <input\n                type={showKey ? 'text' : 'password'}\n                value={apiKey}\n                onChange={(e) => handleApiKeyChange(e.target.value)}\n                placeholder=\"sk-...\"\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 pr-12\"\n              />\n              <div className=\"absolute right-3 top-1/2 transform -translate-y-1/2 flex items-center space-x-1\">\n                {isValid ? (\n                  <CheckCircle className=\"w-4 h-4 text-green-500\" />\n                ) : apiKey ? (\n                  <AlertCircle className=\"w-4 h-4 text-red-500\" />\n                ) : null}\n                <button\n                  onClick={() => setShowKey(!showKey)}\n                  className=\"text-gray-400 hover:text-gray-600\"\n                >\n                  <Key className=\"w-4 h-4\" />\n                </button>\n              </div>\n            </div>\n            {apiKey && !isValid && (\n              <p className=\"text-sm text-red-600 mt-1\">\n                API key should start with 'sk-' and be at least 20 characters\n              </p>\n            )}\n          </div>\n\n          <div className=\"bg-blue-50 border border-blue-200 rounded-md p-3\">\n            <h3 className=\"text-sm font-medium text-blue-900 mb-1\">How to get your API key:</h3>\n            <ol className=\"text-sm text-blue-800 space-y-1\">\n              <li>1. Go to <a href=\"https://platform.openai.com/api-keys\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"underline\">platform.openai.com/api-keys</a></li>\n              <li>2. Click \"Create new secret key\"</li>\n              <li>3. Copy the key and paste it here</li>\n            </ol>\n          </div>\n\n          <div className=\"bg-yellow-50 border border-yellow-200 rounded-md p-3\">\n            <p className=\"text-sm text-yellow-800\">\n              <strong>Demo Mode:</strong> Without an API key, the system will use simulated responses. \n              With a real API key, you'll get actual AI-powered extraction and analysis.\n            </p>\n          </div>\n\n          <div className=\"flex justify-between pt-4\">\n            <button\n              onClick={clearApiKey}\n              className=\"px-4 py-2 text-sm text-red-600 hover:text-red-800\"\n            >\n              Clear Key\n            </button>\n            <div className=\"space-x-2\">\n              <button\n                onClick={onClose}\n                className=\"px-4 py-2 text-sm text-gray-600 hover:text-gray-800\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={handleSave}\n                className=\"px-4 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 disabled:opacity-50\"\n                disabled={!apiKey.trim()}\n              >\n                Save\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAHA;;;;AAWe,SAAS,YAAY,EAAE,MAAM,EAAE,OAAO,EAAE,MAAM,EAAoB;IAC/E,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yPAAQ,EAAC;IACrC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yPAAQ,EAAC;IACvC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yPAAQ,EAAC;IAEvC,IAAA,0PAAS,EAAC;QACR,uCAAuC;QACvC;;IAOF,GAAG;QAAC;KAAO;IAEX,MAAM,aAAa;QACjB,IAAI,OAAO,IAAI,IAAI;YACjB,oDAAoD;YACpD;;YAIA,OAAO,OAAO,IAAI;YAClB;QACF;IACF;IAEA,MAAM,qBAAqB,CAAC;QAC1B,UAAU;QACV,WAAW,MAAM,UAAU,CAAC,UAAU,MAAM,MAAM,GAAG;IACvD;IAEA,MAAM,cAAc;QAClB,UAAU;QACV,WAAW;QACX;;QAIA,OAAO;IACT;IAEA,IAAI,CAAC,QAAQ,OAAO;IAEpB,qBACE,sRAAC;QAAI,WAAU;kBACb,cAAA,sRAAC;YAAI,WAAU;;8BACb,sRAAC;oBAAI,WAAU;;sCACb,sRAAC;4BAAG,WAAU;sCAAsC;;;;;;sCACpD,sRAAC;4BACC,SAAS;4BACT,WAAU;sCAEV,cAAA,sRAAC,yOAAC;gCAAC,WAAU;;;;;;;;;;;;;;;;;8BAIjB,sRAAC;oBAAI,WAAU;;sCACb,sRAAC;;8CACC,sRAAC;oCAAM,WAAU;8CAA+C;;;;;;8CAGhE,sRAAC;oCAAI,WAAU;;sDACb,sRAAC;4CACC,MAAM,UAAU,SAAS;4CACzB,OAAO;4CACP,UAAU,CAAC,IAAM,mBAAmB,EAAE,MAAM,CAAC,KAAK;4CAClD,aAAY;4CACZ,WAAU;;;;;;sDAEZ,sRAAC;4CAAI,WAAU;;gDACZ,wBACC,sRAAC,2QAAW;oDAAC,WAAU;;;;;2DACrB,uBACF,sRAAC,2QAAW;oDAAC,WAAU;;;;;2DACrB;8DACJ,sRAAC;oDACC,SAAS,IAAM,WAAW,CAAC;oDAC3B,WAAU;8DAEV,cAAA,sRAAC,+OAAG;wDAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;gCAIpB,UAAU,CAAC,yBACV,sRAAC;oCAAE,WAAU;8CAA4B;;;;;;;;;;;;sCAM7C,sRAAC;4BAAI,WAAU;;8CACb,sRAAC;oCAAG,WAAU;8CAAyC;;;;;;8CACvD,sRAAC;oCAAG,WAAU;;sDACZ,sRAAC;;gDAAG;8DAAS,sRAAC;oDAAE,MAAK;oDAAuC,QAAO;oDAAS,KAAI;oDAAsB,WAAU;8DAAY;;;;;;;;;;;;sDAC5H,sRAAC;sDAAG;;;;;;sDACJ,sRAAC;sDAAG;;;;;;;;;;;;;;;;;;sCAIR,sRAAC;4BAAI,WAAU;sCACb,cAAA,sRAAC;gCAAE,WAAU;;kDACX,sRAAC;kDAAO;;;;;;oCAAmB;;;;;;;;;;;;sCAK/B,sRAAC;4BAAI,WAAU;;8CACb,sRAAC;oCACC,SAAS;oCACT,WAAU;8CACX;;;;;;8CAGD,sRAAC;oCAAI,WAAU;;sDACb,sRAAC;4CACC,SAAS;4CACT,WAAU;sDACX;;;;;;sDAGD,sRAAC;4CACC,SAAS;4CACT,WAAU;4CACV,UAAU,CAAC,OAAO,IAAI;sDACvB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASf"}},
    {"offset": {"line": 323, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/components/Header.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect } from 'react'\nimport { ProcessingStage } from '@/types/claims'\nimport { motion } from 'framer-motion'\nimport { \n  Home, \n  Search, \n  CheckCircle, \n  BarChart3,\n  Zap,\n  Settings,\n  Brain,\n  LogOut,\n  User\n} from 'lucide-react'\nimport ConfigModal from './ConfigModal'\nimport { useAuth } from '@/lib/auth/AuthContext'\n\ninterface HeaderProps {\n  currentStage: ProcessingStage\n  onStageChange: (stage: ProcessingStage) => void\n}\n\nconst stages = [\n  { id: 'home', label: 'Ingest', icon: Home, description: 'Select Policy & Process' },\n  { id: 'review', label: 'Review', icon: Search, description: 'Extraction & Evidence' },\n  { id: 'decision', label: 'Decision', icon: CheckCircle, description: 'Draft Claim & Actions' },\n  { id: 'dashboard', label: 'Dashboard', icon: BarChart3, description: 'Ops & Metrics' },\n] as const\n\nexport default function Header({ currentStage, onStageChange }: HeaderProps) {\n  const [showConfig, setShowConfig] = useState(false)\n  const [hasOpenAIKey, setHasOpenAIKey] = useState(false)\n  const { user, logout } = useAuth()\n\n  useEffect(() => {\n    // Check for OpenAI API key\n    const checkOpenAIKey = () => {\n      if (typeof window !== 'undefined') {\n        const key = localStorage.getItem('openai_api_key') || (window as any).OPENAI_API_KEY\n        setHasOpenAIKey(!!key)\n      }\n    }\n    \n    checkOpenAIKey()\n    // Check periodically in case key is updated elsewhere\n    const interval = setInterval(checkOpenAIKey, 2000)\n    return () => clearInterval(interval)\n  }, [])\n\n  const handleConfigSave = (apiKey: string) => {\n    setHasOpenAIKey(!!apiKey)\n  }\n\n  return (\n    <>\n      <header className=\"bg-white border-b border-[#E5E7EB] sticky top-0 z-50\">\n        <div className=\"container mx-auto px-8\">\n          <div className=\"flex items-center justify-between h-16\">\n            {/* Logo */}\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"flex items-center justify-center w-8 h-8 bg-[#2563EB] rounded\">\n                <Zap className=\"w-4 h-4 text-white\" />\n              </div>\n              <div className=\"flex flex-col\">\n                <h1 className=\"text-lg font-semibold text-[#111827]\">\n                  Claims Fast Lane\n                </h1>\n                <p className=\"text-xs text-[#9CA3AF] font-medium\">by AI Mill</p>\n              </div>\n            </div>\n\n            {/* Navigation */}\n            <nav className=\"flex items-center space-x-1\">\n              {stages.map((stage, index) => {\n                const Icon = stage.icon\n                const isActive = currentStage === stage.id\n                \n                return (\n                  <button\n                    key={stage.id}\n                    onClick={() => onStageChange(stage.id as ProcessingStage)}\n                    className={`\n                      flex items-center space-x-2 px-4 py-2 text-sm font-medium transition-colors\n                      ${isActive \n                        ? 'text-[#2563EB] border-b-2 border-[#2563EB]' \n                        : 'text-[#6B7280] hover:text-[#374151]'\n                      }\n                    `}\n                  >\n                    <Icon className=\"w-4 h-4\" />\n                    <span className=\"hidden sm:inline\">{stage.label}</span>\n                  </button>\n                )\n              })}\n            </nav>\n\n            {/* Secondary controls - visually muted */}\n            <div className=\"flex items-center space-x-3\">\n              {hasOpenAIKey ? (\n                <div className=\"flex items-center space-x-1.5 text-[#9CA3AF]\">\n                  <Brain className=\"w-3.5 h-3.5\" />\n                  <span className=\"text-xs\">AI</span>\n                </div>\n              ) : (\n                <div className=\"flex items-center space-x-1.5 text-[#9CA3AF]\">\n                  <Zap className=\"w-3.5 h-3.5\" />\n                  <span className=\"text-xs\">Demo</span>\n                </div>\n              )}\n              <button \n                onClick={() => setShowConfig(true)}\n                className=\"p-1.5 text-[#9CA3AF] hover:text-[#6B7280] transition-colors\"\n                title=\"Settings\"\n              >\n                <Settings className=\"w-4 h-4\" />\n              </button>\n              {/* User info and logout */}\n              {user && (\n                <div className=\"flex items-center space-x-2 px-3 py-1.5 rounded-lg bg-[#F3F4F6]\">\n                  <User className=\"w-3.5 h-3.5 text-[#6B7280]\" />\n                  <span className=\"text-xs text-[#6B7280] font-medium hidden sm:inline\">\n                    {user.name}\n                  </span>\n                </div>\n              )}\n              <button\n                onClick={logout}\n                className=\"p-1.5 text-[#9CA3AF] hover:text-[#EF4444] transition-colors\"\n                title=\"Logout\"\n              >\n                <LogOut className=\"w-4 h-4\" />\n              </button>\n              {/* Image at the very right */}\n              <div className=\"flex items-center space-x-2 ml-2\">\n                <img \n                  src=\"/image.png\" \n                  alt=\"AI Mill\" \n                  className=\"h-10 w-auto object-contain\"\n                />\n                <span className=\"text-xs text-[#9CA3AF] font-medium\">By AI Mill</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </header>\n\n    <ConfigModal\n      isOpen={showConfig}\n      onClose={() => setShowConfig(false)}\n      onSave={handleConfigSave}\n    />\n  </>\n  )\n} "],"names":[],"mappings":"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"}},
    {"offset": {"line": 656, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/components/HomePage.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport {\n  Mail,\n  FileText,\n  Image,\n  AlertCircle,\n  Play,\n  Clock,\n  CheckCircle,\n  Inbox,\n  RefreshCw,\n  Trash2,\n} from 'lucide-react'\nimport { ClaimData } from '@/types/claims'\n\ninterface HomePageProps {\n  onProcessClaim: (data: ClaimData) => void\n  isProcessing: boolean\n  setIsProcessing: (processing: boolean) => void\n}\n\ninterface IngestedClaim {\n  id: string\n  policyNumber: string\n  from: string\n  to: string\n  subject: string\n  emailBody: string\n  attachments: Array<{ name: string; path: string; size: number; mimeType: string }>\n  createdAt: string\n  source: 'sendgrid' | 'demo' | 'imap'\n}\n\ninterface PolicyOption {\n  id: string\n  policyNumber: string\n  subject: string\n}\n\nexport default function HomePage({ onProcessClaim, isProcessing, setIsProcessing }: HomePageProps) {\n  const [policyOptions, setPolicyOptions] = useState<PolicyOption[]>([])\n  const [selectedClaim, setSelectedClaim] = useState<IngestedClaim | null>(null)\n  const [loadingPolicies, setLoadingPolicies] = useState(true)\n  const [loadingClaim, setLoadingClaim] = useState(false)\n  const [syncingInbox, setSyncingInbox] = useState(false)\n  const [syncMessage, setSyncMessage] = useState('')\n  const [clearingClaims, setClearingClaims] = useState(false)\n  const [error, setError] = useState('')\n  const [processingSteps, setProcessingSteps] = useState<string[]>([])\n  const [currentStep, setCurrentStep] = useState('')\n\n  useEffect(() => {\n    fetchPolicyOptions()\n  }, [])\n\n  const handleClearClaims = async () => {\n    if (!confirm('Clear all ingested claims? This cannot be undone.')) return\n    setClearingClaims(true)\n    setError('')\n    setSyncMessage('')\n    try {\n      const res = await fetch('/api/ingested-claims/clear', { method: 'POST' })\n      if (!res.ok) throw new Error('Clear failed')\n      setSelectedClaim(null)\n      await fetchPolicyOptions()\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to clear')\n    } finally {\n      setClearingClaims(false)\n    }\n  }\n\n  const handleSyncInbox = async () => {\n    setSyncingInbox(true)\n    setError('')\n    setSyncMessage('')\n    try {\n      const res = await fetch('/api/sync-inbox', { method: 'POST' })\n      const data = await res.json()\n      if (!res.ok) throw new Error(data.errors?.[0] || 'Sync failed')\n      if (data.ingested > 0) {\n        const parts = [`${data.ingested} new claim(s) ingested`]\n        if (data.skippedDuplicate > 0) parts.push(`${data.skippedDuplicate} duplicate(s) skipped`)\n        setSyncMessage(parts.join('. '))\n      } else if (data.scanned > 0 && data.skippedNoFnol === data.scanned) {\n        setSyncMessage(`Scanned ${data.scanned} — none matched FNOL (fnol/claim/damage)`)\n      } else if (data.scanned > 0 && data.skippedDuplicate === data.scanned) {\n        setSyncMessage(`Scanned ${data.scanned} — all already ingested`)\n      } else if (data.scanned === 0) {\n        setSyncMessage(data.hint || 'No emails to sync')\n      } else {\n        setSyncMessage('No new FNOL emails to ingest')\n      }\n      await fetchPolicyOptions()\n      if (data.errors?.length) setError(data.errors.join('; '))\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to sync inbox')\n    } finally {\n      setSyncingInbox(false)\n    }\n  }\n\n  const fetchPolicyOptions = async () => {\n    setLoadingPolicies(true)\n    setError('')\n    try {\n      const res = await fetch('/api/ingested-claims')\n      if (!res.ok) throw new Error('Failed to load claims')\n      const data = await res.json()\n      setPolicyOptions(data)\n    } catch (err) {\n      setError('Unable to load ingested claims. Please try again.')\n      setPolicyOptions([])\n    } finally {\n      setLoadingPolicies(false)\n    }\n  }\n\n  const handleSelectPolicy = async (claimId: string) => {\n    if (!claimId) {\n      setSelectedClaim(null)\n      return\n    }\n    setLoadingClaim(true)\n    setError('')\n    try {\n      const res = await fetch(`/api/ingested-claims/${claimId}`)\n      if (!res.ok) throw new Error('Failed to load claim')\n      const data = await res.json()\n      setSelectedClaim(data)\n    } catch (err) {\n      setError('Unable to load claim details.')\n      setSelectedClaim(null)\n    } finally {\n      setLoadingClaim(false)\n    }\n  }\n\n  const handleProcessClaim = async () => {\n    if (!selectedClaim) return\n    setError('')\n    setIsProcessing(true)\n    setProcessingSteps([])\n    setCurrentStep('')\n\n    const steps = [\n      'Loading claim data from ingested inbox...',\n      'Extracting information from email and attachments...',\n      'Analyzing documents and images (Vision)...',\n      'Policy Grounding: Matching claim against policy clause database...',\n      'Assembling decision pack and saving to history...',\n    ]\n\n    for (let i = 0; i < steps.length; i++) {\n      setCurrentStep(steps[i])\n      setProcessingSteps((prev) => [...prev, steps[i]])\n      await new Promise((resolve) => setTimeout(resolve, 700))\n    }\n\n    try {\n      const res = await fetch('/api/process-claim', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ ingestedClaimId: selectedClaim.id }),\n      })\n      const data = await res.json()\n      if (!res.ok) throw new Error(data.error || 'Processing failed')\n      onProcessClaim(data)\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Claim processing failed')\n    } finally {\n      setIsProcessing(false)\n    }\n  }\n\n  const canProcess = !!selectedClaim && !isProcessing\n\n  return (\n    <div className=\"relative min-h-screen\">\n      {/* Grid Background */}\n      <div\n        className=\"absolute inset-0 pointer-events-none z-0\"\n        style={{\n          backgroundImage: `\n            linear-gradient(to right, rgba(37, 99, 235, 0.06) 1px, transparent 1px),\n            linear-gradient(to bottom, rgba(37, 99, 235, 0.06) 1px, transparent 1px)\n          `,\n          backgroundSize: '48px 48px',\n        }}\n      />\n\n      <div className=\"max-w-6xl mx-auto relative z-10\">\n        {/* Hero Section */}\n        <div className=\"text-center mb-16 pt-12 relative\">\n          <div className=\"absolute inset-0 -top-20 -bottom-20 flex items-center justify-center pointer-events-none\">\n            <div className=\"w-full max-w-2xl h-64 bg-gradient-radial from-[#2563EB]/10 via-[#7C3AED]/5 to-transparent rounded-full blur-3xl\" />\n          </div>\n          <div className=\"relative z-10\">\n            <span className=\"inline-block text-xs font-semibold text-[#6366F1] uppercase tracking-widest mb-6\">\n              FNOL Auto-Ingestion\n            </span>\n            <h1 className=\"text-6xl font-bold text-[#0F172A] mb-6 tracking-tight leading-tight\">\n              Claims Processing\n              <br />\n              <span className=\"bg-gradient-to-r from-[#2563EB] to-[#7C3AED] bg-clip-text text-transparent\">\n                Inbox Portal\n              </span>\n            </h1>\n            <p className=\"text-xl text-[#475569] max-w-2xl mx-auto mb-3 font-medium leading-relaxed\">\n              Select a policy number to review and process the corresponding FNOL submission\n            </p>\n            <p className=\"text-base text-[#64748B] max-w-xl mx-auto\">\n              First notice of loss submissions and supporting documentation are ingested automatically\n            </p>\n          </div>\n        </div>\n\n        {/* Action Bar: Sync Inbox & Clear All */}\n        <div className=\"flex flex-col sm:flex-row items-center justify-center gap-4 mb-10 relative z-10\">\n          <div className=\"flex items-center gap-3\">\n            <button\n              onClick={handleSyncInbox}\n              disabled={syncingInbox || loadingPolicies}\n              className=\"flex items-center gap-2 px-5 py-2.5 text-sm font-semibold text-white bg-[#6366F1] hover:bg-[#4F46E5] rounded-xl shadow-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n              title=\"Fetch FNOL emails from inbox\"\n            >\n              <RefreshCw className={`w-4 h-4 ${syncingInbox ? 'animate-spin' : ''}`} />\n              Sync Inbox\n            </button>\n            <button\n              onClick={handleClearClaims}\n              disabled={clearingClaims || loadingPolicies || policyOptions.length === 0}\n              className=\"flex items-center gap-2 px-5 py-2.5 text-sm font-medium text-[#64748B] bg-white border border-[#E2E8F0] hover:border-[#dc2626] hover:text-[#dc2626] rounded-xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n              title=\"Clear all ingested claims\"\n            >\n              <Trash2 className={`w-4 h-4 ${clearingClaims ? 'animate-pulse' : ''}`} />\n              Clear All\n            </button>\n          </div>\n          {syncMessage && (\n            <span className=\"text-sm text-[#059669] font-medium\">{syncMessage}</span>\n          )}\n        </div>\n\n        {/* Policy Selection & Content */}\n        <div className=\"grid lg:grid-cols-2 gap-8 mb-16 relative z-10\">\n          {/* Left: Policy Selector & Email Preview */}\n          <div className=\"card-glass p-8 h-full flex flex-col relative overflow-hidden\">\n            <div className=\"absolute inset-0 bg-gradient-to-br from-[#2563EB]/5 via-transparent to-[#7C3AED]/5 pointer-events-none\" />\n            <div className=\"relative z-10 flex flex-col h-full\">\n              <div className=\"flex items-center space-x-2 mb-6\">\n                <div className=\"p-2 bg-gradient-to-br from-[#2563EB]/10 to-[#7C3AED]/10 rounded-lg\">\n                  <Inbox className=\"w-5 h-5 text-[#6366F1]\" />\n                </div>\n                <h2 className=\"text-sm font-semibold text-[#475569] uppercase tracking-wider\">\n                  Auto-Ingested FNOL Emails\n                </h2>\n              </div>\n\n              {/* Policy Dropdown */}\n              <div className=\"space-y-2 mb-6\">\n                <label className=\"block text-sm font-medium text-[#334155]\">Policy Number</label>\n                <select\n                  value={selectedClaim?.id ?? ''}\n                  onChange={(e) => handleSelectPolicy(e.target.value)}\n                  disabled={loadingPolicies}\n                  className=\"w-full px-4 py-3 bg-white/80 border border-[#E2E8F0] rounded-xl text-[#0F172A] focus:outline-none focus:ring-2 focus:ring-[#6366F1]/30 focus:border-[#6366F1] transition-all appearance-none cursor-pointer\"\n                  style={{\n                    backgroundImage: `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2394A3B8'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'/%3E%3C/svg%3E\")`,\n                    backgroundRepeat: 'no-repeat',\n                    backgroundPosition: 'right 12px center',\n                    backgroundSize: '20px',\n                    paddingRight: '44px',\n                  }}\n                >\n                  <option value=\"\">\n                    {loadingPolicies ? 'Loading...' : 'Select policy to view FNOL email'}\n                  </option>\n                  {policyOptions.map((opt) => (\n                    <option key={opt.id} value={opt.id}>\n                      {opt.policyNumber} — {opt.subject.slice(0, 50)}{opt.subject.length > 50 ? '...' : ''}\n                    </option>\n                  ))}\n                </select>\n              </div>\n\n              {/* Email Body (Read-only) */}\n              <div className=\"flex-1 flex flex-col min-h-0\">\n                <div className=\"flex items-center space-x-2 mb-3\">\n                  <Mail className=\"w-4 h-4 text-[#6366F1]\" />\n                  <span className=\"text-xs font-semibold text-[#475569] uppercase tracking-wider\">\n                    Email Content\n                  </span>\n                </div>\n                <div className=\"flex-1 min-h-[280px] overflow-auto\">\n                  {loadingClaim ? (\n                    <div className=\"flex items-center justify-center h-full text-[#94A3B8]\">\n                      <RefreshCw className=\"w-6 h-6 animate-spin mr-2\" />\n                      Loading...\n                    </div>\n                  ) : selectedClaim ? (\n                    <pre className=\"w-full p-4 bg-white/60 rounded-xl border border-[#E2E8F0] text-sm text-[#334155] whitespace-pre-wrap font-sans leading-relaxed\">\n                      {selectedClaim.emailBody}\n                    </pre>\n                  ) : (\n                    <div className=\"h-full flex items-center justify-center p-8 border-2 border-dashed border-[#E2E8F0] rounded-xl bg-white/30 text-[#94A3B8] text-sm text-center\">\n                      Select a policy number to view the auto-ingested FNOL email\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Right: Attachments */}\n          <div className=\"card-glass p-8 h-full flex flex-col relative overflow-hidden\">\n            <div className=\"absolute inset-0 bg-gradient-to-br from-[#7C3AED]/5 via-transparent to-[#2563EB]/5 pointer-events-none\" />\n            <div className=\"relative z-10 flex flex-col h-full\">\n              <div className=\"flex items-center space-x-2 mb-6\">\n                <div className=\"p-2 bg-gradient-to-br from-[#7C3AED]/10 to-[#2563EB]/10 rounded-lg\">\n                  <FileText className=\"w-5 h-5 text-[#6366F1]\" />\n                </div>\n                <h2 className=\"text-sm font-semibold text-[#475569] uppercase tracking-wider\">\n                  Attachments\n                </h2>\n              </div>\n\n              <div className=\"flex-1 min-h-[340px] overflow-auto\">\n                {selectedClaim?.attachments && selectedClaim.attachments.length > 0 ? (\n                  <div className=\"space-y-3\">\n                    {selectedClaim.attachments.map((att) => (\n                      <div\n                        key={att.name}\n                        className=\"flex items-center justify-between p-4 bg-white/60 backdrop-blur-sm rounded-xl border border-[#E2E8F0] hover:border-[#CBD5E1] hover:shadow-md transition-all\"\n                      >\n                        <div className=\"flex items-center space-x-3 min-w-0 flex-1\">\n                          {att.mimeType.startsWith('image/') ? (\n                            <div className=\"p-2 bg-[#EEF2FF] rounded-lg\">\n                              <Image className=\"w-4 h-4 text-[#6366F1] flex-shrink-0\" />\n                            </div>\n                          ) : (\n                            <div className=\"p-2 bg-[#F3E8FF] rounded-lg\">\n                              <FileText className=\"w-4 h-4 text-[#7C3AED] flex-shrink-0\" />\n                            </div>\n                          )}\n                          <div className=\"min-w-0 flex-1\">\n                            <p className=\"text-sm font-semibold text-[#0F172A] truncate\">\n                              {att.name}\n                            </p>\n                            <p className=\"text-xs text-[#94A3B8] font-medium\">\n                              {(att.size / 1024).toFixed(1)} KB\n                            </p>\n                          </div>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                ) : selectedClaim ? (\n                  <div className=\"h-full flex items-center justify-center p-8 border-2 border-dashed border-[#E2E8F0] rounded-xl bg-white/30 text-[#94A3B8] text-sm text-center\">\n                    No attachments for this claim\n                  </div>\n                ) : (\n                  <div className=\"h-full flex items-center justify-center p-8 border-2 border-dashed border-[#E2E8F0] rounded-xl bg-white/30 text-[#94A3B8] text-sm text-center\">\n                    Select a policy to view attachments\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Error Message */}\n        {error && (\n          <div className=\"mb-6 flex items-start space-x-2 p-4 bg-red-50 border border-red-100 rounded-xl\">\n            <AlertCircle className=\"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5\" />\n            <p className=\"text-sm text-red-700\">{error}</p>\n          </div>\n        )}\n\n        {/* Process Button */}\n        <div className=\"text-center mb-16 relative z-10\">\n          <button\n            onClick={handleProcessClaim}\n            disabled={!canProcess}\n            className=\"btn-primary disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105 active:scale-100 transition-transform duration-200\"\n          >\n            {isProcessing ? (\n              <div className=\"flex items-center space-x-3\">\n                <Clock className=\"w-5 h-5 animate-spin\" />\n                <span>Processing...</span>\n              </div>\n            ) : (\n              <div className=\"flex items-center space-x-3\">\n                <Play className=\"w-5 h-5\" />\n                <span>Process Claim Insights</span>\n              </div>\n            )}\n          </button>\n        </div>\n\n        {/* Processing Steps */}\n        {isProcessing && (\n          <div className=\"card-glass p-8 relative overflow-hidden z-10\">\n            <div className=\"absolute inset-0 bg-gradient-to-br from-[#EEF2FF]/50 via-transparent to-[#F3E8FF]/50 pointer-events-none\" />\n            <div className=\"relative z-10\">\n              <h3 className=\"text-sm font-semibold text-[#475569] uppercase tracking-wider mb-6\">\n                Processing Steps\n              </h3>\n              <div className=\"space-y-3\">\n                {processingSteps.map((step, index) => (\n                  <div\n                    key={index}\n                    className=\"flex items-center space-x-4 p-4 bg-white/60 backdrop-blur-sm rounded-xl border border-[#E2E8F0]\"\n                  >\n                    <div className=\"p-1.5 bg-gradient-to-br from-[#10B981] to-[#059669] rounded-full\">\n                      <CheckCircle className=\"w-4 h-4 text-white flex-shrink-0\" />\n                    </div>\n                    <span className=\"text-sm text-[#334155] font-medium\">{step}</span>\n                  </div>\n                ))}\n                {currentStep && !processingSteps.includes(currentStep) && (\n                  <div className=\"flex items-center space-x-4 p-4 bg-gradient-to-r from-[#EEF2FF] to-[#F3E8FF] rounded-xl border border-[#C7D2FE]\">\n                    <div className=\"p-1.5 bg-gradient-to-br from-[#6366F1] to-[#7C3AED] rounded-full\">\n                      <Clock className=\"w-4 h-4 text-white animate-spin flex-shrink-0\" />\n                    </div>\n                    <span className=\"text-sm text-[#4338CA] font-semibold\">{currentStep}</span>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1535, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/lib/confidence.ts"],"sourcesContent":["/**\n * Confidence score thresholds used across the application.\n * All displayed confidence values should be real-time (from extraction), not static.\n */\n\nexport const CONFIDENCE = {\n  /** High: auto-approve / trusted */\n  THRESHOLD_HIGH: 0.8,\n  /** Medium: proceed with normal review */\n  THRESHOLD_MEDIUM: 0.6,\n  /** Low: requires manual review */\n  THRESHOLD_LOW: 0,\n} as const\n\nexport function isHighConfidence(c: number): boolean {\n  return c >= CONFIDENCE.THRESHOLD_HIGH\n}\n\nexport function isMediumConfidence(c: number): boolean {\n  return c >= CONFIDENCE.THRESHOLD_MEDIUM && c < CONFIDENCE.THRESHOLD_HIGH\n}\n\nexport function isLowConfidence(c: number): boolean {\n  return c < CONFIDENCE.THRESHOLD_MEDIUM\n}\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;;;AAEM,MAAM,aAAa;IACxB,iCAAiC,GACjC,gBAAgB;IAChB,uCAAuC,GACvC,kBAAkB;IAClB,gCAAgC,GAChC,eAAe;AACjB;AAEO,SAAS,iBAAiB,CAAS;IACxC,OAAO,KAAK,WAAW,cAAc;AACvC;AAEO,SAAS,mBAAmB,CAAS;IAC1C,OAAO,KAAK,WAAW,gBAAgB,IAAI,IAAI,WAAW,cAAc;AAC1E;AAEO,SAAS,gBAAgB,CAAS;IACvC,OAAO,IAAI,WAAW,gBAAgB;AACxC"}},
    {"offset": {"line": 1566, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/components/ClaimSummaryBar.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { ArrowLeft, ArrowRight, ChevronDown, Download } from 'lucide-react'\nimport { ClaimData } from '@/types/claims'\nimport { CONFIDENCE } from '@/lib/confidence'\nimport type { ProcessedClaimSummary } from '@/lib/processedClaims'\n\ninterface ClaimSummaryBarProps {\n  claimData: ClaimData\n  onBack?: () => void\n  onContinue?: () => void\n  continueLabel?: string\n  showActions?: boolean\n  showClaimDropdown?: boolean\n  onClaimSelect?: (claimId: string) => void\n}\n\nexport default function ClaimSummaryBar({\n  claimData,\n  onBack,\n  onContinue,\n  continueLabel = 'Continue',\n  showActions = true,\n  showClaimDropdown = false,\n  onClaimSelect,\n}: ClaimSummaryBarProps) {\n  const [processedClaims, setProcessedClaims] = useState<ProcessedClaimSummary[]>([])\n  const [dropdownOpen, setDropdownOpen] = useState(false)\n\n  useEffect(() => {\n    if (showClaimDropdown) {\n      fetch('/api/claims')\n        .then((r) => r.json())\n        .then((data) => setProcessedClaims(Array.isArray(data) ? data : []))\n        .catch(() => setProcessedClaims([]))\n    }\n  }, [showClaimDropdown])\n\n  const { decisionPack, claimId, status } = claimData\n  const claimDraft = decisionPack?.claimDraft\n  const evidence = decisionPack?.evidence ?? []\n  const displayClaimId = claimId || claimDraft?.id || 'N/A'\n  const overallConfidence =\n    evidence.length > 0\n      ? Math.round(\n          (evidence.reduce((s, e) => s + e.confidence, 0) / evidence.length) * 100\n        )\n      : 0\n\n  const getStatusColor = (s?: string) => {\n    if (!s) return 'bg-[#E5E7EB] text-[#374151]'\n    const lower = s.toLowerCase()\n    if (lower.includes('complete') || lower.includes('approved')) return 'bg-[#ECFDF5] text-[#047857]'\n    if (lower.includes('pending') || lower.includes('processing')) return 'bg-[#EFF6FF] text-[#1E40AF]'\n    if (lower.includes('reject') || lower.includes('error')) return 'bg-[#FEF2F2] text-[#B91C1C]'\n    return 'bg-[#FFFBEB] text-[#B45309]'\n  }\n\n  return (\n    <div className=\"sticky top-0 z-50 bg-white/95 backdrop-blur-sm border-b border-[#E5E7EB] shadow-sm px-8 py-4 mb-6\">\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center space-x-6\">\n          <div className=\"relative flex items-end gap-3\">\n            <div>\n              <div className=\"text-xs font-semibold text-[#6B7280] uppercase tracking-wider mb-1\">\n                Claim ID\n              </div>\n              {showClaimDropdown && onClaimSelect && processedClaims.length > 0 ? (\n              <div className=\"relative\">\n                <button\n                  type=\"button\"\n                  onClick={() => setDropdownOpen(!dropdownOpen)}\n                  className=\"flex items-center gap-2 min-w-[180px] px-3 py-2 text-left text-lg font-bold text-[#111827] bg-white border border-[#E5E7EB] rounded-lg hover:border-[#6366F1] focus:outline-none focus:ring-2 focus:ring-[#6366F1] focus:ring-offset-1\"\n                >\n                  <span className=\"truncate\">{displayClaimId}</span>\n                  <ChevronDown className={`w-4 h-4 flex-shrink-0 transition-transform ${dropdownOpen ? 'rotate-180' : ''}`} />\n                </button>\n                {dropdownOpen && (\n                  <>\n                    <div className=\"fixed inset-0 z-40\" onClick={() => setDropdownOpen(false)} aria-hidden=\"true\" />\n                    <div className=\"absolute left-0 top-full mt-1 z-50 w-full max-w-md max-h-64 overflow-auto bg-white border border-[#E5E7EB] rounded-lg shadow-lg py-1\">\n                      {processedClaims.map((c) => (\n                        <button\n                          key={c.claimId}\n                          type=\"button\"\n                          onClick={() => {\n                            onClaimSelect(c.claimId)\n                            setDropdownOpen(false)\n                          }}\n                          className={`w-full px-4 py-2.5 text-left text-sm hover:bg-[#F3F4F6] ${\n                            c.claimId === displayClaimId ? 'bg-[#EEF2FF] text-[#4F46E5] font-medium' : 'text-[#374151]'\n                          }`}\n                        >\n                          <div className=\"font-medium truncate\">{c.claimId}</div>\n                          <div className=\"text-xs text-[#6B7280] truncate\">\n                            {[c.policyNumber, c.claimantName].filter(Boolean).join(' • ') || new Date(c.createdAt).toLocaleDateString()}\n                          </div>\n                        </button>\n                      ))}\n                    </div>\n                  </>\n                )}\n              </div>\n            ) : (\n              <div className=\"text-lg font-bold text-[#111827]\">{displayClaimId}</div>\n            )}\n            </div>\n            {showClaimDropdown && processedClaims.length > 0 && (\n              <a\n                href=\"/api/claims/export\"\n                download=\"claims-history.csv\"\n                className=\"pb-0.5 inline-flex items-center gap-1 text-xs text-[#6366F1] hover:text-[#4F46E5] hover:underline\"\n                title=\"Download claims history CSV\"\n              >\n                <Download className=\"w-3.5 h-3.5\" />\n                Export CSV\n              </a>\n            )}\n          </div>\n          <div className=\"h-12 w-px bg-[#E5E7EB]\" />\n          <div>\n            <div className=\"text-xs font-semibold text-[#6B7280] uppercase tracking-wider mb-1\">\n              Overall Confidence\n            </div>\n            <div className=\"flex items-center space-x-2\">\n              <div className=\"text-lg font-bold text-[#111827]\">{overallConfidence}%</div>\n              <div\n                className={`w-2 h-2 rounded-full ${\n                  overallConfidence >= CONFIDENCE.THRESHOLD_HIGH * 100\n                    ? 'bg-[#10B981]'\n                    : overallConfidence >= CONFIDENCE.THRESHOLD_MEDIUM * 100\n                      ? 'bg-[#3B82F6]'\n                      : 'bg-[#F59E0B]'\n                }`}\n              />\n            </div>\n          </div>\n          <div className=\"h-12 w-px bg-[#E5E7EB]\" />\n          <div>\n            <div className=\"text-xs font-semibold text-[#6B7280] uppercase tracking-wider mb-1\">\n              Status\n            </div>\n            <div\n              className={`inline-flex items-center px-3 py-1 rounded-md text-sm font-medium ${getStatusColor(status)}`}\n            >\n              {status || 'Processing'}\n            </div>\n          </div>\n        </div>\n        {showActions && (onBack || onContinue) && (\n          <div className=\"flex items-center space-x-3\">\n            {onBack && (\n              <button onClick={onBack} className=\"btn-secondary flex items-center space-x-2\">\n                <ArrowLeft className=\"w-4 h-4\" />\n                <span>Back</span>\n              </button>\n            )}\n            {onContinue && (\n              <button onClick={onContinue} className=\"btn-primary flex items-center space-x-2\">\n                <span>{continueLabel}</span>\n                <ArrowRight className=\"w-4 h-4\" />\n              </button>\n            )}\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1913, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/components/ReviewPage.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useMemo } from 'react'\nimport { motion } from 'framer-motion'\nimport { \n  FileText, \n  Search, \n  BookOpen, \n  CheckCircle,\n  AlertTriangle,\n  ArrowRight,\n  ArrowLeft,\n  Shield,\n  User,\n  Calendar,\n  MapPin,\n  FileCheck,\n  Clock,\n  TrendingUp,\n  ImageIcon,\n  ChevronDown,\n  ChevronUp\n} from 'lucide-react'\nimport ClaimSummaryBar from './ClaimSummaryBar'\nimport { ClaimData, Document, FieldEvidence, PolicyHit } from '@/types/claims'\nimport { CONFIDENCE } from '@/lib/confidence'\n\n/** Render flat KPI key-values (e.g. from damage photos, water leakage images) */\nfunction ImageKpiContent({ keyFields }: { keyFields: Record<string, unknown> }) {\n  const formatLabel = (key: string) =>\n    key.replace(/_/g, ' ').replace(/([A-Z])/g, ' $1').replace(/^./, (s) => s.toUpperCase()).trim()\n  const entries = Object.entries(keyFields).filter(\n    ([k, v]) => !String(k).startsWith('_') && v != null && v !== ''\n  )\n  if (entries.length === 0) return null\n  return (\n    <div className=\"grid gap-x-4 gap-y-2 text-xs\" style={{ gridTemplateColumns: 'auto 1fr' }}>\n      {entries.map(([k, v]) => (\n        <React.Fragment key={k}>\n          <span className=\"font-medium text-[#6B7280]\">{formatLabel(k)}:</span>\n          <span className=\"text-[#374151] break-words\">{String(v)}</span>\n        </React.Fragment>\n      ))}\n    </div>\n  )\n}\n\n/** Render structured keyFields for any document type (Invoice, Police Report, Repair Estimate, etc.) */\nfunction StructuredDocContent({ doc }: { doc: Document }) {\n  const keyFields = doc.keyFields as Record<string, unknown> | undefined\n  if (!keyFields || Object.keys(keyFields).length === 0) return null\n\n  const formatLabel = (key: string) =>\n    key.replace(/_/g, ' ').replace(/([A-Z])/g, ' $1').replace(/^./, (s) => s.toUpperCase()).trim()\n\n  const renderValue = (val: unknown): React.ReactNode => {\n    if (val == null || val === '') return '—'\n    if (typeof val === 'string') return val\n    if (typeof val === 'number') return String(val)\n    if (Array.isArray(val)) {\n      if (val.length === 0) return '—'\n      return (\n        <ul className=\"list-disc list-inside space-y-0.5 mt-1\">\n          {val.map((item, i) => (\n            <li key={i} className=\"text-[#374151]\">\n              {typeof item === 'object' && item !== null && !Array.isArray(item)\n                ? Object.entries(item as Record<string, unknown>).map(([k, v]) => (\n                    <span key={k} className=\"mr-2\">\n                      <span className=\"font-medium text-[#6B7280]\">{formatLabel(k)}:</span>{' '}\n                      {String(v)}\n                    </span>\n                  ))\n                : String(item)}\n            </li>\n          ))}\n        </ul>\n      )\n    }\n    if (typeof val === 'object' && val !== null) {\n      return (\n        <div className=\"mt-1 space-y-1 pl-2 border-l-2 border-[#E5E7EB]\">\n          {Object.entries(val as Record<string, unknown>).map(([k, v]) => (\n            <div key={k} className=\"text-xs\">\n              <span className=\"font-medium text-[#6B7280]\">{formatLabel(k)}:</span>{' '}\n              <span className=\"text-[#374151]\">{renderValue(v)}</span>\n            </div>\n          ))}\n        </div>\n      )\n    }\n    return String(val)\n  }\n\n  const renderSection = (sectionKey: string, sectionVal: unknown) => {\n    const title = formatLabel(sectionKey)\n    if (Array.isArray(sectionVal) && sectionVal.length > 0) {\n      const first = sectionVal[0]\n      const isTable =\n        typeof first === 'object' && first !== null && !Array.isArray(first)\n      if (isTable) {\n        const keys = Object.keys(first as Record<string, unknown>)\n        return (\n          <div key={sectionKey}>\n            <div className=\"text-xs font-semibold text-[#6366F1] uppercase tracking-wider mb-2\">\n              {title}\n            </div>\n            <div className=\"bg-[#F9FAFB] rounded-lg overflow-hidden\">\n              <table className=\"w-full text-xs\">\n                <thead>\n                  <tr className=\"bg-[#EEF2FF]\">\n                    {keys.map((k) => (\n                      <th\n                        key={k}\n                        className=\"px-3 py-2 text-left font-semibold text-[#4F46E5]\"\n                      >\n                        {formatLabel(k)}\n                      </th>\n                    ))}\n                  </tr>\n                </thead>\n                <tbody>\n                  {sectionVal.map((row: unknown, i: number) => (\n                    <tr key={i} className=\"border-t border-[#E5E7EB]\">\n                      {keys.map((k) => (\n                        <td key={k} className=\"px-3 py-2 text-[#374151]\">\n                          {renderValue((row as Record<string, unknown>)[k])}\n                        </td>\n                      ))}\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        )\n      }\n    }\n    return (\n      <div key={sectionKey}>\n        <div className=\"text-xs font-semibold text-[#6366F1] uppercase tracking-wider mb-2\">\n          {title}\n        </div>\n        <div className=\"bg-[#F9FAFB] rounded-lg p-3 text-xs\">\n          {typeof sectionVal === 'object' && sectionVal !== null && !Array.isArray(sectionVal) ? (\n            <div className=\"grid gap-x-4 gap-y-2\" style={{ gridTemplateColumns: 'auto 1fr' }}>\n              {Object.entries(sectionVal as Record<string, unknown>).map(([k, v]) => (\n                <React.Fragment key={k}>\n                  <span className=\"font-medium text-[#6B7280] min-w-0\">\n                    {formatLabel(k)}:\n                  </span>\n                  <span className=\"text-[#374151] break-words\">{renderValue(v)}</span>\n                </React.Fragment>\n              ))}\n            </div>\n          ) : (\n            <span className=\"text-[#374151]\">{renderValue(sectionVal)}</span>\n          )}\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"space-y-4 max-h-[400px] overflow-y-auto\">\n      {Object.entries(keyFields).map(([sectionKey, sectionVal]) =>\n        renderSection(sectionKey, sectionVal)\n      )}\n    </div>\n  )\n}\n\ninterface ReviewPageProps {\n  claimData: ClaimData\n  onNextStage: () => void\n  onPreviousStage: () => void\n  onLoadClaim?: (claimId: string) => void\n}\n\n// Group fields by category\nconst categorizeFields = (evidence: FieldEvidence[]) => {\n  const categories = {\n    'Claim Metadata': ['policyId', 'policyNumber', 'claimId'],\n    'Contact Details': ['claimantName', 'contactEmail', 'contactPhone'],\n    'Incident Details': ['lossDate', 'lossType', 'lossLocation', 'location', 'description', 'deductible', 'estimatedAmount']\n  }\n\n  const grouped: Record<string, FieldEvidence[]> = {\n    'Claim Metadata': [],\n    'Contact Details': [],\n    'Incident Details': []\n  }\n\n  evidence.forEach((field) => {\n    const fieldName = (field.fieldName || field.field || '').toLowerCase()\n    let categorized = false\n\n    for (const [category, fields] of Object.entries(categories)) {\n      if (fields.some(f => fieldName.includes(f.toLowerCase()))) {\n        grouped[category].push(field)\n        categorized = true\n        break\n      }\n    }\n\n    if (!categorized) {\n      grouped['Incident Details'].push(field)\n    }\n  })\n\n  return grouped\n}\n\nconst SUMMARY_PREVIEW_LENGTH = 280\n\nexport default function ReviewPage({ claimData, onNextStage, onPreviousStage, onLoadClaim }: ReviewPageProps) {\n  const [selectedField, setSelectedField] = useState<string | null>(null)\n  const [selectedDoc, setSelectedDoc] = useState<string | null>(null)\n  const [expandedDocId, setExpandedDocId] = useState<string | null>(null)\n  const [expandedPolicyIds, setExpandedPolicyIds] = useState<Set<string>>(new Set())\n\n  // Handle null claimData\n  if (!claimData || !claimData.decisionPack) {\n    return (\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        className=\"max-w-7xl mx-auto text-center py-12\"\n      >\n        <AlertTriangle className=\"w-16 h-16 text-warning-500 mx-auto mb-4\" />\n        <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">No Claim Data Available</h2>\n        <p className=\"text-gray-600 mb-6\">\n          Please process a claim first before reviewing.\n        </p>\n        <button\n          onClick={onPreviousStage}\n          className=\"btn-primary flex items-center space-x-2 mx-auto\"\n        >\n          <ArrowLeft className=\"w-4 h-4\" />\n          <span>Back to Ingest</span>\n        </button>\n      </motion.div>\n    )\n  }\n\n  const { decisionPack, claimId, status, ingestedClaimId } = claimData\n  const { \n    evidence = [], \n    documents = [], \n    policyGrounding = [],\n    claimDraft\n  } = decisionPack || {}\n\n  // Calculate overall confidence\n  const overallConfidence = useMemo(() => {\n    if (evidence.length === 0) return 0\n    const avg = evidence.reduce((sum, e) => sum + e.confidence, 0) / evidence.length\n    return Math.round(avg * 100)\n  }, [evidence])\n\n  // Group fields by category\n  const groupedFields = useMemo(() => categorizeFields(evidence), [evidence])\n\n  // Policy grounding state\n  const policyState = useMemo(() => {\n    if (policyGrounding.length === 0) {\n      return { type: 'warning', message: 'No policy clauses found', subMessage: 'Proceeding without policy grounding' }\n    }\n    const avgScore = policyGrounding.reduce((sum, p) => sum + (p.score || p.similarity || 0), 0) / policyGrounding.length\n    if (avgScore >= 0.7) {\n      return { type: 'success', message: `${policyGrounding.length} policy matches found`, subMessage: `${Math.round(avgScore * 100)}% average similarity` }\n    }\n    return { type: 'neutral', message: `${policyGrounding.length} policy matches`, subMessage: 'Review recommended' }\n  }, [policyGrounding])\n\n  const getConfidenceBadge = (confidence: number) => {\n    if (confidence >= CONFIDENCE.THRESHOLD_HIGH) {\n      return <span className=\"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-[#ECFDF5] text-[#047857] border border-[#A7F3D0]\">High</span>\n    } else if (confidence >= CONFIDENCE.THRESHOLD_MEDIUM) {\n      return <span className=\"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-[#EFF6FF] text-[#1E40AF] border border-[#DBEAFE]\">Medium</span>\n    } else {\n      return <span className=\"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-[#FFFBEB] text-[#B45309] border border-[#FDE68A]\">Review</span>\n    }\n  }\n\n  const getFieldIcon = (fieldName: string) => {\n    const iconMap: Record<string, any> = {\n      policyId: Shield,\n      policyNumber: Shield,\n      claimantName: User,\n      contactEmail: FileText,\n      contactPhone: FileText,\n      lossDate: Calendar,\n      lossType: FileCheck,\n      lossLocation: MapPin,\n      location: MapPin,\n      description: FileText,\n      deductible: TrendingUp\n    }\n    \n    const field = (fieldName || '').toLowerCase()\n    for (const [key, Icon] of Object.entries(iconMap)) {\n      if (field.includes(key.toLowerCase())) {\n        return Icon\n      }\n    }\n    return FileText\n  }\n\n  const getStatusColor = (status?: string) => {\n    if (!status) return 'bg-[#E5E7EB] text-[#374151]'\n    const s = status.toLowerCase()\n    if (s.includes('complete') || s.includes('approved')) return 'bg-[#ECFDF5] text-[#047857]'\n    if (s.includes('pending') || s.includes('processing')) return 'bg-[#EFF6FF] text-[#1E40AF]'\n    if (s.includes('reject') || s.includes('error')) return 'bg-[#FEF2F2] text-[#B91C1C]'\n    return 'bg-[#FFFBEB] text-[#B45309]'\n  }\n\n  return (\n    <div className=\"max-w-[1920px] mx-auto\">\n      <ClaimSummaryBar\n        claimData={claimData}\n        onBack={onPreviousStage}\n        onContinue={onNextStage}\n        continueLabel=\"Continue\"\n        showClaimDropdown\n        onClaimSelect={onLoadClaim}\n      />\n\n      {/* Main Content - Three Column Layout */}\n      <div className=\"px-8 py-8\">\n        <div className=\"grid grid-cols-12 gap-6\">\n          {/* Left Column - Source Documents (Compact) */}\n          <div className=\"col-span-12 lg:col-span-3\">\n            <motion.div \n              className=\"card p-5 h-fit sticky top-[88px]\"\n              initial={{ opacity: 0, x: -20 }}\n              animate={{ opacity: 1, x: 0 }}\n            >\n              <div className=\"flex items-center space-x-2 mb-4\">\n                <FileText className=\"w-4 h-4 text-[#6366F1]\" />\n                <h2 className=\"text-sm font-bold text-[#111827] uppercase tracking-wider\">Source Documents</h2>\n                <span className=\"ml-auto text-xs font-medium text-[#6B7280] bg-[#F3F4F6] px-2 py-0.5 rounded\">\n                  {documents.length}\n                </span>\n              </div>\n              \n              <div className=\"space-y-2\">\n                {documents.map((doc) => {\n                  const isSelected = selectedDoc === doc.id\n                  const isImageDoc =\n                    doc.type === 'DamagePhoto' || doc.mimeType?.startsWith('image/')\n                  const imageUrl =\n                    isImageDoc &&\n                    ingestedClaimId &&\n                    `/api/ingested-claims/${ingestedClaimId}/attachments?name=${encodeURIComponent(doc.name)}`\n\n                  return (\n                    <div\n                      key={doc.id}\n                      className={`rounded-lg border cursor-pointer transition-all overflow-hidden ${\n                        isSelected\n                          ? 'border-[#6366F1] bg-[#EEF2FF] shadow-sm'\n                          : 'border-[#E5E7EB] hover:border-[#CBD5E1] hover:bg-[#F9FAFB] bg-white'\n                      }`}\n                      onClick={() => setSelectedDoc(isSelected ? null : doc.id)}\n                    >\n                      <div className=\"p-3\">\n                        <div className=\"flex items-start justify-between mb-2\">\n                          <div className=\"flex items-center space-x-2 flex-1 min-w-0\">\n                            {isImageDoc ? (\n                              <ImageIcon className=\"w-4 h-4 text-[#6366F1] flex-shrink-0\" />\n                            ) : (\n                              <FileText className=\"w-4 h-4 text-[#6B7280] flex-shrink-0\" />\n                            )}\n                            <span className=\"text-xs font-semibold text-[#111827] truncate\">\n                              {doc.name}\n                            </span>\n                          </div>\n                          <span className=\"text-xs font-medium text-[#6B7280] bg-[#F3F4F6] px-1.5 py-0.5 rounded ml-2 flex-shrink-0\">\n                            {doc.type}\n                          </span>\n                        </div>\n                        <div className=\"flex items-center justify-between\">\n                          <div className=\"flex items-center space-x-1\">\n                            <div\n                              className={`w-1.5 h-1.5 rounded-full ${\n                                doc.confidence >= CONFIDENCE.THRESHOLD_HIGH\n                                  ? 'bg-[#10B981]'\n                                  : doc.confidence >= CONFIDENCE.THRESHOLD_MEDIUM\n                                    ? 'bg-[#3B82F6]'\n                                    : 'bg-[#F59E0B]'\n                              }`}\n                            />\n                            <span className=\"text-xs text-[#6B7280]\">\n                              {Math.round(doc.confidence * 100)}%\n                            </span>\n                          </div>\n                        </div>\n                      </div>\n                      {/* Image preview + extracted KPIs for image documents */}\n                      {isImageDoc && isSelected && (\n                        <div className=\"border-t border-[#E5E7EB] bg-white/80 p-3 space-y-3\">\n                          {imageUrl && (\n                            <div className=\"rounded-lg overflow-hidden bg-[#F3F4F6] aspect-video flex items-center justify-center\">\n                              {/* eslint-disable-next-line @next/next/no-img-element */}\n                              <img\n                                src={imageUrl}\n                                alt={doc.name}\n                                className=\"max-w-full max-h-40 object-contain\"\n                                onError={(e) => {\n                                  e.currentTarget.style.display = 'none'\n                                }}\n                              />\n                            </div>\n                          )}\n                          {doc.keyFields &&\n                          Object.keys(doc.keyFields as object).length > 0 ? (\n                            <>\n                              <div className=\"text-xs font-semibold text-[#6B7280] uppercase tracking-wider mb-2\">\n                                Extracted KPIs\n                              </div>\n                              <ImageKpiContent keyFields={doc.keyFields as Record<string, unknown>} />\n                            </>\n                          ) : doc.content ? (\n                            <div>\n                              <div className=\"text-xs font-semibold text-[#6B7280] uppercase tracking-wider mb-1\">\n                                Note\n                              </div>\n                              <p className=\"text-xs text-[#374151] leading-relaxed\">\n                                {doc.content}\n                              </p>\n                            </div>\n                          ) : null}\n                        </div>\n                      )}\n                      {/* Text document content when selected */}\n                      {!isImageDoc && isSelected && (\n                        <div className=\"border-t border-[#E5E7EB] bg-white/80 p-3\">\n                          {doc.keyFields &&\n                          Object.keys(doc.keyFields as object).length > 0 ? (\n                            <>\n                              <div className=\"text-xs font-semibold text-[#6B7280] uppercase tracking-wider mb-2\">\n                                Structured Content\n                              </div>\n                              <StructuredDocContent doc={doc} />\n                            </>\n                          ) : doc.content ? (\n                            <>\n                              <div className=\"text-xs font-semibold text-[#6B7280] uppercase tracking-wider mb-1\">\n                                Content\n                              </div>\n                              <p className=\"text-xs text-[#374151] leading-relaxed\">\n                                {expandedDocId === doc.id\n                                  ? doc.content\n                                  : doc.content.length > SUMMARY_PREVIEW_LENGTH\n                                    ? `${doc.content.slice(0, SUMMARY_PREVIEW_LENGTH).trim()}...`\n                                    : doc.content}\n                              </p>\n                              {doc.content.length > SUMMARY_PREVIEW_LENGTH && (\n                                <button\n                                  type=\"button\"\n                                  onClick={(e) => {\n                                    e.stopPropagation()\n                                    setExpandedDocId(expandedDocId === doc.id ? null : doc.id)\n                                  }}\n                                  className=\"mt-1 text-xs font-medium text-[#6366F1] hover:text-[#4F46E5] hover:underline\"\n                                >\n                                  {expandedDocId === doc.id ? 'View less' : 'View more'}\n                                </button>\n                              )}\n                            </>\n                          ) : (\n                            <p className=\"text-xs text-[#6B7280] italic\">No structured content extracted</p>\n                          )}\n                        </div>\n                      )}\n                    </div>\n                  )\n                })}\n              </div>\n            </motion.div>\n          </div>\n\n          {/* Center Column - Extracted Fields (Dominant) */}\n          <div className=\"col-span-12 lg:col-span-6\">\n            <motion.div \n              className=\"card p-6\"\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n            >\n              <div className=\"flex items-center space-x-2 mb-6\">\n                <Search className=\"w-5 h-5 text-[#6366F1]\" />\n                <h2 className=\"text-base font-bold text-[#111827] uppercase tracking-wider\">Extracted Fields</h2>\n                <span className=\"ml-auto text-xs font-medium text-[#6B7280] bg-[#F3F4F6] px-2 py-0.5 rounded\">\n                  {evidence.length} fields\n                </span>\n              </div>\n\n              {/* Grouped Fields by Category */}\n              <div className=\"space-y-6\">\n                {Object.entries(groupedFields).map(([category, fields]) => {\n                  if (fields.length === 0) return null\n                  \n                  return (\n                    <div key={category} className=\"border-b border-[#E5E7EB] pb-6 last:border-0 last:pb-0\">\n                      <h3 className=\"text-xs font-semibold text-[#6B7280] uppercase tracking-wider mb-4\">\n                        {category}\n                      </h3>\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n                        {fields.map((field) => {\n                          const fieldName = field.fieldName || field.field || ''\n                          const fieldKey = (fieldName || (field.field || '')).toLowerCase().replace(/\\s/g, '')\n                          const isLongField = ['description', 'losslocation', 'location', 'details'].includes(fieldKey)\n                          const Icon = getFieldIcon(fieldName)\n                          const isSelected = selectedField === fieldName\n\n                          return (\n                            <div\n                              key={fieldName}\n                              className={`p-4 rounded-lg border transition-all cursor-pointer ${\n                                isLongField ? 'md:col-span-2' : ''\n                              } ${\n                                isSelected\n                                  ? 'border-[#6366F1] bg-[#EEF2FF] shadow-sm'\n                                  : 'border-[#E5E7EB] hover:border-[#CBD5E1] hover:bg-[#F9FAFB] bg-white'\n                              }`}\n                              onClick={() => setSelectedField(isSelected ? null : fieldName)}\n                            >\n                              <div className=\"flex items-start justify-between mb-2\">\n                                <div className=\"flex items-center space-x-2 flex-1 min-w-0\">\n                                  <Icon className=\"w-4 h-4 text-[#6B7280] flex-shrink-0\" />\n                                  <span className=\"text-sm font-medium text-[#111827] capitalize truncate\">\n                                    {fieldName.replace(/([A-Z])/g, ' $1').trim()}\n                                  </span>\n                                </div>\n                                {getConfidenceBadge(field.confidence)}\n                              </div>\n                              \n                              <div\n                                className={`text-sm text-[#374151] font-medium mb-1 break-words ${\n                                  isLongField ? 'line-clamp-6' : 'truncate'\n                                }`}\n                                title={String(field.value)}\n                              >\n                                {String(field.value)}\n                              </div>\n                              \n                              {isSelected && (\n                                <motion.div\n                                  initial={{ opacity: 0, height: 0 }}\n                                  animate={{ opacity: 1, height: 'auto' }}\n                                  className=\"mt-3 pt-3 border-t border-[#E5E7EB]\"\n                                >\n                                  <div className=\"text-xs text-[#6B7280] space-y-1\">\n                                    <div>\n                                      <span className=\"font-medium\">Source:</span>{' '}\n                                      {typeof field.sourceLocator === 'string' \n                                        ? field.sourceLocator \n                                        : field.sourceLocator.docId}\n                                    </div>\n                                    <div>\n                                      <span className=\"font-medium\">Rationale:</span> {field.rationale}\n                                    </div>\n                                  </div>\n                                </motion.div>\n                              )}\n                            </div>\n                          )\n                        })}\n                      </div>\n                    </div>\n                  )\n                })}\n              </div>\n            </motion.div>\n          </div>\n\n          {/* Right Column - Policy Grounding (Narrow) */}\n          <div className=\"col-span-12 lg:col-span-3\">\n            <motion.div \n              className=\"card p-5 h-fit sticky top-[88px]\"\n              initial={{ opacity: 0, x: 20 }}\n              animate={{ opacity: 1, x: 0 }}\n            >\n              <div className=\"flex items-center space-x-2 mb-4\">\n                <BookOpen className=\"w-4 h-4 text-[#6366F1]\" />\n                <h2 className=\"text-sm font-bold text-[#111827] uppercase tracking-wider\">Policy Grounding</h2>\n              </div>\n\n              {/* State-based Policy Card */}\n              <div className={`p-4 rounded-lg border-2 ${\n                policyState.type === 'success' \n                  ? 'border-[#10B981] bg-[#ECFDF5]' \n                  : policyState.type === 'warning'\n                  ? 'border-[#F59E0B] bg-[#FFFBEB]'\n                  : 'border-[#E5E7EB] bg-[#F9FAFB]'\n              }`}>\n                <div className=\"flex items-start space-x-3\">\n                  {policyState.type === 'success' ? (\n                    <CheckCircle className=\"w-5 h-5 text-[#10B981] flex-shrink-0 mt-0.5\" />\n                  ) : policyState.type === 'warning' ? (\n                    <AlertTriangle className=\"w-5 h-5 text-[#F59E0B] flex-shrink-0 mt-0.5\" />\n                  ) : (\n                    <Shield className=\"w-5 h-5 text-[#6B7280] flex-shrink-0 mt-0.5\" />\n                  )}\n                  <div className=\"flex-1 min-w-0\">\n                    <div className={`text-sm font-semibold mb-1 ${\n                      policyState.type === 'success' \n                        ? 'text-[#047857]' \n                        : policyState.type === 'warning'\n                        ? 'text-[#B45309]'\n                        : 'text-[#374151]'\n                    }`}>\n                      {policyState.message}\n                    </div>\n                    <div className={`text-xs ${\n                      policyState.type === 'success' \n                        ? 'text-[#065F46]' \n                        : policyState.type === 'warning'\n                        ? 'text-[#92400E]'\n                        : 'text-[#6B7280]'\n                    }`}>\n                      {policyState.subMessage}\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Policy Matches List – expandable */}\n              {policyGrounding.length > 0 && (\n                <div className=\"mt-4 space-y-2\">\n                  <div className=\"text-xs font-semibold text-[#6B7280] uppercase tracking-wider mb-2\">\n                    Matches ({policyGrounding.length})\n                  </div>\n                  {policyGrounding.map((policy) => {\n                    const isExpanded = expandedPolicyIds.has(policy.clauseId)\n                    const fullContent = policy.content || policy.snippet || ''\n                    const toggle = () => {\n                      setExpandedPolicyIds((prev) => {\n                        const next = new Set(prev)\n                        if (next.has(policy.clauseId)) next.delete(policy.clauseId)\n                        else next.add(policy.clauseId)\n                        return next\n                      })\n                    }\n                    return (\n                      <div\n                        key={policy.clauseId}\n                        className=\"rounded-lg border border-[#E5E7EB] bg-white hover:border-[#CBD5E1] overflow-hidden\"\n                      >\n                        <button\n                          type=\"button\"\n                          onClick={toggle}\n                          className=\"w-full p-3 text-left hover:bg-[#F9FAFB] transition-colors focus:outline-none focus:ring-2 focus:ring-[#6366F1]/20 focus:ring-inset\"\n                        >\n                          <div className=\"flex items-start justify-between gap-2\">\n                            <div className=\"min-w-0 flex-1\">\n                              <div className=\"flex items-center gap-2 mb-1\">\n                                <span className=\"text-xs font-semibold text-[#111827]\">{policy.clauseId}</span>\n                                <span className=\"text-xs font-medium text-[#10B981] bg-[#ECFDF5] px-1.5 py-0.5 rounded flex-shrink-0\">\n                                  {Math.round((policy.score || policy.similarity || 0) * 100)}%\n                                </span>\n                                {policy.sourceRef && (\n                                  <span className=\"text-[10px] text-[#9CA3AF]\">{policy.sourceRef}</span>\n                                )}\n                              </div>\n                              <div className=\"text-xs text-[#374151] font-medium mb-0.5\">\n                                {policy.title}\n                              </div>\n                              {policy.section && (\n                                <div className=\"text-[11px] text-[#6366F1] mb-1\">\n                                  {policy.section}\n                                </div>\n                              )}\n                              <div className={`text-xs text-[#6B7280] ${!isExpanded ? 'line-clamp-2' : 'line-clamp-1'}`}>\n                                {policy.snippet || fullContent.slice(0, 140) + (fullContent.length > 140 ? '...' : '')}\n                              </div>\n                              <span className=\"text-[10px] text-[#6366F1] font-medium mt-1 block\">\n                                {isExpanded ? 'Click to collapse' : 'Click to read full clause'}\n                              </span>\n                            </div>\n                            <span className=\"flex-shrink-0 text-[#9CA3AF]\" aria-hidden>\n                              {isExpanded ? <ChevronUp className=\"w-4 h-4\" /> : <ChevronDown className=\"w-4 h-4\" />}\n                            </span>\n                          </div>\n                        </button>\n                        {isExpanded && fullContent && (\n                          <div className=\"px-3 pb-3 pt-0 border-t border-[#F3F4F6] bg-[#FAFAFA]\">\n                            <div className=\"text-xs text-[#4B5563] leading-relaxed whitespace-pre-wrap\">\n                              {fullContent}\n                            </div>\n                            <p className=\"text-[10px] text-[#9CA3AF] mt-2 italic\">{policy.rationale}</p>\n                          </div>\n                        )}\n                      </div>\n                    )\n                  })}\n                </div>\n              )}\n            </motion.div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3303, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/components/DecisionPage.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { motion } from 'framer-motion'\nimport { \n  CheckCircle, \n  FileText, \n  Send, \n  Download, \n  Clock,\n  ArrowRight,\n  ArrowLeft,\n  AlertTriangle,\n  Check,\n  X,\n  ChevronDown,\n  ChevronUp,\n  Mail\n} from 'lucide-react'\nimport ClaimSummaryBar from './ClaimSummaryBar'\nimport { ClaimData } from '@/types/claims'\nimport { CONFIDENCE } from '@/lib/confidence'\n\ninterface DecisionPageProps {\n  claimData: ClaimData\n  onNextStage: () => void\n  onPreviousStage: () => void\n  onLoadClaim?: (claimId: string) => void\n}\n\nexport default function DecisionPage({ claimData, onNextStage, onPreviousStage, onLoadClaim }: DecisionPageProps) {\n  const [isCreatingDraft, setIsCreatingDraft] = useState(false)\n  const [isSendingAck, setIsSendingAck] = useState(false)\n  const [draftCreated, setDraftCreated] = useState(false)\n  const [claimStatus, setClaimStatus] = useState<'pending' | 'accepted' | 'rejected'>('pending')\n  const [ackSent, setAckSent] = useState(false)\n  const [acceptanceSent, setAcceptanceSent] = useState(false)\n  const [denialSent, setDenialSent] = useState(false)\n  const [expandedPolicyIds, setExpandedPolicyIds] = useState<Set<string>>(new Set())\n  const [emailDraftType, setEmailDraftType] = useState<'acceptance' | 'rejection' | 'acknowledgment' | null>(null)\n  const [emailDraftContent, setEmailDraftContent] = useState('')\n  const [emailDraftRecipient, setEmailDraftRecipient] = useState('')\n  const [sendEmailError, setSendEmailError] = useState<string | null>(null)\n  const [downloadError, setDownloadError] = useState<string | null>(null)\n  const [isDownloading, setIsDownloading] = useState(false)\n  const [draftError, setDraftError] = useState<string | null>(null)\n  const [createdDraft, setCreatedDraft] = useState<{\n    draftId: string\n    claimId: string\n    claimFields: Record<string, unknown>\n    attachments: Array<{ name: string; type?: string }>\n    policyClauses: Array<{ clauseId: string; title: string; score?: number }>\n    recommendedActions: string[]\n  } | null>(null)\n\n  useEffect(() => {\n    setClaimStatus('pending')\n  }, [claimData?.claimId])\n\n  // Handle null claimData\n  if (!claimData || !claimData.decisionPack) {\n    return (\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        className=\"max-w-7xl mx-auto text-center py-12\"\n      >\n        <AlertTriangle className=\"w-16 h-16 text-warning-500 mx-auto mb-4\" />\n        <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">No Claim Data Available</h2>\n        <p className=\"text-gray-600 mb-6\">\n          Please process a claim first before making decisions.\n        </p>\n        <button\n          onClick={onPreviousStage}\n          className=\"btn-primary flex items-center space-x-2 mx-auto\"\n        >\n          <ArrowLeft className=\"w-4 h-4\" />\n          <span>Back to Review</span>\n        </button>\n      </motion.div>\n    )\n  }\n\n  const { decisionPack, processingTime } = claimData\n  const { \n    claimDraft, \n    evidence = [], \n    documents = [], \n    policyGrounding = [], \n    audit = [] \n  } = decisionPack || {}\n\n  const handleCreateDraft = async () => {\n    setIsCreatingDraft(true)\n    setDraftError(null)\n    try {\n      const res = await fetch('/api/drafts', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(claimData),\n      })\n      const data = await res.json()\n      if (!res.ok) {\n        throw new Error(data.error || 'Failed to create draft')\n      }\n      setDraftCreated(true)\n      if (data.draft) setCreatedDraft(data.draft)\n    } catch (err) {\n      setDraftError(err instanceof Error ? err.message : 'Failed to create draft')\n    } finally {\n      setIsCreatingDraft(false)\n    }\n  }\n\n\n  const generateAcknowledgment = () => {\n    const draft = claimDraft || {}\n    const claimantName = draft.claimantName || 'Valued Policyholder'\n    const policyRef = draft.policyNumber || draft.policyId || 'on file'\n    const claimNumber = claimData.claimId || 'Pending'\n    const lossDate = draft.lossDate || 'the reported date'\n    const lossType = draft.lossType || 'the reported incident'\n    const lossLocation = draft.lossLocation || draft.location || draft.propertyAddress || ''\n    const description = draft.description ? (draft.description.length > 200 ? `${draft.description.slice(0, 200)}...` : draft.description) : ''\n    const estimatedAmount = draft.estimatedAmount\n    const deductible = draft.deductible\n    const docCount = documents?.length || 0\n    const docList = documents?.length ? documents.map((d) => d.name || d.type).filter(Boolean).slice(0, 5).join(', ') + (documents.length > 5 ? ' and others' : '') : ''\n    const hasCoverageMatch = policyGrounding.length > 0\n    const policyAssessment = decisionPack?.policyAssessment\n\n    const today = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })\n\n    let letter = `${today}\\n\\n`\n    letter += `Dear ${claimantName},\\n\\n`\n    letter += `RE: First Notice of Loss – Claim Number ${claimNumber}\\n`\n    letter += `Policy Reference: ${policyRef}\\n\\n`\n    letter += `Thank you for submitting your First Notice of Loss. We have received and logged your claim as of today's date.\\n\\n`\n    letter += `CLAIM SUMMARY\\n`\n    letter += `  • Incident Date: ${lossDate}\\n`\n    letter += `  • Loss Type: ${lossType}\\n`\n    if (lossLocation) letter += `  • Location: ${lossLocation}\\n`\n    if (description) letter += `  • Description: ${description}\\n`\n    if (estimatedAmount != null) letter += `  • Estimated Amount: $${Number(estimatedAmount).toLocaleString()}\\n`\n    if (deductible != null) letter += `  • Applicable Deductible: $${Number(deductible).toLocaleString()}\\n`\n    letter += `\\n`\n    letter += `DOCUMENTS RECEIVED\\n`\n    if (docCount > 0) {\n      letter += `  We have received ${docCount} document(s) in support of your claim${docList ? `: ${docList}` : '.'}\\n\\n`\n    } else {\n      letter += `  Supporting documents may be submitted at your earliest convenience.\\n\\n`\n    }\n    letter += `COVERAGE ASSESSMENT\\n`\n    if (hasCoverageMatch && policyAssessment?.coverageConfirmed) {\n      letter += `  Our preliminary review indicates that your policy may provide coverage for this loss, subject to verification. We have identified relevant policy provisions and will complete a full review shortly.\\n\\n`\n    } else {\n      letter += `  We are reviewing your policy to determine applicable coverage. A claims specialist will contact you with our assessment.\\n\\n`\n    }\n    letter += `NEXT STEPS\\n`\n    letter += `  1. A dedicated claims adjuster will be assigned within 24–48 business hours.\\n`\n    letter += `  2. You will receive a follow-up call or email to discuss your claim and any additional information needed.\\n`\n    letter += `  3. For urgent inquiries, please reference Claim Number ${claimNumber} when contacting our Claims Department.\\n\\n`\n    letter += `We are committed to processing your claim efficiently and will keep you informed throughout the process.\\n\\n`\n    letter += `Sincerely,\\n\\n`\n    letter += `Claims Department\\n`\n    letter += `Insurance Claims Team`\n\n    return letter\n  }\n\n  const generateAcceptanceLetter = () => {\n    const draft = claimDraft || {}\n    const claimantName = draft.claimantName || 'Valued Policyholder'\n    const policyRef = draft.policyNumber || draft.policyId || 'on file'\n    const claimNumber = claimData.claimId || 'Pending'\n    const lossDate = draft.lossDate || 'the reported date'\n    const lossType = draft.lossType || 'the reported incident'\n    const estimatedAmount = draft.estimatedAmount\n    const today = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })\n    let letter = `${today}\\n\\n`\n    letter += `Dear ${claimantName},\\n\\n`\n    letter += `RE: Claim Acceptance – Claim Number ${claimNumber}\\n`\n    letter += `Policy Reference: ${policyRef}\\n\\n`\n    letter += `We are pleased to inform you that your claim has been approved.\\n\\n`\n    letter += `CLAIM DETAILS\\n`\n    letter += `  • Incident Date: ${lossDate}\\n`\n    letter += `  • Loss Type: ${lossType}\\n`\n    if (estimatedAmount != null) letter += `  • Approved Amount: $${Number(estimatedAmount).toLocaleString()}\\n`\n    letter += `\\n`\n    letter += `NEXT STEPS\\n`\n    letter += `  1. Payment will be processed within 5–10 business days.\\n`\n    letter += `  2. You will receive a separate confirmation when the payment is issued.\\n`\n    letter += `  3. If you have any questions, please reference Claim Number ${claimNumber} when contacting us.\\n\\n`\n    letter += `Thank you for your patience throughout this process.\\n\\n`\n    letter += `Sincerely,\\n\\n`\n    letter += `Claims Department\\n`\n    letter += `Insurance Claims Team`\n    return letter\n  }\n\n  const generateRejectionLetter = () => {\n    const draft = claimDraft || {}\n    const claimantName = draft.claimantName || 'Valued Policyholder'\n    const policyRef = draft.policyNumber || draft.policyId || 'on file'\n    const claimNumber = claimData.claimId || 'Pending'\n    const lossDate = draft.lossDate || 'the reported date'\n    const lossType = draft.lossType || 'the reported incident'\n    const today = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })\n    let letter = `${today}\\n\\n`\n    letter += `Dear ${claimantName},\\n\\n`\n    letter += `RE: Claim Decision – Claim Number ${claimNumber}\\n`\n    letter += `Policy Reference: ${policyRef}\\n\\n`\n    letter += `Thank you for submitting your claim. After a thorough review of your policy and the circumstances of your loss, we regret to inform you that we are unable to provide coverage for this claim.\\n\\n`\n    letter += `CLAIM REVIEWED\\n`\n    letter += `  • Incident Date: ${lossDate}\\n`\n    letter += `  • Loss Type: ${lossType}\\n`\n    letter += `\\n`\n    letter += `REASON FOR DENIAL\\n`\n    letter += `  Based on the terms and conditions of your policy, this loss does not fall within the scope of covered perils. Our determination is based on the policy provisions applicable to your coverage.\\n\\n`\n    letter += `YOUR OPTIONS\\n`\n    letter += `  1. If you believe this decision was made in error, you may submit an appeal with additional documentation within 30 days.\\n`\n    letter += `  2. For questions regarding your policy coverage, please contact our Customer Service department.\\n`\n    letter += `  3. Reference Claim Number ${claimNumber} in all correspondence.\\n\\n`\n    letter += `We understand this may be disappointing and encourage you to reach out if you have any questions.\\n\\n`\n    letter += `Sincerely,\\n\\n`\n    letter += `Claims Department\\n`\n    letter += `Insurance Claims Team`\n    return letter\n  }\n\n  const handleDraftEmail = (type: 'acceptance' | 'rejection' | 'acknowledgment') => {\n    const content = type === 'acceptance'\n      ? generateAcceptanceLetter()\n      : type === 'rejection'\n        ? generateRejectionLetter()\n        : generateAcknowledgment()\n    const recipient = claimData.sourceEmailFrom || claimDraft?.contactEmail || ''\n    setEmailDraftType(type)\n    setEmailDraftContent(content)\n    setEmailDraftRecipient(recipient)\n  }\n\n  const handleCloseEmailDraft = () => {\n    setEmailDraftType(null)\n    setEmailDraftContent('')\n    setEmailDraftRecipient('')\n    setSendEmailError(null)\n  }\n\n  const handleDownloadDecisionPack = async () => {\n    setIsDownloading(true)\n    setDownloadError(null)\n    try {\n      const res = await fetch('/api/decision-pack/pdf', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ claimData, claimStatus }),\n      })\n      if (!res.ok) {\n        const data = await res.json().catch(() => ({}))\n        throw new Error(data.error || 'Failed to generate PDF')\n      }\n      const blob = await res.blob()\n      const contentDisposition = res.headers.get('Content-Disposition')\n      const match = contentDisposition?.match(/filename=\"([^\"]+)\"/)\n      const filename = match?.[1] || `Decision-Pack-${claimData.claimId || 'claim'}.pdf`\n      const url = URL.createObjectURL(blob)\n      const a = document.createElement('a')\n      a.href = url\n      a.download = filename\n      a.click()\n      URL.revokeObjectURL(url)\n    } catch (err) {\n      setDownloadError(err instanceof Error ? err.message : 'Failed to download PDF')\n    } finally {\n      setIsDownloading(false)\n    }\n  }\n\n  const handleSendFromDraft = async () => {\n    if (!emailDraftType) return\n    const recipient = emailDraftRecipient?.trim()\n    if (!recipient) {\n      setSendEmailError('Please enter a recipient email address.')\n      return\n    }\n    setIsSendingAck(true)\n    setSendEmailError(null)\n    try {\n      const claimNum = claimData.claimId || 'Pending'\n      const subjectMap = {\n        acknowledgment: `Claim Acknowledgment – Claim Number ${claimNum}`,\n        acceptance: `Claim Acceptance – Claim Number ${claimNum}`,\n        rejection: `Claim Decision – Claim Number ${claimNum}`,\n      }\n      const subject = subjectMap[emailDraftType]\n      const res = await fetch('/api/send-email', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          to: recipient,\n          subject,\n          body: emailDraftContent,\n        }),\n      })\n      const data = await res.json()\n      if (!res.ok) {\n        throw new Error(data.error || 'Failed to send email')\n      }\n      if (emailDraftType === 'acknowledgment') setAckSent(true)\n      else if (emailDraftType === 'acceptance') setAcceptanceSent(true)\n      else if (emailDraftType === 'rejection') setDenialSent(true)\n      handleCloseEmailDraft()\n    } catch (err) {\n      setSendEmailError(err instanceof Error ? err.message : 'Failed to send email')\n    } finally {\n      setIsSendingAck(false)\n    }\n  }\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      className=\"max-w-6xl mx-auto\"\n    >\n      <ClaimSummaryBar\n        claimData={claimData}\n        onBack={onPreviousStage}\n        onContinue={onNextStage}\n        continueLabel=\"Continue\"\n        showClaimDropdown\n        onClaimSelect={onLoadClaim}\n      />\n      {/* Header */}\n      <div className=\"text-center mb-12\">\n        <h1 className=\"text-4xl font-bold bg-gradient-to-r from-[#2D3748] via-[#4A5568] to-[#2D3748] bg-clip-text text-transparent mb-4\">\n          Decision & Actions\n        </h1>\n        <p className=\"text-lg text-[#718096] max-w-2xl mx-auto\">\n          Review the assembled claim draft and take action\n        </p>\n      </div>\n\n      <div className=\"grid lg:grid-cols-2 gap-8\">\n        {/* Decision Pack */}\n        <motion.div \n          className=\"card p-6\"\n          initial={{ opacity: 0, x: -20 }}\n          animate={{ opacity: 1, x: 0 }}\n          transition={{ delay: 0.1 }}\n        >\n          <div className=\"flex items-center space-x-3 mb-6\">\n            <div className=\"p-2 bg-gradient-to-br from-sky-100 to-sky-200 rounded-lg\">\n              <CheckCircle className=\"w-5 h-5 text-sky-600\" />\n            </div>\n            <h2 className=\"text-xl font-bold text-[#2D3748]\">Decision Pack</h2>\n          </div>\n          \n          <div className=\"space-y-4\">\n            {/* Claim Summary */}\n            <div className=\"p-5 bg-gradient-to-br from-sky-50 to-sky-100 rounded-xl border-l-4 border-sky-400 shadow-sm\">\n              <h3 className=\"font-semibold text-[#0369A1] mb-3\">Claim Summary</h3>\n              <div className=\"grid grid-cols-2 gap-2 text-sm\">\n                <div className=\"col-span-2\">\n                  <span className=\"font-medium\">Claim Status:</span>{' '}\n                  <span className={`font-semibold ${claimStatus === 'accepted' ? 'text-emerald-600' : claimStatus === 'rejected' ? 'text-rose-600' : 'text-[#64748B]'}`}>\n                    {claimStatus === 'accepted' ? 'Accepted' : claimStatus === 'rejected' ? 'Rejected' : 'Pending'}\n                  </span>\n                </div>\n                <div><span className=\"font-medium\">Policy:</span> {claimDraft.policyNumber || claimDraft.policyId || '—'}</div>\n                <div><span className=\"font-medium\">Claimant:</span> {claimDraft.claimantName || '—'}</div>\n                <div><span className=\"font-medium\">Loss Date:</span> {claimDraft.lossDate || '—'}</div>\n                <div><span className=\"font-medium\">Type:</span> {claimDraft.lossType || '—'}</div>\n                <div><span className=\"font-medium\">Location:</span> {claimDraft.lossLocation || claimDraft.location || claimDraft.propertyAddress || '—'}</div>\n                {claimDraft.deductible && (\n                  <div><span className=\"font-medium\">Deductible:</span> ${claimDraft.deductible}</div>\n                )}\n              </div>\n            </div>\n\n            {/* Evidence Summary */}\n            <div className=\"p-5 bg-gradient-to-br from-[#ECFDF5] to-[#D1FAE5] rounded-xl border-l-4 border-[#22C55E] shadow-sm\">\n              <h3 className=\"font-semibold text-[#047857] mb-3\">Evidence Summary</h3>\n              <div className=\"text-sm text-[#065F46]\">\n                <div className=\"mb-2\">\n                  <span className=\"font-medium\">Documents:</span> {documents.length} attached\n                </div>\n                <div className=\"mb-2\">\n                  <span className=\"font-medium\">Fields Extracted:</span> {evidence.length} total\n                </div>\n                <div>\n                  <span className=\"font-medium\">High Confidence:</span> {evidence.filter(e => e.confidence >= CONFIDENCE.THRESHOLD_HIGH).length} fields\n                </div>\n              </div>\n            </div>\n\n            {/* Policy Grounding – expandable clauses */}\n            {policyGrounding.length > 0 && (\n              <div className=\"p-5 bg-gradient-to-br from-sky-50 to-sky-100 rounded-xl border-l-4 border-sky-400 shadow-sm\">\n                <h3 className=\"font-semibold text-[#0369A1] mb-3\">Policy Grounding</h3>\n                <div className=\"text-sm text-[#075985] mb-3\">\n                  <div className=\"mb-1\">\n                    <span className=\"font-medium\">Clauses Found:</span> {policyGrounding.length}\n                  </div>\n                  <div>\n                    <span className=\"font-medium\">Coverage:</span> {claimDraft.coverageFound ? 'Confirmed' : 'Under Review'}\n                  </div>\n                </div>\n                <div className=\"space-y-2\">\n                  {policyGrounding.map((policy) => {\n                    const isExpanded = expandedPolicyIds.has(policy.clauseId)\n                    const fullContent = policy.content || policy.snippet || ''\n                    const toggle = () => {\n                      setExpandedPolicyIds((prev) => {\n                        const next = new Set(prev)\n                        if (next.has(policy.clauseId)) next.delete(policy.clauseId)\n                        else next.add(policy.clauseId)\n                        return next\n                      })\n                    }\n                    return (\n                      <div key={policy.clauseId} className=\"rounded-lg border border-sky-200 bg-white overflow-hidden\">\n                        <button\n                          type=\"button\"\n                          onClick={toggle}\n                          className=\"w-full p-3 text-left hover:bg-sky-50/50 transition-colors focus:outline-none focus:ring-2 focus:ring-sky-200\"\n                        >\n                          <div className=\"flex items-start justify-between gap-2\">\n                            <div className=\"min-w-0 flex-1\">\n                              <div className=\"flex items-center gap-2 mb-0.5\">\n                                <span className=\"text-xs font-semibold text-[#0C4A6E]\">{policy.clauseId}</span>\n                                <span className=\"text-xs font-medium text-[#047857] bg-[#ECFDF5] px-1.5 py-0.5 rounded\">\n                                  {Math.round((policy.score || policy.similarity || 0) * 100)}%\n                                </span>\n                              </div>\n                              <div className=\"text-xs text-[#0C4A6E] font-medium line-clamp-1\">\n                                {policy.title}\n                              </div>\n                              <div className=\"text-[11px] text-[#0369A1] line-clamp-1 mt-0.5\">\n                                {policy.snippet || fullContent.slice(0, 100) + '...'}\n                              </div>\n                            </div>\n                            <span className=\"flex-shrink-0 text-sky-400\">\n                              {isExpanded ? <ChevronUp className=\"w-4 h-4\" /> : <ChevronDown className=\"w-4 h-4\" />}\n                            </span>\n                          </div>\n                        </button>\n                        {isExpanded && fullContent && (\n                          <div className=\"px-3 pb-3 pt-0 border-t border-sky-100 bg-sky-50/30\">\n                            <div className=\"text-xs text-[#0C4A6E] leading-relaxed whitespace-pre-wrap\">\n                              {fullContent}\n                            </div>\n                            {policy.rationale && (\n                              <p className=\"text-[10px] text-sky-600 mt-2 italic\">{policy.rationale}</p>\n                            )}\n                          </div>\n                        )}\n                      </div>\n                    )\n                  })}\n                </div>\n              </div>\n            )}\n          </div>\n        </motion.div>\n\n        {/* Actions */}\n        <motion.div \n          className=\"card p-6\"\n          initial={{ opacity: 0, x: 20 }}\n          animate={{ opacity: 1, x: 0 }}\n          transition={{ delay: 0.2 }}\n        >\n          <div className=\"flex items-center space-x-3 mb-6\">\n            <div className=\"p-2 bg-gradient-to-br from-sky-100 to-sky-200 rounded-lg\">\n              <FileText className=\"w-5 h-5 text-sky-600\" />\n            </div>\n            <h2 className=\"text-xl font-bold text-[#2D3748]\">Actions</h2>\n          </div>\n\n          {/* Accept / Reject Claim – primary actions */}\n          <div className=\"flex gap-3 mb-6\">\n            <button\n              type=\"button\"\n              onClick={() => {\n                setClaimStatus('accepted')\n                handleDraftEmail('acceptance')\n              }}\n              className=\"flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-xl font-medium text-emerald-700 bg-emerald-50 border-2 border-emerald-300 hover:bg-emerald-100 hover:border-emerald-400 transition-colors\"\n            >\n              <Check className=\"w-5 h-5\" />\n              Accept Claim\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => {\n                setClaimStatus('rejected')\n                handleDraftEmail('rejection')\n              }}\n              className=\"flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-xl font-medium text-rose-700 bg-rose-50 border-2 border-rose-300 hover:bg-rose-100 hover:border-rose-400 transition-colors\"\n            >\n              <X className=\"w-5 h-5\" />\n              Reject Claim\n            </button>\n          </div>\n          \n          <div className=\"space-y-4\">\n            {/* Create Draft in Core */}\n            <div className=\"p-5 border-2 border-cloud-200 rounded-xl bg-white hover:shadow-md transition-shadow\">\n              <h3 className=\"font-semibold text-[#2D3748] mb-2\">Create Draft in Core System</h3>\n              <p className=\"text-sm text-[#718096] mb-4\">\n                Creates a draft with all extracted details (policy, claimant, loss info, evidence, policy clauses) in the core system\n              </p>\n              \n              {draftError && (\n                <div className=\"mb-3 p-3 rounded-lg bg-red-50 border border-red-200 text-sm text-red-700 flex items-center gap-2\">\n                  <AlertTriangle className=\"w-4 h-4 flex-shrink-0\" />\n                  {draftError}\n                </div>\n              )}\n              {!draftCreated ? (\n                <button\n                  onClick={handleCreateDraft}\n                  disabled={isCreatingDraft}\n                  className=\"btn-primary w-full disabled:opacity-50\"\n                >\n                  {isCreatingDraft ? (\n                    <div className=\"flex items-center justify-center space-x-2\">\n                      <Clock className=\"w-4 h-4 animate-spin\" />\n                      <span>Creating Draft...</span>\n                    </div>\n                  ) : (\n                    <span>Create Draft in Core</span>\n                  )}\n                </button>\n              ) : (\n                <>\n                  <div className=\"flex items-center space-x-2 text-[#047857] mb-4\">\n                    <Check className=\"w-5 h-5\" />\n                    <span className=\"font-medium\">Draft created with extracted details (Claim ID: {claimData.claimId})</span>\n                  </div>\n                  {createdDraft && (\n                    <div className=\"mt-4 p-4 rounded-lg bg-[#F0FDF4] border border-[#BBF7D0]\">\n                      <h4 className=\"text-sm font-semibold text-[#166534] mb-3\">Created Draft Details</h4>\n                      <div className=\"space-y-3 text-sm\">\n                        <div className=\"grid grid-cols-2 gap-x-4 gap-y-2\">\n                          {createdDraft.claimFields && Object.entries(createdDraft.claimFields)\n                            .filter(([, v]) => v != null && v !== '')\n                            .map(([k, v]) => (\n                              <div key={k} className=\"flex gap-2\">\n                                <span className=\"text-[#6B7280] font-medium capitalize\">{k.replace(/([A-Z])/g, ' $1').trim()}:</span>\n                                <span className=\"text-[#374151] break-words\">{typeof v === 'object' ? JSON.stringify(v) : String(v)}</span>\n                              </div>\n                            ))}\n                        </div>\n                        {createdDraft.attachments?.length > 0 && (\n                          <div>\n                            <span className=\"text-[#6B7280] font-medium\">Attachments:</span>\n                            <ul className=\"mt-1 text-[#374151] list-disc list-inside\">\n                              {createdDraft.attachments.map((a, i) => (\n                                <li key={i}>{a.name} {a.type && <span className=\"text-[#9CA3AF]\">({a.type})</span>}</li>\n                              ))}\n                            </ul>\n                          </div>\n                        )}\n                        {createdDraft.policyClauses?.length > 0 && (\n                          <div>\n                            <span className=\"text-[#6B7280] font-medium\">Policy Clauses:</span>\n                            <ul className=\"mt-1 text-[#374151] space-y-1\">\n                              {createdDraft.policyClauses.map((p, i) => (\n                                <li key={i} className=\"flex justify-between gap-2\">\n                                  <span>{p.clauseId} – {p.title}</span>\n                                  {p.score != null && <span className=\"text-[#9CA3AF]\">{Math.round(p.score * 100)}%</span>}\n                                </li>\n                              ))}\n                            </ul>\n                          </div>\n                        )}\n                        {createdDraft.recommendedActions?.length > 0 && (\n                          <div>\n                            <span className=\"text-[#6B7280] font-medium\">Recommended Actions:</span>\n                            <ul className=\"mt-1 text-[#374151] list-disc list-inside\">\n                              {createdDraft.recommendedActions.map((a, i) => <li key={i}>{a}</li>)}\n                            </ul>\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  )}\n                </>\n              )}\n            </div>\n\n            {/* Send Acknowledgment */}\n            <div className=\"p-5 border-2 border-cloud-200 rounded-xl bg-white hover:shadow-md transition-shadow\">\n              <h3 className=\"font-semibold text-[#2D3748] mb-2\">Send Customer Acknowledgment</h3>\n              <p className=\"text-sm text-[#718096] mb-4\">\n                Generate and send a personalized acknowledgment email to the claimant\n              </p>\n              \n              {!ackSent ? (\n                <button\n                  onClick={() => handleDraftEmail('acknowledgment')}\n                  className=\"btn-secondary w-full\"\n                >\n                  Draft Acknowledgement\n                </button>\n              ) : (\n                <div className=\"flex items-center space-x-2 text-success-600\">\n                  <Check className=\"w-5 h-5\" />\n                  <span className=\"font-medium\">Acknowledgment Sent</span>\n                </div>\n              )}\n            </div>\n\n            {/* Send Claim Acceptance Letter – appears when Accept Claim is clicked */}\n            {claimStatus === 'accepted' && (\n              <div className=\"p-5 border-2 border-emerald-200 rounded-xl bg-gradient-to-br from-emerald-50/50 to-white hover:shadow-md transition-shadow\">\n                <h3 className=\"font-semibold text-[#047857] mb-2\">Send Claim Acceptance Letter</h3>\n                <p className=\"text-sm text-[#718096] mb-3\">\n                  Draft and send a professional letter to notify the claimant that their claim has been approved\n                </p>\n                {!acceptanceSent ? (\n                  <button\n                    type=\"button\"\n                    onClick={() => handleDraftEmail('acceptance')}\n                    className=\"text-sm font-medium text-emerald-700 bg-white border border-emerald-300 hover:bg-emerald-50 px-4 py-2 rounded-lg transition-colors\"\n                  >\n                    Draft Email\n                  </button>\n                ) : (\n                  <div className=\"flex items-center space-x-2 text-emerald-600\">\n                    <Check className=\"w-5 h-5\" />\n                    <span className=\"font-medium\">Claim Acceptance Sent</span>\n                  </div>\n                )}\n              </div>\n            )}\n\n            {/* Send Claim Denial Letter – appears when Reject Claim is clicked */}\n            {claimStatus === 'rejected' && (\n              <div className=\"p-5 border-2 border-rose-200 rounded-xl bg-gradient-to-br from-rose-50/50 to-white hover:shadow-md transition-shadow\">\n                <h3 className=\"font-semibold text-[#B91C1C] mb-2\">Send Claim Denial Letter</h3>\n                <p className=\"text-sm text-[#718096] mb-3\">\n                  Draft and send a professional letter to notify the claimant that their claim cannot be covered\n                </p>\n                {!denialSent ? (\n                  <button\n                    type=\"button\"\n                    onClick={() => handleDraftEmail('rejection')}\n                    className=\"text-sm font-medium text-rose-700 bg-white border border-rose-300 hover:bg-rose-50 px-4 py-2 rounded-lg transition-colors\"\n                  >\n                    Draft Email\n                  </button>\n                ) : (\n                  <div className=\"flex items-center space-x-2 text-rose-600\">\n                    <Check className=\"w-5 h-5\" />\n                    <span className=\"font-medium\">Claim Denial Sent</span>\n                  </div>\n                )}\n              </div>\n            )}\n\n            {/* Download Decision Pack */}\n            <div className=\"p-5 border-2 border-cloud-200 rounded-xl bg-white hover:shadow-md transition-shadow\">\n              <h3 className=\"font-semibold text-[#2D3748] mb-2\">Download Decision Pack</h3>\n              <p className=\"text-sm text-[#718096] mb-4\">\n                Download the decision pack including claim status, summary, evidence, and policy grounding as a structured PDF\n              </p>\n              {downloadError && (\n                <div className=\"mb-3 p-3 rounded-lg bg-red-50 border border-red-200 text-sm text-red-700 flex items-center gap-2\">\n                  <AlertTriangle className=\"w-4 h-4 flex-shrink-0\" />\n                  {downloadError}\n                </div>\n              )}\n              <button\n                onClick={handleDownloadDecisionPack}\n                disabled={isDownloading}\n                className=\"btn-secondary w-full flex items-center justify-center space-x-2 disabled:opacity-50\"\n              >\n                {isDownloading ? (\n                  <>\n                    <Clock className=\"w-4 h-4 animate-spin\" />\n                    <span>Generating PDF...</span>\n                  </>\n                ) : (\n                  <>\n                    <Download className=\"w-4 h-4\" />\n                    <span>Download PDF</span>\n                  </>\n                )}\n              </button>\n            </div>\n          </div>\n        </motion.div>\n      </div>\n\n      {/* Editable Email Draft (Acknowledgment / Acceptance / Denial) */}\n      {emailDraftType && (\n        <motion.div \n          className=\"mt-8 card p-6\"\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n        >\n          <div className=\"flex items-center justify-between mb-4\">\n            <h3 className=\"text-lg font-semibold\">\n              {emailDraftType === 'acknowledgment' \n                ? 'Customer Acknowledgment' \n                : emailDraftType === 'acceptance' \n                  ? 'Claim Acceptance Letter' \n                  : 'Claim Denial Letter'}\n            </h3>\n            <button\n              onClick={handleCloseEmailDraft}\n              className=\"text-gray-500 hover:text-gray-700 p-1\"\n              aria-label=\"Close\"\n            >\n              <X className=\"w-5 h-5\" />\n            </button>\n          </div>\n          <p className=\"text-sm text-[#64748B] mb-3\">\n            Edit the recipient and draft below, then click Send to dispatch to the claimant.\n          </p>\n          {sendEmailError && (\n            <div className=\"mb-4 p-3 rounded-lg bg-red-50 border border-red-200 text-sm text-red-700 flex items-center gap-2\">\n              <AlertTriangle className=\"w-4 h-4 flex-shrink-0\" />\n              {sendEmailError}\n            </div>\n          )}\n          <div className=\"mb-4\">\n            <label className=\"flex items-center gap-2 text-sm font-medium text-[#374151] mb-1.5\">\n              <Mail className=\"w-4 h-4 text-[#6B7280]\" />\n              To (recipient)\n            </label>\n            <input\n              type=\"email\"\n              value={emailDraftRecipient}\n              onChange={(e) => setEmailDraftRecipient(e.target.value)}\n              placeholder=\"claimant@example.com\"\n              className=\"w-full px-3 py-2 text-sm text-[#334155] bg-white border border-[#E2E8F0] rounded-lg focus:ring-2 focus:ring-sky-300 focus:border-sky-400 outline-none\"\n            />\n            {claimData.sourceEmailFrom && (\n              <p className=\"text-[11px] text-[#9CA3AF] mt-1\">\n                Pre-filled from original FNOL email\n              </p>\n            )}\n          </div>\n          <textarea\n            value={emailDraftContent}\n            onChange={(e) => setEmailDraftContent(e.target.value)}\n            className=\"w-full min-h-[280px] p-4 text-sm text-[#334155] bg-[#F8FAFC] border border-[#E2E8F0] rounded-lg font-sans leading-relaxed resize-y focus:ring-2 focus:ring-sky-300 focus:border-sky-400 outline-none\"\n            placeholder=\"Draft content will appear here...\"\n            spellCheck={false}\n          />\n          <div className=\"mt-4 flex justify-end\">\n            <button\n              onClick={handleSendFromDraft}\n              disabled={isSendingAck}\n              className=\"btn-primary flex items-center space-x-2 disabled:opacity-50\"\n            >\n              {isSendingAck ? (\n                <>\n                  <Clock className=\"w-4 h-4 animate-spin\" />\n                  <span>Sending...</span>\n                </>\n              ) : (\n                <>\n                  <Send className=\"w-4 h-4\" />\n                  <span>Send</span>\n                </>\n              )}\n            </button>\n          </div>\n        </motion.div>\n      )}\n\n      {/* Audit Timeline */}\n      <motion.div \n        className=\"mt-8 card p-6\"\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ delay: 0.3 }}\n      >\n        <h3 className=\"text-lg font-semibold mb-4\">Audit Timeline</h3>\n        <div className=\"space-y-3\">\n          {audit.map((event, index) => (\n            <div key={index} className=\"flex items-center space-x-3\">\n              <div className={`w-3 h-3 rounded-full ${\n                event.success ? 'bg-success-500' : 'bg-danger-500'\n              }`}></div>\n              <div className=\"flex-1\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"font-medium text-gray-900\">{event.step}</span>\n                  <span className=\"text-sm text-gray-500\">\n                  {(event.duration / 1000).toFixed(2)}s\n                </span>\n                </div>\n                <div className=\"text-sm text-gray-600\">\n                  {new Date(event.timestamp).toLocaleTimeString()}\n                  {event.agent && ` · ${event.agent}`}\n                  {event.modelVersion && ` · ${event.modelVersion}`}\n                  {event.fallbackUsed && (\n                    <span className=\"text-warning-600 ml-2\">(Fallback used)</span>\n                  )}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      </motion.div>\n\n      {/* Navigation */}\n      <div className=\"flex justify-between mt-8\">\n        <button\n          onClick={onPreviousStage}\n          className=\"btn-secondary flex items-center space-x-2\"\n        >\n          <ArrowLeft className=\"w-4 h-4\" />\n          <span>Back to Review</span>\n        </button>\n        \n        <button\n          onClick={onNextStage}\n          className=\"btn-primary flex items-center space-x-2\"\n        >\n          <span>View Dashboard</span>\n          <ArrowRight className=\"w-4 h-4\" />\n        </button>\n      </div>\n    </motion.div>\n  )\n} "],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAeA;AAEA;AArBA;;;;;;;AA8Be,SAAS,aAAa,EAAE,SAAS,EAAE,WAAW,EAAE,eAAe,EAAE,WAAW,EAAqB;IAC9G,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,yPAAQ,EAAC;IACvD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yPAAQ,EAAC;IACjD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yPAAQ,EAAC;IACjD,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yPAAQ,EAAsC;IACpF,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yPAAQ,EAAC;IACvC,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yPAAQ,EAAC;IACrD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yPAAQ,EAAC;IAC7C,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,IAAA,yPAAQ,EAAc,IAAI;IAC5E,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yPAAQ,EAAuD;IAC3G,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,IAAA,yPAAQ,EAAC;IAC3D,MAAM,CAAC,qBAAqB,uBAAuB,GAAG,IAAA,yPAAQ,EAAC;IAC/D,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yPAAQ,EAAgB;IACpE,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yPAAQ,EAAgB;IAClE,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yPAAQ,EAAC;IACnD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yPAAQ,EAAgB;IAC5D,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yPAAQ,EAOtC;IAEV,IAAA,0PAAS,EAAC;QACR,eAAe;IACjB,GAAG;QAAC,WAAW;KAAQ;IAEvB,wBAAwB;IACxB,IAAI,CAAC,aAAa,CAAC,UAAU,YAAY,EAAE;QACzC,qBACE,sRAAC,4NAAM,CAAC,GAAG;YACT,SAAS;gBAAE,SAAS;gBAAG,GAAG;YAAG;YAC7B,SAAS;gBAAE,SAAS;gBAAG,GAAG;YAAE;YAC5B,WAAU;;8BAEV,sRAAC,iRAAa;oBAAC,WAAU;;;;;;8BACzB,sRAAC;oBAAG,WAAU;8BAAwC;;;;;;8BACtD,sRAAC;oBAAE,WAAU;8BAAqB;;;;;;8BAGlC,sRAAC;oBACC,SAAS;oBACT,WAAU;;sCAEV,sRAAC,qQAAS;4BAAC,WAAU;;;;;;sCACrB,sRAAC;sCAAK;;;;;;;;;;;;;;;;;;IAId;IAEA,MAAM,EAAE,YAAY,EAAE,cAAc,EAAE,GAAG;IACzC,MAAM,EACJ,UAAU,EACV,WAAW,EAAE,EACb,YAAY,EAAE,EACd,kBAAkB,EAAE,EACpB,QAAQ,EAAE,EACX,GAAG,gBAAgB,CAAC;IAErB,MAAM,oBAAoB;QACxB,mBAAmB;QACnB,cAAc;QACd,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,eAAe;gBACrC,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;YACvB;YACA,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,IAAI,CAAC,IAAI,EAAE,EAAE;gBACX,MAAM,IAAI,MAAM,KAAK,KAAK,IAAI;YAChC;YACA,gBAAgB;YAChB,IAAI,KAAK,KAAK,EAAE,gBAAgB,KAAK,KAAK;QAC5C,EAAE,OAAO,KAAK;YACZ,cAAc,eAAe,QAAQ,IAAI,OAAO,GAAG;QACrD,SAAU;YACR,mBAAmB;QACrB;IACF;IAGA,MAAM,yBAAyB;QAC7B,MAAM,QAAQ,cAAc,CAAC;QAC7B,MAAM,eAAe,MAAM,YAAY,IAAI;QAC3C,MAAM,YAAY,MAAM,YAAY,IAAI,MAAM,QAAQ,IAAI;QAC1D,MAAM,cAAc,UAAU,OAAO,IAAI;QACzC,MAAM,WAAW,MAAM,QAAQ,IAAI;QACnC,MAAM,WAAW,MAAM,QAAQ,IAAI;QACnC,MAAM,eAAe,MAAM,YAAY,IAAI,MAAM,QAAQ,IAAI,MAAM,eAAe,IAAI;QACtF,MAAM,cAAc,MAAM,WAAW,GAAI,MAAM,WAAW,CAAC,MAAM,GAAG,MAAM,GAAG,MAAM,WAAW,CAAC,KAAK,CAAC,GAAG,KAAK,GAAG,CAAC,GAAG,MAAM,WAAW,GAAI;QACzI,MAAM,kBAAkB,MAAM,eAAe;QAC7C,MAAM,aAAa,MAAM,UAAU;QACnC,MAAM,WAAW,WAAW,UAAU;QACtC,MAAM,UAAU,WAAW,SAAS,UAAU,GAAG,CAAC,CAAC,IAAM,EAAE,IAAI,IAAI,EAAE,IAAI,EAAE,MAAM,CAAC,SAAS,KAAK,CAAC,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,UAAU,MAAM,GAAG,IAAI,gBAAgB,EAAE,IAAI;QAClK,MAAM,mBAAmB,gBAAgB,MAAM,GAAG;QAClD,MAAM,mBAAmB,cAAc;QAEvC,MAAM,QAAQ,IAAI,OAAO,kBAAkB,CAAC,SAAS;YAAE,MAAM;YAAW,OAAO;YAAQ,KAAK;QAAU;QAEtG,IAAI,SAAS,GAAG,MAAM,IAAI,CAAC;QAC3B,UAAU,CAAC,KAAK,EAAE,aAAa,KAAK,CAAC;QACrC,UAAU,CAAC,wCAAwC,EAAE,YAAY,EAAE,CAAC;QACpE,UAAU,CAAC,kBAAkB,EAAE,UAAU,IAAI,CAAC;QAC9C,UAAU,CAAC,kHAAkH,CAAC;QAC9H,UAAU,CAAC,eAAe,CAAC;QAC3B,UAAU,CAAC,mBAAmB,EAAE,SAAS,EAAE,CAAC;QAC5C,UAAU,CAAC,eAAe,EAAE,SAAS,EAAE,CAAC;QACxC,IAAI,cAAc,UAAU,CAAC,cAAc,EAAE,aAAa,EAAE,CAAC;QAC7D,IAAI,aAAa,UAAU,CAAC,iBAAiB,EAAE,YAAY,EAAE,CAAC;QAC9D,IAAI,mBAAmB,MAAM,UAAU,CAAC,uBAAuB,EAAE,OAAO,iBAAiB,cAAc,GAAG,EAAE,CAAC;QAC7G,IAAI,cAAc,MAAM,UAAU,CAAC,4BAA4B,EAAE,OAAO,YAAY,cAAc,GAAG,EAAE,CAAC;QACxG,UAAU,CAAC,EAAE,CAAC;QACd,UAAU,CAAC,oBAAoB,CAAC;QAChC,IAAI,WAAW,GAAG;YAChB,UAAU,CAAC,mBAAmB,EAAE,SAAS,qCAAqC,EAAE,UAAU,CAAC,EAAE,EAAE,SAAS,GAAG,IAAI,IAAI,CAAC;QACtH,OAAO;YACL,UAAU,CAAC,yEAAyE,CAAC;QACvF;QACA,UAAU,CAAC,qBAAqB,CAAC;QACjC,IAAI,oBAAoB,kBAAkB,mBAAmB;YAC3D,UAAU,CAAC,2MAA2M,CAAC;QACzN,OAAO;YACL,UAAU,CAAC,8HAA8H,CAAC;QAC5I;QACA,UAAU,CAAC,YAAY,CAAC;QACxB,UAAU,CAAC,gFAAgF,CAAC;QAC5F,UAAU,CAAC,8GAA8G,CAAC;QAC1H,UAAU,CAAC,yDAAyD,EAAE,YAAY,2CAA2C,CAAC;QAC9H,UAAU,CAAC,4GAA4G,CAAC;QACxH,UAAU,CAAC,cAAc,CAAC;QAC1B,UAAU,CAAC,mBAAmB,CAAC;QAC/B,UAAU,CAAC,qBAAqB,CAAC;QAEjC,OAAO;IACT;IAEA,MAAM,2BAA2B;QAC/B,MAAM,QAAQ,cAAc,CAAC;QAC7B,MAAM,eAAe,MAAM,YAAY,IAAI;QAC3C,MAAM,YAAY,MAAM,YAAY,IAAI,MAAM,QAAQ,IAAI;QAC1D,MAAM,cAAc,UAAU,OAAO,IAAI;QACzC,MAAM,WAAW,MAAM,QAAQ,IAAI;QACnC,MAAM,WAAW,MAAM,QAAQ,IAAI;QACnC,MAAM,kBAAkB,MAAM,eAAe;QAC7C,MAAM,QAAQ,IAAI,OAAO,kBAAkB,CAAC,SAAS;YAAE,MAAM;YAAW,OAAO;YAAQ,KAAK;QAAU;QACtG,IAAI,SAAS,GAAG,MAAM,IAAI,CAAC;QAC3B,UAAU,CAAC,KAAK,EAAE,aAAa,KAAK,CAAC;QACrC,UAAU,CAAC,oCAAoC,EAAE,YAAY,EAAE,CAAC;QAChE,UAAU,CAAC,kBAAkB,EAAE,UAAU,IAAI,CAAC;QAC9C,UAAU,CAAC,mEAAmE,CAAC;QAC/E,UAAU,CAAC,eAAe,CAAC;QAC3B,UAAU,CAAC,mBAAmB,EAAE,SAAS,EAAE,CAAC;QAC5C,UAAU,CAAC,eAAe,EAAE,SAAS,EAAE,CAAC;QACxC,IAAI,mBAAmB,MAAM,UAAU,CAAC,sBAAsB,EAAE,OAAO,iBAAiB,cAAc,GAAG,EAAE,CAAC;QAC5G,UAAU,CAAC,EAAE,CAAC;QACd,UAAU,CAAC,YAAY,CAAC;QACxB,UAAU,CAAC,2DAA2D,CAAC;QACvE,UAAU,CAAC,2EAA2E,CAAC;QACvF,UAAU,CAAC,8DAA8D,EAAE,YAAY,wBAAwB,CAAC;QAChH,UAAU,CAAC,wDAAwD,CAAC;QACpE,UAAU,CAAC,cAAc,CAAC;QAC1B,UAAU,CAAC,mBAAmB,CAAC;QAC/B,UAAU,CAAC,qBAAqB,CAAC;QACjC,OAAO;IACT;IAEA,MAAM,0BAA0B;QAC9B,MAAM,QAAQ,cAAc,CAAC;QAC7B,MAAM,eAAe,MAAM,YAAY,IAAI;QAC3C,MAAM,YAAY,MAAM,YAAY,IAAI,MAAM,QAAQ,IAAI;QAC1D,MAAM,cAAc,UAAU,OAAO,IAAI;QACzC,MAAM,WAAW,MAAM,QAAQ,IAAI;QACnC,MAAM,WAAW,MAAM,QAAQ,IAAI;QACnC,MAAM,QAAQ,IAAI,OAAO,kBAAkB,CAAC,SAAS;YAAE,MAAM;YAAW,OAAO;YAAQ,KAAK;QAAU;QACtG,IAAI,SAAS,GAAG,MAAM,IAAI,CAAC;QAC3B,UAAU,CAAC,KAAK,EAAE,aAAa,KAAK,CAAC;QACrC,UAAU,CAAC,kCAAkC,EAAE,YAAY,EAAE,CAAC;QAC9D,UAAU,CAAC,kBAAkB,EAAE,UAAU,IAAI,CAAC;QAC9C,UAAU,CAAC,kMAAkM,CAAC;QAC9M,UAAU,CAAC,gBAAgB,CAAC;QAC5B,UAAU,CAAC,mBAAmB,EAAE,SAAS,EAAE,CAAC;QAC5C,UAAU,CAAC,eAAe,EAAE,SAAS,EAAE,CAAC;QACxC,UAAU,CAAC,EAAE,CAAC;QACd,UAAU,CAAC,mBAAmB,CAAC;QAC/B,UAAU,CAAC,oMAAoM,CAAC;QAChN,UAAU,CAAC,cAAc,CAAC;QAC1B,UAAU,CAAC,6HAA6H,CAAC;QACzI,UAAU,CAAC,oGAAoG,CAAC;QAChH,UAAU,CAAC,4BAA4B,EAAE,YAAY,2BAA2B,CAAC;QACjF,UAAU,CAAC,qGAAqG,CAAC;QACjH,UAAU,CAAC,cAAc,CAAC;QAC1B,UAAU,CAAC,mBAAmB,CAAC;QAC/B,UAAU,CAAC,qBAAqB,CAAC;QACjC,OAAO;IACT;IAEA,MAAM,mBAAmB,CAAC;QACxB,MAAM,UAAU,SAAS,eACrB,6BACA,SAAS,cACP,4BACA;QACN,MAAM,YAAY,UAAU,eAAe,IAAI,YAAY,gBAAgB;QAC3E,kBAAkB;QAClB,qBAAqB;QACrB,uBAAuB;IACzB;IAEA,MAAM,wBAAwB;QAC5B,kBAAkB;QAClB,qBAAqB;QACrB,uBAAuB;QACvB,kBAAkB;IACpB;IAEA,MAAM,6BAA6B;QACjC,iBAAiB;QACjB,iBAAiB;QACjB,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,0BAA0B;gBAChD,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;oBAAW;gBAAY;YAChD;YACA,IAAI,CAAC,IAAI,EAAE,EAAE;gBACX,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;gBAC7C,MAAM,IAAI,MAAM,KAAK,KAAK,IAAI;YAChC;YACA,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,MAAM,qBAAqB,IAAI,OAAO,CAAC,GAAG,CAAC;YAC3C,MAAM,QAAQ,oBAAoB,MAAM;YACxC,MAAM,WAAW,OAAO,CAAC,EAAE,IAAI,CAAC,cAAc,EAAE,UAAU,OAAO,IAAI,QAAQ,IAAI,CAAC;YAClF,MAAM,MAAM,IAAI,eAAe,CAAC;YAChC,MAAM,IAAI,SAAS,aAAa,CAAC;YACjC,EAAE,IAAI,GAAG;YACT,EAAE,QAAQ,GAAG;YACb,EAAE,KAAK;YACP,IAAI,eAAe,CAAC;QACtB,EAAE,OAAO,KAAK;YACZ,iBAAiB,eAAe,QAAQ,IAAI,OAAO,GAAG;QACxD,SAAU;YACR,iBAAiB;QACnB;IACF;IAEA,MAAM,sBAAsB;QAC1B,IAAI,CAAC,gBAAgB;QACrB,MAAM,YAAY,qBAAqB;QACvC,IAAI,CAAC,WAAW;YACd,kBAAkB;YAClB;QACF;QACA,gBAAgB;QAChB,kBAAkB;QAClB,IAAI;YACF,MAAM,WAAW,UAAU,OAAO,IAAI;YACtC,MAAM,aAAa;gBACjB,gBAAgB,CAAC,oCAAoC,EAAE,UAAU;gBACjE,YAAY,CAAC,gCAAgC,EAAE,UAAU;gBACzD,WAAW,CAAC,8BAA8B,EAAE,UAAU;YACxD;YACA,MAAM,UAAU,UAAU,CAAC,eAAe;YAC1C,MAAM,MAAM,MAAM,MAAM,mBAAmB;gBACzC,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBACnB,IAAI;oBACJ;oBACA,MAAM;gBACR;YACF;YACA,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,IAAI,CAAC,IAAI,EAAE,EAAE;gBACX,MAAM,IAAI,MAAM,KAAK,KAAK,IAAI;YAChC;YACA,IAAI,mBAAmB,kBAAkB,WAAW;iBAC/C,IAAI,mBAAmB,cAAc,kBAAkB;iBACvD,IAAI,mBAAmB,aAAa,cAAc;YACvD;QACF,EAAE,OAAO,KAAK;YACZ,kBAAkB,eAAe,QAAQ,IAAI,OAAO,GAAG;QACzD,SAAU;YACR,gBAAgB;QAClB;IACF;IAEA,qBACE,sRAAC,4NAAM,CAAC,GAAG;QACT,SAAS;YAAE,SAAS;YAAG,GAAG;QAAG;QAC7B,SAAS;YAAE,SAAS;YAAG,GAAG;QAAE;QAC5B,WAAU;;0BAEV,sRAAC,iLAAe;gBACd,WAAW;gBACX,QAAQ;gBACR,YAAY;gBACZ,eAAc;gBACd,iBAAiB;gBACjB,eAAe;;;;;;0BAGjB,sRAAC;gBAAI,WAAU;;kCACb,sRAAC;wBAAG,WAAU;kCAAmH;;;;;;kCAGjI,sRAAC;wBAAE,WAAU;kCAA2C;;;;;;;;;;;;0BAK1D,sRAAC;gBAAI,WAAU;;kCAEb,sRAAC,4NAAM,CAAC,GAAG;wBACT,WAAU;wBACV,SAAS;4BAAE,SAAS;4BAAG,GAAG,CAAC;wBAAG;wBAC9B,SAAS;4BAAE,SAAS;4BAAG,GAAG;wBAAE;wBAC5B,YAAY;4BAAE,OAAO;wBAAI;;0CAEzB,sRAAC;gCAAI,WAAU;;kDACb,sRAAC;wCAAI,WAAU;kDACb,cAAA,sRAAC,2QAAW;4CAAC,WAAU;;;;;;;;;;;kDAEzB,sRAAC;wCAAG,WAAU;kDAAmC;;;;;;;;;;;;0CAGnD,sRAAC;gCAAI,WAAU;;kDAEb,sRAAC;wCAAI,WAAU;;0DACb,sRAAC;gDAAG,WAAU;0DAAoC;;;;;;0DAClD,sRAAC;gDAAI,WAAU;;kEACb,sRAAC;wDAAI,WAAU;;0EACb,sRAAC;gEAAK,WAAU;0EAAc;;;;;;4DAAqB;0EACnD,sRAAC;gEAAK,WAAW,CAAC,cAAc,EAAE,gBAAgB,aAAa,qBAAqB,gBAAgB,aAAa,kBAAkB,kBAAkB;0EAClJ,gBAAgB,aAAa,aAAa,gBAAgB,aAAa,aAAa;;;;;;;;;;;;kEAGzF,sRAAC;;0EAAI,sRAAC;gEAAK,WAAU;0EAAc;;;;;;4DAAc;4DAAE,WAAW,YAAY,IAAI,WAAW,QAAQ,IAAI;;;;;;;kEACrG,sRAAC;;0EAAI,sRAAC;gEAAK,WAAU;0EAAc;;;;;;4DAAgB;4DAAE,WAAW,YAAY,IAAI;;;;;;;kEAChF,sRAAC;;0EAAI,sRAAC;gEAAK,WAAU;0EAAc;;;;;;4DAAiB;4DAAE,WAAW,QAAQ,IAAI;;;;;;;kEAC7E,sRAAC;;0EAAI,sRAAC;gEAAK,WAAU;0EAAc;;;;;;4DAAY;4DAAE,WAAW,QAAQ,IAAI;;;;;;;kEACxE,sRAAC;;0EAAI,sRAAC;gEAAK,WAAU;0EAAc;;;;;;4DAAgB;4DAAE,WAAW,YAAY,IAAI,WAAW,QAAQ,IAAI,WAAW,eAAe,IAAI;;;;;;;oDACpI,WAAW,UAAU,kBACpB,sRAAC;;0EAAI,sRAAC;gEAAK,WAAU;0EAAc;;;;;;4DAAkB;4DAAG,WAAW,UAAU;;;;;;;;;;;;;;;;;;;kDAMnF,sRAAC;wCAAI,WAAU;;0DACb,sRAAC;gDAAG,WAAU;0DAAoC;;;;;;0DAClD,sRAAC;gDAAI,WAAU;;kEACb,sRAAC;wDAAI,WAAU;;0EACb,sRAAC;gEAAK,WAAU;0EAAc;;;;;;4DAAiB;4DAAE,UAAU,MAAM;4DAAC;;;;;;;kEAEpE,sRAAC;wDAAI,WAAU;;0EACb,sRAAC;gEAAK,WAAU;0EAAc;;;;;;4DAAwB;4DAAE,SAAS,MAAM;4DAAC;;;;;;;kEAE1E,sRAAC;;0EACC,sRAAC;gEAAK,WAAU;0EAAc;;;;;;4DAAuB;4DAAE,SAAS,MAAM,CAAC,CAAA,IAAK,EAAE,UAAU,IAAI,uKAAU,CAAC,cAAc,EAAE,MAAM;4DAAC;;;;;;;;;;;;;;;;;;;oCAMnI,gBAAgB,MAAM,GAAG,mBACxB,sRAAC;wCAAI,WAAU;;0DACb,sRAAC;gDAAG,WAAU;0DAAoC;;;;;;0DAClD,sRAAC;gDAAI,WAAU;;kEACb,sRAAC;wDAAI,WAAU;;0EACb,sRAAC;gEAAK,WAAU;0EAAc;;;;;;4DAAqB;4DAAE,gBAAgB,MAAM;;;;;;;kEAE7E,sRAAC;;0EACC,sRAAC;gEAAK,WAAU;0EAAc;;;;;;4DAAgB;4DAAE,WAAW,aAAa,GAAG,cAAc;;;;;;;;;;;;;0DAG7F,sRAAC;gDAAI,WAAU;0DACZ,gBAAgB,GAAG,CAAC,CAAC;oDACpB,MAAM,aAAa,kBAAkB,GAAG,CAAC,OAAO,QAAQ;oDACxD,MAAM,cAAc,OAAO,OAAO,IAAI,OAAO,OAAO,IAAI;oDACxD,MAAM,SAAS;wDACb,qBAAqB,CAAC;4DACpB,MAAM,OAAO,IAAI,IAAI;4DACrB,IAAI,KAAK,GAAG,CAAC,OAAO,QAAQ,GAAG,KAAK,MAAM,CAAC,OAAO,QAAQ;iEACrD,KAAK,GAAG,CAAC,OAAO,QAAQ;4DAC7B,OAAO;wDACT;oDACF;oDACA,qBACE,sRAAC;wDAA0B,WAAU;;0EACnC,sRAAC;gEACC,MAAK;gEACL,SAAS;gEACT,WAAU;0EAEV,cAAA,sRAAC;oEAAI,WAAU;;sFACb,sRAAC;4EAAI,WAAU;;8FACb,sRAAC;oFAAI,WAAU;;sGACb,sRAAC;4FAAK,WAAU;sGAAwC,OAAO,QAAQ;;;;;;sGACvE,sRAAC;4FAAK,WAAU;;gGACb,KAAK,KAAK,CAAC,CAAC,OAAO,KAAK,IAAI,OAAO,UAAU,IAAI,CAAC,IAAI;gGAAK;;;;;;;;;;;;;8FAGhE,sRAAC;oFAAI,WAAU;8FACZ,OAAO,KAAK;;;;;;8FAEf,sRAAC;oFAAI,WAAU;8FACZ,OAAO,OAAO,IAAI,YAAY,KAAK,CAAC,GAAG,OAAO;;;;;;;;;;;;sFAGnD,sRAAC;4EAAK,WAAU;sFACb,2BAAa,sRAAC,qQAAS;gFAAC,WAAU;;;;;qGAAe,sRAAC,2QAAW;gFAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;4DAI9E,cAAc,6BACb,sRAAC;gEAAI,WAAU;;kFACb,sRAAC;wEAAI,WAAU;kFACZ;;;;;;oEAEF,OAAO,SAAS,kBACf,sRAAC;wEAAE,WAAU;kFAAwC,OAAO,SAAS;;;;;;;;;;;;;uDAhCnE,OAAO,QAAQ;;;;;gDAsC7B;;;;;;;;;;;;;;;;;;;;;;;;kCAQV,sRAAC,4NAAM,CAAC,GAAG;wBACT,WAAU;wBACV,SAAS;4BAAE,SAAS;4BAAG,GAAG;wBAAG;wBAC7B,SAAS;4BAAE,SAAS;4BAAG,GAAG;wBAAE;wBAC5B,YAAY;4BAAE,OAAO;wBAAI;;0CAEzB,sRAAC;gCAAI,WAAU;;kDACb,sRAAC;wCAAI,WAAU;kDACb,cAAA,sRAAC,kQAAQ;4CAAC,WAAU;;;;;;;;;;;kDAEtB,sRAAC;wCAAG,WAAU;kDAAmC;;;;;;;;;;;;0CAInD,sRAAC;gCAAI,WAAU;;kDACb,sRAAC;wCACC,MAAK;wCACL,SAAS;4CACP,eAAe;4CACf,iBAAiB;wCACnB;wCACA,WAAU;;0DAEV,sRAAC,qPAAK;gDAAC,WAAU;;;;;;4CAAY;;;;;;;kDAG/B,sRAAC;wCACC,MAAK;wCACL,SAAS;4CACP,eAAe;4CACf,iBAAiB;wCACnB;wCACA,WAAU;;0DAEV,sRAAC,yOAAC;gDAAC,WAAU;;;;;;4CAAY;;;;;;;;;;;;;0CAK7B,sRAAC;gCAAI,WAAU;;kDAEb,sRAAC;wCAAI,WAAU;;0DACb,sRAAC;gDAAG,WAAU;0DAAoC;;;;;;0DAClD,sRAAC;gDAAE,WAAU;0DAA8B;;;;;;4CAI1C,4BACC,sRAAC;gDAAI,WAAU;;kEACb,sRAAC,iRAAa;wDAAC,WAAU;;;;;;oDACxB;;;;;;;4CAGJ,CAAC,6BACA,sRAAC;gDACC,SAAS;gDACT,UAAU;gDACV,WAAU;0DAET,gCACC,sRAAC;oDAAI,WAAU;;sEACb,sRAAC,qPAAK;4DAAC,WAAU;;;;;;sEACjB,sRAAC;sEAAK;;;;;;;;;;;yEAGR,sRAAC;8DAAK;;;;;;;;;;qEAIV;;kEACE,sRAAC;wDAAI,WAAU;;0EACb,sRAAC,qPAAK;gEAAC,WAAU;;;;;;0EACjB,sRAAC;gEAAK,WAAU;;oEAAc;oEAAiD,UAAU,OAAO;oEAAC;;;;;;;;;;;;;oDAElG,8BACC,sRAAC;wDAAI,WAAU;;0EACb,sRAAC;gEAAG,WAAU;0EAA4C;;;;;;0EAC1D,sRAAC;gEAAI,WAAU;;kFACb,sRAAC;wEAAI,WAAU;kFACZ,aAAa,WAAW,IAAI,OAAO,OAAO,CAAC,aAAa,WAAW,EACjE,MAAM,CAAC,CAAC,GAAG,EAAE,GAAK,KAAK,QAAQ,MAAM,IACrC,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,iBACV,sRAAC;gFAAY,WAAU;;kGACrB,sRAAC;wFAAK,WAAU;;4FAAyC,EAAE,OAAO,CAAC,YAAY,OAAO,IAAI;4FAAG;;;;;;;kGAC7F,sRAAC;wFAAK,WAAU;kGAA8B,OAAO,MAAM,WAAW,KAAK,SAAS,CAAC,KAAK,OAAO;;;;;;;+EAFzF;;;;;;;;;;oEAMf,aAAa,WAAW,EAAE,SAAS,mBAClC,sRAAC;;0FACC,sRAAC;gFAAK,WAAU;0FAA6B;;;;;;0FAC7C,sRAAC;gFAAG,WAAU;0FACX,aAAa,WAAW,CAAC,GAAG,CAAC,CAAC,GAAG,kBAChC,sRAAC;;4FAAY,EAAE,IAAI;4FAAC;4FAAE,EAAE,IAAI,kBAAI,sRAAC;gGAAK,WAAU;;oGAAiB;oGAAE,EAAE,IAAI;oGAAC;;;;;;;;uFAAjE;;;;;;;;;;;;;;;;oEAKhB,aAAa,aAAa,EAAE,SAAS,mBACpC,sRAAC;;0FACC,sRAAC;gFAAK,WAAU;0FAA6B;;;;;;0FAC7C,sRAAC;gFAAG,WAAU;0FACX,aAAa,aAAa,CAAC,GAAG,CAAC,CAAC,GAAG,kBAClC,sRAAC;wFAAW,WAAU;;0GACpB,sRAAC;;oGAAM,EAAE,QAAQ;oGAAC;oGAAI,EAAE,KAAK;;;;;;;4FAC5B,EAAE,KAAK,IAAI,sBAAQ,sRAAC;gGAAK,WAAU;;oGAAkB,KAAK,KAAK,CAAC,EAAE,KAAK,GAAG;oGAAK;;;;;;;;uFAFzE;;;;;;;;;;;;;;;;oEAQhB,aAAa,kBAAkB,EAAE,SAAS,mBACzC,sRAAC;;0FACC,sRAAC;gFAAK,WAAU;0FAA6B;;;;;;0FAC7C,sRAAC;gFAAG,WAAU;0FACX,aAAa,kBAAkB,CAAC,GAAG,CAAC,CAAC,GAAG,kBAAM,sRAAC;kGAAY;uFAAJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kDAY1E,sRAAC;wCAAI,WAAU;;0DACb,sRAAC;gDAAG,WAAU;0DAAoC;;;;;;0DAClD,sRAAC;gDAAE,WAAU;0DAA8B;;;;;;4CAI1C,CAAC,wBACA,sRAAC;gDACC,SAAS,IAAM,iBAAiB;gDAChC,WAAU;0DACX;;;;;qEAID,sRAAC;gDAAI,WAAU;;kEACb,sRAAC,qPAAK;wDAAC,WAAU;;;;;;kEACjB,sRAAC;wDAAK,WAAU;kEAAc;;;;;;;;;;;;;;;;;;oCAMnC,gBAAgB,4BACf,sRAAC;wCAAI,WAAU;;0DACb,sRAAC;gDAAG,WAAU;0DAAoC;;;;;;0DAClD,sRAAC;gDAAE,WAAU;0DAA8B;;;;;;4CAG1C,CAAC,+BACA,sRAAC;gDACC,MAAK;gDACL,SAAS,IAAM,iBAAiB;gDAChC,WAAU;0DACX;;;;;qEAID,sRAAC;gDAAI,WAAU;;kEACb,sRAAC,qPAAK;wDAAC,WAAU;;;;;;kEACjB,sRAAC;wDAAK,WAAU;kEAAc;;;;;;;;;;;;;;;;;;oCAOrC,gBAAgB,4BACf,sRAAC;wCAAI,WAAU;;0DACb,sRAAC;gDAAG,WAAU;0DAAoC;;;;;;0DAClD,sRAAC;gDAAE,WAAU;0DAA8B;;;;;;4CAG1C,CAAC,2BACA,sRAAC;gDACC,MAAK;gDACL,SAAS,IAAM,iBAAiB;gDAChC,WAAU;0DACX;;;;;qEAID,sRAAC;gDAAI,WAAU;;kEACb,sRAAC,qPAAK;wDAAC,WAAU;;;;;;kEACjB,sRAAC;wDAAK,WAAU;kEAAc;;;;;;;;;;;;;;;;;;kDAOtC,sRAAC;wCAAI,WAAU;;0DACb,sRAAC;gDAAG,WAAU;0DAAoC;;;;;;0DAClD,sRAAC;gDAAE,WAAU;0DAA8B;;;;;;4CAG1C,+BACC,sRAAC;gDAAI,WAAU;;kEACb,sRAAC,iRAAa;wDAAC,WAAU;;;;;;oDACxB;;;;;;;0DAGL,sRAAC;gDACC,SAAS;gDACT,UAAU;gDACV,WAAU;0DAET,8BACC;;sEACE,sRAAC,qPAAK;4DAAC,WAAU;;;;;;sEACjB,sRAAC;sEAAK;;;;;;;iFAGR;;sEACE,sRAAC,8PAAQ;4DAAC,WAAU;;;;;;sEACpB,sRAAC;sEAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;YAUnB,gCACC,sRAAC,4NAAM,CAAC,GAAG;gBACT,WAAU;gBACV,SAAS;oBAAE,SAAS;oBAAG,GAAG;gBAAG;gBAC7B,SAAS;oBAAE,SAAS;oBAAG,GAAG;gBAAE;;kCAE5B,sRAAC;wBAAI,WAAU;;0CACb,sRAAC;gCAAG,WAAU;0CACX,mBAAmB,mBAChB,4BACA,mBAAmB,eACjB,4BACA;;;;;;0CAER,sRAAC;gCACC,SAAS;gCACT,WAAU;gCACV,cAAW;0CAEX,cAAA,sRAAC,yOAAC;oCAAC,WAAU;;;;;;;;;;;;;;;;;kCAGjB,sRAAC;wBAAE,WAAU;kCAA8B;;;;;;oBAG1C,gCACC,sRAAC;wBAAI,WAAU;;0CACb,sRAAC,iRAAa;gCAAC,WAAU;;;;;;4BACxB;;;;;;;kCAGL,sRAAC;wBAAI,WAAU;;0CACb,sRAAC;gCAAM,WAAU;;kDACf,sRAAC,kPAAI;wCAAC,WAAU;;;;;;oCAA2B;;;;;;;0CAG7C,sRAAC;gCACC,MAAK;gCACL,OAAO;gCACP,UAAU,CAAC,IAAM,uBAAuB,EAAE,MAAM,CAAC,KAAK;gCACtD,aAAY;gCACZ,WAAU;;;;;;4BAEX,UAAU,eAAe,kBACxB,sRAAC;gCAAE,WAAU;0CAAkC;;;;;;;;;;;;kCAKnD,sRAAC;wBACC,OAAO;wBACP,UAAU,CAAC,IAAM,qBAAqB,EAAE,MAAM,CAAC,KAAK;wBACpD,WAAU;wBACV,aAAY;wBACZ,YAAY;;;;;;kCAEd,sRAAC;wBAAI,WAAU;kCACb,cAAA,sRAAC;4BACC,SAAS;4BACT,UAAU;4BACV,WAAU;sCAET,6BACC;;kDACE,sRAAC,qPAAK;wCAAC,WAAU;;;;;;kDACjB,sRAAC;kDAAK;;;;;;;6DAGR;;kDACE,sRAAC,kPAAI;wCAAC,WAAU;;;;;;kDAChB,sRAAC;kDAAK;;;;;;;;;;;;;;;;;;;;;;;;0BASlB,sRAAC,4NAAM,CAAC,GAAG;gBACT,WAAU;gBACV,SAAS;oBAAE,SAAS;oBAAG,GAAG;gBAAG;gBAC7B,SAAS;oBAAE,SAAS;oBAAG,GAAG;gBAAE;gBAC5B,YAAY;oBAAE,OAAO;gBAAI;;kCAEzB,sRAAC;wBAAG,WAAU;kCAA6B;;;;;;kCAC3C,sRAAC;wBAAI,WAAU;kCACZ,MAAM,GAAG,CAAC,CAAC,OAAO,sBACjB,sRAAC;gCAAgB,WAAU;;kDACzB,sRAAC;wCAAI,WAAW,CAAC,qBAAqB,EACpC,MAAM,OAAO,GAAG,mBAAmB,iBACnC;;;;;;kDACF,sRAAC;wCAAI,WAAU;;0DACb,sRAAC;gDAAI,WAAU;;kEACb,sRAAC;wDAAK,WAAU;kEAA6B,MAAM,IAAI;;;;;;kEACvD,sRAAC;wDAAK,WAAU;;4DACf,CAAC,MAAM,QAAQ,GAAG,IAAI,EAAE,OAAO,CAAC;4DAAG;;;;;;;;;;;;;0DAGtC,sRAAC;gDAAI,WAAU;;oDACZ,IAAI,KAAK,MAAM,SAAS,EAAE,kBAAkB;oDAC5C,MAAM,KAAK,IAAI,CAAC,GAAG,EAAE,MAAM,KAAK,EAAE;oDAClC,MAAM,YAAY,IAAI,CAAC,GAAG,EAAE,MAAM,YAAY,EAAE;oDAChD,MAAM,YAAY,kBACjB,sRAAC;wDAAK,WAAU;kEAAwB;;;;;;;;;;;;;;;;;;;+BAhBtC;;;;;;;;;;;;;;;;0BA0BhB,sRAAC;gBAAI,WAAU;;kCACb,sRAAC;wBACC,SAAS;wBACT,WAAU;;0CAEV,sRAAC,qQAAS;gCAAC,WAAU;;;;;;0CACrB,sRAAC;0CAAK;;;;;;;;;;;;kCAGR,sRAAC;wBACC,SAAS;wBACT,WAAU;;0CAEV,sRAAC;0CAAK;;;;;;0CACN,sRAAC,wQAAU;gCAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;AAKhC"}},
    {"offset": {"line": 5256, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/components/DashboardPage.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport {\n  Clock,\n  CheckCircle,\n  AlertTriangle,\n  TrendingUp,\n  RefreshCw,\n  Download,\n  FileText,\n  Shield,\n  BarChart3,\n  PieChart as PieChartIcon,\n} from 'lucide-react'\nimport { ClaimData } from '@/types/claims'\nimport { CONFIDENCE } from '@/lib/confidence'\nimport {\n  LineChart,\n  Line,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  ResponsiveContainer,\n  BarChart,\n  Bar,\n  PieChart,\n  Pie,\n  Cell,\n  Legend,\n} from 'recharts'\n\ninterface DashboardKpis {\n  totalClaims: number\n  claimsThisWeek: number\n  claimsThisMonth: number\n  claimsByLossType: Record<string, number>\n  coverageMatchRate: number\n  avgConfidence: number\n  totalDocumentsProcessed: number\n  claimsByDate: Array<{ date: string; count: number }>\n  recentClaims: Array<{\n    claimId: string\n    policyNumber?: string\n    claimantName?: string\n    lossType: string\n    createdAt: string\n    policyMatches: number\n  }>\n}\n\ninterface DashboardPageProps {\n  claimData: ClaimData\n  onReset: () => void\n}\n\nconst LOSS_TYPE_COLORS: Record<string, string> = {\n  Collision: '#2563EB',\n  Water: '#0EA5E9',\n  Fire: '#F59E0B',\n  Theft: '#8B5CF6',\n  Liability: '#10B981',\n  Other: '#64748B',\n  AutoCollision: '#3B82F6',\n  PropertyDamage: '#06B6D4',\n}\n\nexport default function DashboardPage({ claimData, onReset }: DashboardPageProps) {\n  const [kpis, setKpis] = useState<DashboardKpis | null>(null)\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n\n  useEffect(() => {\n    async function fetchKpis() {\n      try {\n        const res = await fetch('/api/dashboard/kpis')\n        if (res.ok) {\n          const data = await res.json()\n          setKpis(data)\n        } else {\n          setKpis(null)\n        }\n      } catch (err) {\n        setError('Failed to load dashboard data')\n        setKpis(null)\n      } finally {\n        setLoading(false)\n      }\n    }\n    fetchKpis()\n  }, [claimData?.claimId])\n\n  if (!claimData || !claimData.decisionPack) {\n    return (\n      <div className=\"max-w-7xl mx-auto text-center py-16\">\n        <AlertTriangle className=\"w-12 h-12 text-[#9CA3AF] mx-auto mb-4\" />\n        <h2 className=\"text-2xl font-semibold text-[#111827] mb-2\">No Claim Data Available</h2>\n        <p className=\"text-[#6B7280] mb-8\">Please process a claim first to view the dashboard.</p>\n        <button onClick={onReset} className=\"btn-primary inline-flex items-center space-x-2\">\n          <RefreshCw className=\"w-4 h-4\" />\n          <span>Process New Claim</span>\n        </button>\n      </div>\n    )\n  }\n\n  const {\n    decisionPack,\n    processingTime = 0,\n  } = claimData\n  const {\n    evidence = [],\n    documents = [],\n    policyGrounding = [],\n    evidenceSummary,\n  } = decisionPack || {}\n\n  const totalFields = evidence.length || 1\n  const autoPopulatedFields = evidenceSummary?.highConfidenceFields ?? evidence.filter((e) => e.confidence >= CONFIDENCE.THRESHOLD_HIGH).length\n  const autoPopPct = Math.round((autoPopulatedFields / totalFields) * 100) || 0\n\n  const lossTypeChartData = kpis?.claimsByLossType\n    ? Object.entries(kpis.claimsByLossType).map(([name, value]) => ({\n        name,\n        value,\n        color: LOSS_TYPE_COLORS[name] || '#94A3B8',\n      }))\n    : []\n\n  let confidenceData = [\n    {\n      name: `High (≥${Math.round(CONFIDENCE.THRESHOLD_HIGH * 100)}%)`,\n      value: evidence.filter((e) => e.confidence >= CONFIDENCE.THRESHOLD_HIGH).length,\n      color: '#10B981',\n    },\n    {\n      name: 'Medium',\n      value: evidence.filter((e) => e.confidence >= CONFIDENCE.THRESHOLD_MEDIUM && e.confidence < CONFIDENCE.THRESHOLD_HIGH).length,\n      color: '#F59E0B',\n    },\n    {\n      name: `Low (<${Math.round(CONFIDENCE.THRESHOLD_MEDIUM * 100)}%)`,\n      value: evidence.filter((e) => e.confidence < CONFIDENCE.THRESHOLD_MEDIUM).length,\n      color: '#EF4444',\n    },\n  ].filter((d) => d.value > 0)\n\n  if (confidenceData.length === 0 && evidence.length > 0) {\n    confidenceData = [{ name: 'Extracted', value: evidence.length, color: '#6366F1' }]\n  }\n\n  return (\n    <div className=\"max-w-7xl mx-auto\">\n      {/* Header */}\n      <div className=\"mb-10 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-[#0F172A] tracking-tight\">\n            Operations Dashboard\n          </h1>\n          <p className=\"text-sm text-[#64748B] mt-1\">\n            Real-time performance and claim metrics\n          </p>\n        </div>\n        <div className=\"flex items-center gap-3\">\n          <button\n            onClick={onReset}\n            className=\"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-[#475569] bg-white border border-[#E2E8F0] rounded-lg hover:bg-[#F8FAFC] hover:border-[#CBD5E1] transition-colors\"\n          >\n            <RefreshCw className=\"w-4 h-4\" />\n            Process New Claim\n          </button>\n          <a\n            href=\"/api/claims/export\"\n            download=\"claims-export.csv\"\n            className=\"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[#2563EB] rounded-lg hover:bg-[#1D4ED8] transition-colors\"\n          >\n            <Download className=\"w-4 h-4\" />\n            Export CSV\n          </a>\n        </div>\n      </div>\n\n      {loading ? (\n        <div className=\"flex items-center justify-center py-24\">\n          <div className=\"w-10 h-10 border-2 border-[#2563EB] border-t-transparent rounded-full animate-spin\" />\n        </div>\n      ) : error ? (\n        <div className=\"rounded-xl border border-[#FEE2E2] bg-[#FEF2F2] p-6 text-center\">\n          <AlertTriangle className=\"w-10 h-10 text-[#DC2626] mx-auto mb-2\" />\n          <p className=\"text-sm text-[#991B1B]\">{error}</p>\n        </div>\n      ) : (\n        <>\n          {/* KPI Cards */}\n          <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-10\">\n            <div className=\"bg-white rounded-xl border border-[#E2E8F0] p-6 shadow-sm\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <div className=\"p-2.5 bg-[#EFF6FF] rounded-lg\">\n                  <FileText className=\"w-5 h-5 text-[#2563EB]\" />\n                </div>\n              </div>\n              <p className=\"text-xs font-medium text-[#64748B] uppercase tracking-wider mb-1\">\n                Total Claims Processed\n              </p>\n              <p className=\"text-2xl font-bold text-[#0F172A]\">\n                {kpis?.totalClaims ?? 0}\n              </p>\n              <p className=\"text-xs text-[#64748B] mt-2\">\n                {kpis?.claimsThisWeek ?? 0} this week · {kpis?.claimsThisMonth ?? 0} this month\n              </p>\n            </div>\n\n            <div className=\"bg-white rounded-xl border border-[#E2E8F0] p-6 shadow-sm\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <div className=\"p-2.5 bg-[#ECFDF5] rounded-lg\">\n                  <Shield className=\"w-5 h-5 text-[#059669]\" />\n                </div>\n              </div>\n              <p className=\"text-xs font-medium text-[#64748B] uppercase tracking-wider mb-1\">\n                Policy Coverage Match\n              </p>\n              <p className=\"text-2xl font-bold text-[#0F172A]\">\n                {kpis?.coverageMatchRate ?? 0}%\n              </p>\n              <p className=\"text-xs text-[#64748B] mt-2\">\n                Claims with policy clause matches\n              </p>\n            </div>\n\n            <div className=\"bg-white rounded-xl border border-[#E2E8F0] p-6 shadow-sm\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <div className=\"p-2.5 bg-[#F5F3FF] rounded-lg\">\n                  <TrendingUp className=\"w-5 h-5 text-[#7C3AED]\" />\n                </div>\n              </div>\n              <p className=\"text-xs font-medium text-[#64748B] uppercase tracking-wider mb-1\">\n                Avg Extraction Confidence\n              </p>\n              <p className=\"text-2xl font-bold text-[#0F172A]\">\n                {kpis?.avgConfidence ?? evidence.length\n                  ? Math.round(\n                      (evidence.reduce((s, e) => s + (e.confidence || 0), 0) / evidence.length) * 100\n                    )\n                  : 0}\n                %\n              </p>\n              <p className=\"text-xs text-[#64748B] mt-2\">\n                Across all processed claims\n              </p>\n            </div>\n\n            <div className=\"bg-white rounded-xl border border-[#E2E8F0] p-6 shadow-sm\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <div className=\"p-2.5 bg-[#FFF7ED] rounded-lg\">\n                  <Clock className=\"w-5 h-5 text-[#EA580C]\" />\n                </div>\n              </div>\n              <p className=\"text-xs font-medium text-[#64748B] uppercase tracking-wider mb-1\">\n                Documents Processed\n              </p>\n              <p className=\"text-2xl font-bold text-[#0F172A]\">\n                {kpis?.totalDocumentsProcessed ?? documents.length}\n              </p>\n              <p className=\"text-xs text-[#64748B] mt-2\">\n                Attachments and evidence\n              </p>\n            </div>\n          </div>\n\n          {/* Charts Row */}\n          <div className=\"grid lg:grid-cols-2 gap-6 mb-10\">\n            {/* Claims Over Time */}\n            <div className=\"bg-white rounded-xl border border-[#E2E8F0] p-6 shadow-sm\">\n              <h3 className=\"text-sm font-semibold text-[#0F172A] mb-6 flex items-center gap-2\">\n                <BarChart3 className=\"w-4 h-4 text-[#64748B]\" />\n                Claims Processed Over Time\n              </h3>\n              <ResponsiveContainer width=\"100%\" height={260}>\n                {kpis?.claimsByDate && kpis.claimsByDate.length > 0 ? (\n                  <BarChart\n                    data={kpis.claimsByDate.map((d) => ({\n                      ...d,\n                      shortDate: d.date.slice(5),\n                    }))}\n                  >\n                    <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#F1F5F9\" vertical={false} />\n                    <XAxis\n                      dataKey=\"shortDate\"\n                      stroke=\"#94A3B8\"\n                      tick={{ fill: '#64748B', fontSize: 11 }}\n                      axisLine={{ stroke: '#E2E8F0' }}\n                    />\n                    <YAxis\n                      stroke=\"#94A3B8\"\n                      tick={{ fill: '#64748B', fontSize: 11 }}\n                      axisLine={false}\n                      tickLine={false}\n                    />\n                    <Tooltip\n                      contentStyle={{\n                        backgroundColor: '#FFF',\n                        border: '1px solid #E2E8F0',\n                        borderRadius: '8px',\n                        fontSize: '12px',\n                      }}\n                      formatter={(value: number) => [value, 'Claims']}\n                    />\n                    <Bar dataKey=\"count\" fill=\"#2563EB\" radius={[4, 4, 0, 0]} name=\"Claims\" />\n                  </BarChart>\n                ) : (\n                  <div className=\"flex items-center justify-center h-full text-[#94A3B8] text-sm\">\n                    No claims data yet. Process claims to see trends.\n                  </div>\n                )}\n              </ResponsiveContainer>\n            </div>\n\n            {/* Claims by Loss Type */}\n            <div className=\"bg-white rounded-xl border border-[#E2E8F0] p-6 shadow-sm\">\n              <h3 className=\"text-sm font-semibold text-[#0F172A] mb-6 flex items-center gap-2\">\n                <PieChartIcon className=\"w-4 h-4 text-[#64748B]\" />\n                Claims by Loss Type\n              </h3>\n              <ResponsiveContainer width=\"100%\" height={260}>\n                {lossTypeChartData.length > 0 ? (\n                  <PieChart>\n                    <Pie\n                      data={lossTypeChartData}\n                      cx=\"50%\"\n                      cy=\"50%\"\n                      innerRadius={55}\n                      outerRadius={85}\n                      paddingAngle={2}\n                      dataKey=\"value\"\n                      label={({ name, percent }) =>\n                        `${name} ${(percent * 100).toFixed(0)}%`\n                      }\n                    >\n                      {lossTypeChartData.map((entry, i) => (\n                        <Cell key={i} fill={entry.color} />\n                      ))}\n                    </Pie>\n                    <Tooltip\n                      contentStyle={{\n                        backgroundColor: '#FFF',\n                        border: '1px solid #E2E8F0',\n                        borderRadius: '8px',\n                        fontSize: '12px',\n                      }}\n                    />\n                  </PieChart>\n                ) : (\n                  <div className=\"flex items-center justify-center h-full text-[#94A3B8] text-sm\">\n                    No loss type distribution yet.\n                  </div>\n                )}\n              </ResponsiveContainer>\n            </div>\n          </div>\n\n          {/* Bottom Section: Current Claim + Recent + Confidence */}\n          <div className=\"grid lg:grid-cols-3 gap-6 mb-10\">\n            {/* Current Claim Metrics */}\n            <div className=\"bg-white rounded-xl border border-[#E2E8F0] p-6 shadow-sm\">\n              <h3 className=\"text-sm font-semibold text-[#0F172A] mb-4 flex items-center gap-2\">\n                <CheckCircle className=\"w-4 h-4 text-[#059669]\" />\n                Current Claim\n              </h3>\n              <div className=\"space-y-4\">\n                <div className=\"flex justify-between items-center py-3 border-b border-[#F1F5F9]\">\n                  <span className=\"text-sm text-[#64748B]\">Processing Time</span>\n                  <span className=\"text-sm font-semibold text-[#0F172A]\">\n                    {((processingTime || 0) / 1000).toFixed(1)}s\n                  </span>\n                </div>\n                <div className=\"flex justify-between items-center py-3 border-b border-[#F1F5F9]\">\n                  <span className=\"text-sm text-[#64748B]\">Fields Extracted</span>\n                  <span className=\"text-sm font-semibold text-[#0F172A]\">{evidence.length}</span>\n                </div>\n                <div className=\"flex justify-between items-center py-3 border-b border-[#F1F5F9]\">\n                  <span className=\"text-sm text-[#64748B]\">High Confidence</span>\n                  <span className=\"text-sm font-semibold text-[#0F172A]\">\n                    {autoPopulatedFields} ({autoPopPct}%)\n                  </span>\n                </div>\n                <div className=\"flex justify-between items-center py-3 border-b border-[#F1F5F9]\">\n                  <span className=\"text-sm text-[#64748B]\">Policy Matches</span>\n                  <span className=\"text-sm font-semibold text-[#0F172A]\">\n                    {policyGrounding.length}\n                  </span>\n                </div>\n                <div className=\"flex justify-between items-center py-3\">\n                  <span className=\"text-sm text-[#64748B]\">Documents</span>\n                  <span className=\"text-sm font-semibold text-[#0F172A]\">{documents.length}</span>\n                </div>\n              </div>\n            </div>\n\n            {/* Field Confidence Distribution */}\n            <div className=\"bg-white rounded-xl border border-[#E2E8F0] p-6 shadow-sm\">\n              <h3 className=\"text-sm font-semibold text-[#0F172A] mb-4\">\n                Field Confidence (Current Claim)\n              </h3>\n              <ResponsiveContainer width=\"100%\" height={220}>\n                {confidenceData.length > 0 ? (\n                  <PieChart>\n                    <Pie\n                      data={confidenceData}\n                      cx=\"50%\"\n                      cy=\"50%\"\n                      innerRadius={45}\n                      outerRadius={70}\n                      paddingAngle={2}\n                      dataKey=\"value\"\n                    >\n                      {confidenceData.map((entry, i) => (\n                        <Cell key={i} fill={entry.color} />\n                      ))}\n                    </Pie>\n                    <Tooltip />\n                    <Legend\n                      wrapperStyle={{ fontSize: '11px' }}\n                      iconType=\"circle\"\n                      iconSize={8}\n                    />\n                  </PieChart>\n                ) : (\n                  <div className=\"flex items-center justify-center h-full text-[#94A3B8] text-sm\">\n                    No evidence data\n                  </div>\n                )}\n              </ResponsiveContainer>\n            </div>\n\n            {/* Recent Claims */}\n            <div className=\"bg-white rounded-xl border border-[#E2E8F0] p-6 shadow-sm\">\n              <h3 className=\"text-sm font-semibold text-[#0F172A] mb-4\">Recent Claims</h3>\n              {kpis?.recentClaims && kpis.recentClaims.length > 0 ? (\n                <div className=\"space-y-3\">\n                  {kpis.recentClaims.slice(0, 5).map((c, i) => (\n                    <div\n                      key={c.claimId || i}\n                      className=\"flex items-center justify-between py-2 px-3 rounded-lg bg-[#F8FAFC] hover:bg-[#F1F5F9] transition-colors\"\n                    >\n                      <div className=\"min-w-0\">\n                        <p className=\"text-sm font-medium text-[#0F172A] truncate\">\n                          {c.claimantName || c.policyNumber || c.claimId}\n                        </p>\n                        <p className=\"text-xs text-[#64748B]\">\n                          {c.lossType} · {c.policyMatches} policy match{c.policyMatches !== 1 ? 'es' : ''}\n                        </p>\n                      </div>\n                      <span className=\"text-xs text-[#94A3B8] flex-shrink-0 ml-2\">\n                        {c.createdAt?.slice(0, 10)}\n                      </span>\n                    </div>\n                  ))}\n                </div>\n              ) : (\n                <div className=\"flex items-center justify-center py-12 text-[#94A3B8] text-sm\">\n                  No recent claims\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Governance */}\n          <div className=\"bg-white rounded-xl border border-[#E2E8F0] p-8 shadow-sm\">\n            <h3 className=\"text-sm font-semibold text-[#0F172A] mb-6\">Governance & Compliance</h3>\n            <div className=\"grid md:grid-cols-2 gap-8\">\n              <div>\n                <h4 className=\"text-xs font-medium text-[#64748B] uppercase tracking-wider mb-3\">\n                  Human-in-the-Loop\n                </h4>\n                <ul className=\"text-sm text-[#475569] space-y-2\">\n                  <li>• No automatic claim denials</li>\n                  <li>• Fields below {Math.round(CONFIDENCE.THRESHOLD_MEDIUM * 100)}% confidence require review</li>\n                  <li>• Policy clause matches require verification</li>\n                  <li>• All decisions logged with audit trail</li>\n                </ul>\n              </div>\n              <div>\n                <h4 className=\"text-xs font-medium text-[#64748B] uppercase tracking-wider mb-3\">\n                  Explainability\n                </h4>\n                <ul className=\"text-sm text-[#475569] space-y-2\">\n                  <li>• Every extracted field has evidence source</li>\n                  <li>• Policy clauses include similarity scores</li>\n                  <li>• Complete audit trail maintained</li>\n                </ul>\n              </div>\n            </div>\n          </div>\n        </>\n      )}\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6461, "column": 0}, "map": {"version":3,"sources":["file:///Users/pranaynath/Documents/GitHub/fnol/Autonomous-Claims-Orchestrator/app/page.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { useRouter } from 'next/navigation'\nimport Header from '@/components/Header'\nimport HomePage from '@/components/HomePage'\nimport ReviewPage from '@/components/ReviewPage'\nimport DecisionPage from '@/components/DecisionPage'\nimport DashboardPage from '@/components/DashboardPage'\nimport { ClaimData, ProcessingStage } from '@/types/claims'\nimport { useAuth } from '@/lib/auth/AuthContext'\n\nexport default function Home() {\n  const router = useRouter()\n  const { isAuthenticated, loading } = useAuth()\n  const [currentStage, setCurrentStage] = useState<ProcessingStage>('home')\n  const [claimData, setClaimData] = useState<ClaimData | null>(null)\n  const [isProcessing, setIsProcessing] = useState(false)\n\n  // Redirect to login if not authenticated\n  useEffect(() => {\n    if (!loading && !isAuthenticated) {\n      router.push('/login')\n    }\n  }, [isAuthenticated, loading, router])\n\n  // Show loading state while checking authentication\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-white flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"w-12 h-12 border-4 border-[#2563EB] border-t-transparent rounded-full animate-spin mx-auto mb-4\"></div>\n          <p className=\"text-[#64748B]\">Loading...</p>\n        </div>\n      </div>\n    )\n  }\n\n  // Don't render main app if not authenticated\n  if (!isAuthenticated) {\n    return null\n  }\n\n  const handleStageChange = (stage: ProcessingStage) => {\n    // Prevent navigation to stages that require claimData if it's not available\n    if ((stage === 'review' || stage === 'decision' || stage === 'dashboard') && !claimData) {\n      // Stay on current stage or go to home\n      return\n    }\n    setCurrentStage(stage)\n  }\n\n  const handleClaimProcessed = (data: ClaimData) => {\n    setClaimData(data)\n    setCurrentStage('review')\n  }\n\n  const handleLoadClaim = async (claimId: string) => {\n    try {\n      const res = await fetch(`/api/claims/${encodeURIComponent(claimId)}`)\n      if (res.ok) {\n        const data = await res.json()\n        setClaimData(data)\n      }\n    } catch (err) {\n      console.error('Failed to load claim:', err)\n    }\n  }\n\n  const renderCurrentStage = () => {\n    switch (currentStage) {\n      case 'home':\n        return (\n          <HomePage\n            onProcessClaim={handleClaimProcessed}\n            isProcessing={isProcessing}\n            setIsProcessing={setIsProcessing}\n          />\n        )\n      case 'review':\n        return (\n          <ReviewPage\n            claimData={claimData!}\n            onNextStage={() => setCurrentStage('decision')}\n            onPreviousStage={() => setCurrentStage('home')}\n            onLoadClaim={handleLoadClaim}\n          />\n        )\n      case 'decision':\n        return (\n          <DecisionPage\n            claimData={claimData!}\n            onNextStage={() => setCurrentStage('dashboard')}\n            onPreviousStage={() => setCurrentStage('review')}\n            onLoadClaim={handleLoadClaim}\n          />\n        )\n      case 'dashboard':\n        return (\n          <DashboardPage\n            claimData={claimData!}\n            onReset={() => {\n              setCurrentStage('home')\n              setClaimData(null)\n            }}\n          />\n        )\n      default:\n        return <HomePage onProcessClaim={handleClaimProcessed} isProcessing={isProcessing} setIsProcessing={setIsProcessing} />\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen bg-white relative\">\n      <Header currentStage={currentStage} onStageChange={handleStageChange} />\n      <main className=\"container mx-auto px-8 py-16 relative z-10\">\n        {renderCurrentStage()}\n      </main>\n    </div>\n  )\n} "],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAVA;;;;;;;;;;AAYe,SAAS;IACtB,MAAM,SAAS,IAAA,uLAAS;IACxB,MAAM,EAAE,eAAe,EAAE,OAAO,EAAE,GAAG,IAAA,8KAAO;IAC5C,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yPAAQ,EAAkB;IAClE,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yPAAQ,EAAmB;IAC7D,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yPAAQ,EAAC;IAEjD,yCAAyC;IACzC,IAAA,0PAAS,EAAC;QACR,IAAI,CAAC,WAAW,CAAC,iBAAiB;YAChC,OAAO,IAAI,CAAC;QACd;IACF,GAAG;QAAC;QAAiB;QAAS;KAAO;IAErC,mDAAmD;IACnD,IAAI,SAAS;QACX,qBACE,sRAAC;YAAI,WAAU;sBACb,cAAA,sRAAC;gBAAI,WAAU;;kCACb,sRAAC;wBAAI,WAAU;;;;;;kCACf,sRAAC;wBAAE,WAAU;kCAAiB;;;;;;;;;;;;;;;;;IAItC;IAEA,6CAA6C;IAC7C,IAAI,CAAC,iBAAiB;QACpB,OAAO;IACT;IAEA,MAAM,oBAAoB,CAAC;QACzB,4EAA4E;QAC5E,IAAI,CAAC,UAAU,YAAY,UAAU,cAAc,UAAU,WAAW,KAAK,CAAC,WAAW;YACvF,sCAAsC;YACtC;QACF;QACA,gBAAgB;IAClB;IAEA,MAAM,uBAAuB,CAAC;QAC5B,aAAa;QACb,gBAAgB;IAClB;IAEA,MAAM,kBAAkB,OAAO;QAC7B,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,CAAC,YAAY,EAAE,mBAAmB,UAAU;YACpE,IAAI,IAAI,EAAE,EAAE;gBACV,MAAM,OAAO,MAAM,IAAI,IAAI;gBAC3B,aAAa;YACf;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,yBAAyB;QACzC;IACF;IAEA,MAAM,qBAAqB;QACzB,OAAQ;YACN,KAAK;gBACH,qBACE,sRAAC,0KAAQ;oBACP,gBAAgB;oBAChB,cAAc;oBACd,iBAAiB;;;;;;YAGvB,KAAK;gBACH,qBACE,sRAAC,4KAAU;oBACT,WAAW;oBACX,aAAa,IAAM,gBAAgB;oBACnC,iBAAiB,IAAM,gBAAgB;oBACvC,aAAa;;;;;;YAGnB,KAAK;gBACH,qBACE,sRAAC,8KAAY;oBACX,WAAW;oBACX,aAAa,IAAM,gBAAgB;oBACnC,iBAAiB,IAAM,gBAAgB;oBACvC,aAAa;;;;;;YAGnB,KAAK;gBACH,qBACE,sRAAC,+KAAa;oBACZ,WAAW;oBACX,SAAS;wBACP,gBAAgB;wBAChB,aAAa;oBACf;;;;;;YAGN;gBACE,qBAAO,sRAAC,0KAAQ;oBAAC,gBAAgB;oBAAsB,cAAc;oBAAc,iBAAiB;;;;;;QACxG;IACF;IAEA,qBACE,sRAAC;QAAI,WAAU;;0BACb,sRAAC,wKAAM;gBAAC,cAAc;gBAAc,eAAe;;;;;;0BACnD,sRAAC;gBAAK,WAAU;0BACb;;;;;;;;;;;;AAIT"}}]
}